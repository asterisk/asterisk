2007-03-02  Russell Bryant  <russell@digium.com>

	* Asterisk 1.4.1 released.

2007-03-02 23:03 +0000 [r57556]  Russell Bryant <russell@digium.com>

	* configure, configure.ac: Update the check that is used to
	  determine whether zaptel transcoder support is present. The
	  interface has changed.

2007-03-02 17:06 +0000 [r57477]  Joshua Colp <jcolp@digium.com>

	* /, channels/chan_sip.c: Merged revisions 57475 via svnmerge from
	  https://origsvn.digium.com/svn/asterisk/branches/1.2 ........
	  r57475 | file | 2007-03-02 12:02:46 -0500 (Fri, 02 Mar 2007) | 2
	  lines If a SIP message comes in and goes to a method handler that
	  requires additional values that may not be present then send back
	  an error. ........

2007-03-02 16:55 +0000 [r57426-57473]  Steve Murphy <murf@digium.com>

	* main/pbx.c, /: Merged revisions 57458 via svnmerge from
	  https://origsvn.digium.com/svn/asterisk/branches/1.2 ........
	  r57458 | murf | 2007-03-02 09:39:33 -0700 (Fri, 02 Mar 2007) | 1
	  line further refinement in wording of goto documentation, as per
	  9156, goto not proceeding to next instruction ........

	* pbx/pbx_ael.c, utils/ael_main.c: I almost had comma escapes
	  right, but 9184 points out the problem-- the escape is removed by
	  pbx_config, and pbx_ael should also, before sending it down into
	  the pbx engine. Also, you have to insert it back in, if you are
	  generating extensions.conf code from the AEL.

2007-03-02 00:20 +0000 [r57364-57396]  Russell Bryant <russell@digium.com>

	* main/file.c: Return the correct digit that interrupted the
	  stream. This fixes exiting the Background application when using
	  the m option. (issue #9176, mjagdis)

	* configs/sla.conf.sample, apps/app_meetme.c, doc/sla.txt,
	  include/asterisk/channel.h: Merge changes from
	  svn/asterisk/team/russell/sla_updates * Originally, I put in the
	  documentation that only Zap interfaces would be supported on the
	  trunk side. However, after a discussion with Qwell, we came up
	  with a way to make IP trunks work as well, using some things
	  already in Asterisk. So, here it is, this now officially supports
	  IP trunks. * Update the SLA documentation to reflect how to setup
	  IP trunks. * Add a section in sla.txt that describes how to set
	  up an SLA system with voicemail. * Simplify the way DTMF
	  passthrough is handled in MeetMe. * Fix a bug that exposed itself
	  when using a Local channel on the trunk side in SLA. The
	  station's channel needs to be passed to the dial API when dialing
	  the trunk. * Change a WARNING message to DEBUG in channel.h. This
	  message is of no use to users.

2007-03-01 22:21 +0000 [r57318]  Joshua Colp <jcolp@digium.com>

	* channels/chan_local.c, /: Merged revisions 57317 via svnmerge
	  from https://origsvn.digium.com/svn/asterisk/branches/1.2
	  ........ r57317 | file | 2007-03-01 17:19:32 -0500 (Thu, 01 Mar
	  2007) | 2 lines Don't even attempt to optimize things when a
	  proxy channel is involved. It will just explode in weird and
	  unexplaineable ways. (issue #9175 reported by
	  clegall_proformatique) ........

2007-03-01 03:02 +0000 [r57263]  TransNexus OSP Development <support@transnexus.com>

	* doc/osp.txt: 1. Corrected a typo for www.etsi.org. Thank Patrick.

2007-02-28 23:01 +0000 [r57144-57207]  Russell Bryant <russell@digium.com>

	* configs/sla.conf.sample, doc/sla.txt: minor tweaks to the sla
	  docs

	* configs/sla.conf.sample, apps/app_meetme.c: Merge more changes
	  from svn/asterisk/team/russell/sla_updates * Add support for
	  private hold. By setting "hold=private" for a trunk, only the
	  station that put the call on hold will be able to retrieve it
	  from hold. Also, by setting "hold=private" for a station, any
	  call that station puts on hold can only be retrieved by that
	  station.

	* apps/app_meetme.c: Minor formatting change

	* configs/sla.conf.sample, apps/app_meetme.c: Merge changes from
	  svn/asterisk/team/russell/sla_updates * Add support for the
	  "barge=no" option for trunks. If this option is set, then
	  stations will not be able to join in on a call that is on
	  progress on this trunk.

2007-02-28 19:23 +0000 [r57139]  Steve Murphy <murf@digium.com>

	* main/pbx.c, /: Merged revisions 57118 via svnmerge from
	  https://origsvn.digium.com/svn/asterisk/branches/1.2 ........
	  r57118 | murf | 2007-02-28 12:12:41 -0700 (Wed, 28 Feb 2007) | 1
	  line a small documentation update, to reflect reality in the goto
	  doc strings, as per 9156, Goto does not proceed to next prio if
	  jump fails ........

2007-02-28 18:57 +0000 [r57093]  Joshua Colp <jcolp@digium.com>

	* /, channels/chan_agent.c: Merged revisions 57092 via svnmerge
	  from https://origsvn.digium.com/svn/asterisk/branches/1.2
	  ........ r57092 | file | 2007-02-28 13:55:45 -0500 (Wed, 28 Feb
	  2007) | 2 lines Fix a few more issues with the agent logoff CLI
	  command. (issue #9123 reported by arbrandes) ........

2007-02-28 18:20 +0000 [r57089]  Russell Bryant <russell@digium.com>

	* configs/sla.conf.sample, apps/app_meetme.c: Merge current set of
	  changes from svn/asterisk/team/russell/sla_updates * Add support
	  for station ring delays. Ring delays can be set globally for a
	  station or for specific trunks on the station. * Fix a few bugs
	  in existing code. * Restructure and Reorganize code to improve
	  readability and maintainability. * Improve formatting of the "sla
	  show (trunks|stations)" CLI commands.

2007-02-28 17:55 +0000 [r57053-57055]  Joshua Colp <jcolp@digium.com>

	* apps/app_meetme.c: Picky compiler...

	* apps/app_speech_utils.c: Better handle timeouts when the
	  individual speaks after everything has been played but before the
	  timeout ends.

2007-02-28 17:15 +0000 [r57049]  Steve Murphy <murf@digium.com>

	* pbx/pbx_ael.c: I was surprised that I had not yet downgraded
	  missing goto targets and macro call defs to a warning, in case
	  they are in extensions.conf; I rectified this problem. Also, A
	  goto in a macro to a target in a catch block was not being found;
	  I fixed this too; the cause was that I needed to treat catch
	  statements like an extension in the find_match code.

2007-02-27 17:36 +0000 [r56975]  Russell Bryant <russell@digium.com>

	* apps/app_voicemail.c: Fix voicemail email attachments. I missed
	  the conversion of one of the line endings and there was an extra
	  one where it should not have been. (issue #9128)

2007-02-26 22:01 +0000 [r56922]  Tilghman Lesher <tilghman@mail.jeffandtilghman.com>

	* apps/app_lookupcidname.c, apps/app_lookupblacklist.c: Picky,
	  picky... show deprecation warning in application help, too
	  (reported via list)

2007-02-26 20:42 +0000 [r56888]  Russell Bryant <russell@digium.com>

	* channels/chan_alsa.c: Restore the behavior of Asterisk 1.2 where
	  if a device was not specified in alsa.conf, then we just use the
	  system default, instead of creating our own default of hw:0,0.
	  (issue #9139)

2007-02-26 20:07 +0000 [r56856]  Joshua Colp <jcolp@digium.com>

	* /, pbx/pbx_config.c: Merged revisions 56850 via svnmerge from
	  https://origsvn.digium.com/svn/asterisk/branches/1.2 ........
	  r56850 | file | 2007-02-26 15:05:02 -0500 (Mon, 26 Feb 2007) | 2
	  lines Obey the clearglobalvars option in extensions reload (or
	  dialplan reload depending on your version). (issue #9146 reported
	  by ramonpeek) ........

2007-02-26 20:04 +0000 [r56847]  Russell Bryant <russell@digium.com>

	* channels/chan_iax2.c: Fix a crash in my last change to
	  iax2_indicate(). (issue #9150)

2007-02-26 19:33 +0000 [r56805-56839]  Joshua Colp <jcolp@digium.com>

	* apps/app_record.c: Update app_record documentation to use new CLI
	  command, core show file formats. (issue #9151 reported by junky)

	* main/pbx.c: Use ast_strlen_zero to see if the language and/or
	  context argument is not present for Background instead of just
	  checking if it is NULL. (issue #9141 reported by mjagdis)

2007-02-26 16:51 +0000 [r56785]  Russell Bryant <russell@digium.com>

	* channels/chan_iax2.c: Do more complete locking of the
	  chan_iax2_pvt struct in the indicate callback. (Problem brought
	  up by Ben Smithurst on the asterisk-dev list)

2007-02-26 16:36 +0000 [r56783]  Joshua Colp <jcolp@digium.com>

	* main/asterisk.c: Allow both of the show version files and core
	  show file versions CLI commands to work. (issue #9135 reported by
	  mvanbaak)

2007-02-26 01:04 +0000 [r56730-56740]  Russell Bryant <russell@digium.com>

	* apps/app_meetme.c: Move a comment to be in the correct struct.

	* /: Blocked revisions 56729 via svnmerge ........ r56729 | russell
	  | 2007-02-25 18:34:31 -0600 (Sun, 25 Feb 2007) | 4 lines Ensure
	  that lock.h is included in utils.c with AST_API_MODULE defined so
	  that the implementations will be properly included when the
	  AST_INLINE_API functions are not going to be inlined. (issue
	  #9124, festr) ........

2007-02-25 14:46 +0000 [r56685]  Tilghman Lesher <tilghman@mail.jeffandtilghman.com>

	* main/channel.c, /: Merged revisions 56684 via svnmerge from
	  https://origsvn.digium.com/svn/asterisk/branches/1.2 ........
	  r56684 | tilghman | 2007-02-25 08:38:03 -0600 (Sun, 25 Feb 2007)
	  | 3 lines Issue 9130 - If prev is the last item on the channel
	  list, then evaluating additional conditions (e.g. name prefix)
	  will cause a NULL dereference. ........

2007-02-24 02:02 +0000 [r56569]  Jason Parker <jparker@digium.com>

	* channels/chan_skinny.c: Make sure to set a speeddials parent on
	  creation. Don't crash if hold is pressed when no call is active.
	  Don't return in places that we shouldn't..

2007-02-24 00:53 +0000 [r56548]  Kevin P. Fleming <kpfleming@digium.com>

	* codecs/codec_zap.c: update to match zaptel 1.4 API change that
	  was committed a few minutes ago

2007-02-23 23:24 +0000 [r56505]  Russell Bryant <russell@digium.com>

	* main/asterisk.c, /: Merged revisions 56504 via svnmerge from
	  https://origsvn.digium.com/svn/asterisk/branches/1.2 ........
	  r56504 | russell | 2007-02-23 17:20:55 -0600 (Fri, 23 Feb 2007) |
	  8 lines Fix up a couple more signal handlers to not do bad things
	  that could cause various undesirable results. The other day, I
	  made Asterisk deadlock by hitting Control-C because of a bad
	  signal handler. Now, signal handlers just set a flag and write to
	  an alert pipe for the flag to be handled. Then, there is another
	  thread that is monitoring for these flags. If being run in
	  console mode, it is just the main thread. If Asterisk is in the
	  background, a thread is created to do it. ........

2007-02-23 21:53 +0000 [r56457]  Joshua Colp <jcolp@digium.com>

	* main/sched.c: Change log notice to debug. It is possible for a
	  scheduled item to execute and be deleted at close to the same
	  time and unavoidable. If this happens this message creeps up.

2007-02-23 20:20 +0000 [r56407]  Russell Bryant <russell@digium.com>

	* /, channels/chan_iax2.c: Merged revisions 56406 via svnmerge from
	  https://origsvn.digium.com/svn/asterisk/branches/1.2 ........
	  r56406 | russell | 2007-02-23 14:17:56 -0600 (Fri, 23 Feb 2007) |
	  4 lines Don't destroy mutexes before unregistering all of the
	  entry points from the core. Also, fix a potential memory leak
	  from not destroying the locks for all of the possible call
	  numbers (about 32k of them). ........

2007-02-23 18:59 +0000 [r56372]  Kevin P. Fleming <kpfleming@digium.com>

	* build_tools/make_version_h: build special version strings for
	  AADK/S800i builds

2007-02-23 17:58 +0000 [r56341]  Russell Bryant <russell@digium.com>

	* apps/app_voicemail.c: The IMAP storage code uses the same code to
	  build the email that is used when voicemail is sent via email
	  using something like sendmail. In the patch from bug 8033 to fix
	  various IMAP storage problems, the line endings in the email file
	  were changed in the code from "\n" to "\r\n". However, this
	  breaks sending regular voicemail to email. So, this change
	  conditionally sets line endings to "\r\n" only if IMAP_STORAGE is
	  enabled. (issue #9128, patch by jarjarbinks, modified by me to
	  not break IMAP storage)

2007-02-22 23:25 +0000 [r56280]  Joshua Colp <jcolp@digium.com>

	* /: Blocked revisions 56279 via svnmerge ........ r56279 | file |
	  2007-02-22 18:19:25 -0500 (Thu, 22 Feb 2007) | 2 lines Always
	  defer Agent logoff if any channels are up until they hang up.
	  (issue #9123 reported by arbrandes) ........

2007-02-22 23:08 +0000 [r56277]  Russell Bryant <russell@digium.com>

	* configs/sla.conf.sample, main/dial.c, apps/app_meetme.c,
	  doc/sla.txt: Merge changes from team/russell/sla_updates. This
	  batch of changes to the SLA code does a few different things. * I
	  made the SLA code event driven instead of having to act in a lot
	  of busy loops while dialing things to wait for state changes.
	  This makes the code more efficient and readable at the same time.
	  * I have implemented a couple of new features. The first is
	  inbound trunk ringing timeouts. This is an option that defines
	  how long to let an incoming call on a trunk to ring. * I have
	  also implemented ring timeouts for stations. They may be
	  specified for the entire station, meaning it is how long to let
	  the station ring before giving up. You can also specify a ring
	  timeout for a specific trunk on a station. So, you can say that
	  you only want a specific station to ring 5 seconds if it is line1
	  ringing, but otherwise, there is no timeout.

2007-02-22 18:49 +0000 [r56231]  Joshua Colp <jcolp@digium.com>

	* main/channel.c, /, channels/chan_sip.c: Merged revisions 56230
	  via svnmerge from
	  https://origsvn.digium.com/svn/asterisk/branches/1.2 ........
	  r56230 | file | 2007-02-22 13:44:24 -0500 (Thu, 22 Feb 2007) | 2
	  lines Only change the original or clone channel if it's the
	  channel behind the proxy channel, not if it's just a regular
	  bridged channel. ........

2007-02-22 14:06 +0000 [r56169]  TransNexus OSP Development <support@transnexus.com>

	* doc/osp.txt: Update OSP documentation for v1.4.

2007-02-22 10:33 +0000 [r56125]  Olle Johansson <oej@edvina.net>

	* channels/chan_sip.c: Move message from verbose to debug

2007-02-22 02:39 +0000 [r56094]  Steve Murphy <murf@digium.com>

	* sounds/Makefile: updated the sound tarball versions in Makefile

2007-02-22 01:24 +0000 [r56011-56055]  Russell Bryant <russell@digium.com>

	* channels/chan_sip.c: Restructure a little bit of code to reduce
	  nesting. There is no functionality change here.

	* /, channels/chan_sip.c: Merged revisions 56010 via svnmerge from
	  https://origsvn.digium.com/svn/asterisk/branches/1.2 ........
	  r56010 | russell | 2007-02-21 18:53:25 -0600 (Wed, 21 Feb 2007) |
	  3 lines If we receive a frame that is not in any of the
	  negotiated formats, then drop it. (potentially issue #8781 and
	  SPD-12) ........

2007-02-22 00:35 +0000 [r56008]  Joshua Colp <jcolp@digium.com>

	* main/cli.c: Print out deprecation notice on usage output of CLI
	  commands. (issue #8925 reported by blitzrage)

2007-02-22 00:08 +0000 [r56006]  Kevin P. Fleming <kpfleming@digium.com>

	* main/loader.c: disable unloading of embedded modules... there is
	  a fundamental problem with doing so that will not be fixed in
	  this version of Asterisk due to its invasiveness

2007-02-21 20:35 +0000 [r55957]  Joshua Colp <jcolp@digium.com>

	* /, apps/app_meetme.c: Merged revisions 55956 via svnmerge from
	  https://origsvn.digium.com/svn/asterisk/branches/1.2 ........
	  r55956 | file | 2007-02-21 15:32:16 -0500 (Wed, 21 Feb 2007) | 2
	  lines Change naughty warning message to provide useful
	  information. If a write now fails on a channel in meetme it will
	  tell you the channel name instead of spitting out the wrong error
	  message. ........

2007-02-21 20:27 +0000 [r55954]  Jason Parker <jparker@digium.com>

	* channels/chan_gtalk.c: Fix locking issue, and accept
	  "transport-accept" as a valid accept message. This should solve
	  issues 8970 and 8503.

2007-02-21 20:22 +0000 [r55951]  Russell Bryant <russell@digium.com>

	* apps/app_meetme.c: Simplify the last change to app_meetme, and
	  move the call to dispose_conf() up into the block where we know a
	  conf exists.

2007-02-21 20:16 +0000 [r55914-55949]  Joshua Colp <jcolp@digium.com>

	* apps/app_meetme.c: Only dispose of the conference if one was
	  created.

	* apps/app_speech_utils.c: Only start playing the next file if we
	  have not been quieted.

	* channels/chan_sip.c: Add a flag that indicates whether a SIP
	  dialog is an outgoing call or not. SIP_OUTGOING originally did it
	  but it was repurposed to the direction of the last transaction,
	  which can cause update_call_counter to falsely decrease the wrong
	  counters. (please don't hurt me oej) (issue #8943 reported by
	  mdu113)

2007-02-21 14:06 +0000 [r55869]  Kevin P. Fleming <kpfleming@digium.com>

	* /, build_tools/make_version: Merged revisions 55868 via svnmerge
	  from https://origsvn.digium.com/svn/asterisk/branches/1.2
	  ........ r55868 | kpfleming | 2007-02-21 08:03:11 -0600 (Wed, 21
	  Feb 2007) | 2 lines use new tag version script ........

2007-02-21 08:32 +0000 [r55834]  Olle Johansson <oej@edvina.net>

	* channels/chan_sip.c: Issue #8848 - Turn off lamp more quickly
	  after transfer (decrement inuse early on transferer's call leg)

2007-02-21 02:01 +0000 [r55799]  Jason Parker <jparker@digium.com>

	* channels/chan_gtalk.c: Fix segfault when buddy couldn't be found.
	  Issue 7764, patch by sailer

2007-02-21 01:03 +0000 [r55751-55758]  Russell Bryant <russell@digium.com>

	* apps/app_meetme.c: Improve the reference counting to fix bugs
	  where people report seeing conferences listed that have no
	  members. (issue #9073)

	* /: Blocked revisions 55750 via svnmerge ........ r55750 | russell
	  | 2007-02-20 18:19:14 -0600 (Tue, 20 Feb 2007) | 9 lines Fix
	  random crashes when using the MeetMe application. This patch
	  converts list handling to use the linked list macros and most
	  importantly, implements reference counting on the ast_conference
	  objects. The reference counting was first backported from 1.4.
	  However, that code has some problems that caused the reference
	  count to never hit zero. Those problems are fixed in this patch
	  and will be resolved in 1.4 and trunk next, with a different
	  patch. (issues #7647, #9073, #9106, BE-115). ........

2007-02-21 00:11 +0000 [r55670-55741]  Joshua Colp <jcolp@digium.com>

	* apps/app_voicemail.c: Better handle dropped IMAP connections.
	  (issue #9054 reported by bsmithurst)

	* channels/chan_sip.c: Return behavior I removed. I did not
	  remember that you could just add a localnet entry to make it
	  work.

	* channels/chan_sip.c: Don't test our own address against the
	  localnet settings. At least one person has had issues as a result
	  of this from #7051 so I'm reversing it. (issue #8821 reported by
	  kokoskarokoska)

	* /, channels/chan_agent.c: Merged revisions 55669 via svnmerge
	  from https://origsvn.digium.com/svn/asterisk/branches/1.2
	  ........ r55669 | file | 2007-02-20 17:39:14 -0500 (Tue, 20 Feb
	  2007) | 2 lines Defer clearing callback information if channels
	  are up until they are hung up. This ensures the hangup process
	  goes smoothly and no channels get hung in limbo. (issue #8088
	  reported by kebl0155) ........

2007-02-20 20:26 +0000 [r55589-55634]  Russell Bryant <russell@digium.com>

	* main/http.c: Add the Asterisk version information to the Server
	  header in HTTP responses. (requested by Pari)

	* include/asterisk/manager.h: Increase the maximum number of
	  manager headers to 128, at the request of Pari.

	* /: Blocked revisions 55588 via svnmerge ........ r55588 | russell
	  | 2007-02-20 13:49:50 -0600 (Tue, 20 Feb 2007) | 3 lines Convert
	  a tab to spaces so that the documentation is printed out properly
	  aligned. ........

2007-02-20 16:53 +0000 [r55555]  Jason Parker <jparker@digium.com>

	* channels/chan_gtalk.c, res/res_jabber.c: No need to cast nor free
	  with strdupa (thanks file) 55555!

2007-02-20 16:41 +0000 [r55553]  Russell Bryant <russell@digium.com>

	* configs/sla.conf.sample: Change the formatting of sla.conf.sample
	  to make it more readable. (issue #9112, blitzrage)

2007-02-19 21:12 +0000 [r55483]  Olle Johansson <oej@edvina.net>

	* res/res_jabber.c: - Not sending arguments to an application is
	  not "out of memory" - Making error messages a bit more clear

2007-02-19 18:11 +0000 [r55435]  Tilghman Lesher <tilghman@mail.jeffandtilghman.com>

	* apps/app_voicemail.c, /: Merged revisions 55434 via svnmerge from
	  https://origsvn.digium.com/svn/asterisk/branches/1.2 ........
	  r55434 | tilghman | 2007-02-19 12:09:09 -0600 (Mon, 19 Feb 2007)
	  | 2 lines forcename and forcegreetings options should check to
	  see if the recording already exists ........

2007-02-19 14:52 +0000 [r55397]  Doug Bailey <dbailey@digium.com>

	* channels/chan_iax2.c: Changed iax2 process thread to detached to
	  correct memory leak due to left over thread context on thread
	  exit. Modified module unload process to avoid deadlocks on
	  pthread cancels

2007-02-18 12:35 +0000 [r55250-55278]  Olle Johansson <oej@edvina.net>

	* /, apps/app_record.c: Merged revisions 55277 via svnmerge from
	  https://origsvn.digium.com/svn/asterisk/branches/1.2 ........
	  r55277 | oej | 2007-02-18 13:32:13 +0100 (Sun, 18 Feb 2007) | 2
	  lines Documentation update (#9053, jsmith) ........

	* /: Block patch that was made only for 1.2 (already implemented in
	  1.4 and trunk)

2007-02-17 17:39 +0000 [r55219]  Joshua Colp <jcolp@digium.com>

	* apps/app_queue.c: Add missing membername option to AddQueueMember
	  documentation. (issue #9088 reported by seanbright)

2007-02-17 17:10 +0000 [r55217]  Jason Parker <jparker@digium.com>

	* channels/chan_skinny.c: Fix an issue where callerid would not be
	  displayed on some phones. Issue 8995, initial patch and research
	  done by wedhorn

2007-02-17 03:55 +0000 [r55086-55154]  Joshua Colp <jcolp@digium.com>

	* apps/app_dial.c, /: Merged revisions 55153 via svnmerge from
	  https://origsvn.digium.com/svn/asterisk/branches/1.2 ........
	  r55153 | file | 2007-02-16 22:53:45 -0500 (Fri, 16 Feb 2007) | 2
	  lines Answer the channel before recording privacy information.
	  (issue #8926 reported by lmamane) ........

	* apps/app_queue.c: Make the 'i' option of Queue actually work.
	  (issue #8986 reported by utis)

	* /, channels/chan_sip.c: Merged revisions 55073 via svnmerge from
	  https://origsvn.digium.com/svn/asterisk/branches/1.2 ........
	  r55073 | file | 2007-02-16 20:09:50 -0500 (Fri, 16 Feb 2007) | 2
	  lines Allow chan_sip to handle attended transfers from a SIP
	  phone that is sitting behind chan_agent. Yes folks, all it took
	  was one line of code. (issue #8784 reported by pzieba) ........

2007-02-17 00:40 +0000 [r55006-55052]  Russell Bryant <russell@digium.com>

	* configure, include/asterisk/autoconfig.h.in, configure.ac: If the
	  pg_config application is found, but there is probably executing
	  it, then consider postgres unavailable. (issue #8637)

	* codecs/gsm/Makefile: Filter out yet another architecture that
	  does not work with the optimizations in the built-in libgsm.
	  (issue 8637, ovi)

	* /, apps/app_meetme.c, configs/meetme.conf.sample: Merged
	  revisions 55005 via svnmerge from
	  https://origsvn.digium.com/svn/asterisk/branches/1.2 ........
	  r55005 | russell | 2007-02-16 16:48:22 -0600 (Fri, 16 Feb 2007) |
	  9 lines Revert the change I did in revisions 54955, 54969, and
	  54970, in 1.2, 1.4, and trunk. I decided that once a conference
	  is created from meetme.conf, it is acceptable behavior that the
	  pin can not be changed until the conference goes away. I also
	  added a note in meetme.conf to describe this behavior. We still
	  have another issue in 1.4 and trunk where some conferences with
	  no users don't go away. That is the real bug that needs to be
	  addressed here. ........

2007-02-16 22:18 +0000 [r55002]  Joshua Colp <jcolp@digium.com>

	* /, channels/chan_agent.c: Merged revisions 54999 via svnmerge
	  from https://origsvn.digium.com/svn/asterisk/branches/1.2
	  ........ r54999 | file | 2007-02-16 17:13:45 -0500 (Fri, 16 Feb
	  2007) | 2 lines Do not send indications through ast_indicate in
	  chan_agent but instead go directly to the technology. This way
	  when indications are emulated they happen on the Agent channel
	  and do not screw up formats on the channels. (issue #8439
	  reported by punkgode) ........

2007-02-16 21:12 +0000 [r54969]  Russell Bryant <russell@digium.com>

	* /, apps/app_meetme.c: Merged revisions 54955 via svnmerge from
	  https://origsvn.digium.com/svn/asterisk/branches/1.2 ........
	  r54955 | russell | 2007-02-16 14:56:58 -0600 (Fri, 16 Feb 2007) |
	  5 lines For conferences that are configured in meetme.conf, check
	  the configuration file every time someone joins the conference
	  instead of only when the conference is first created. This is to
	  ensure that changes to the pin numbers in the config file are
	  always honored. (issue #9073) ........

2007-02-16 18:51 +0000 [r54924]  Joshua Colp <jcolp@digium.com>

	* apps/app_dial.c: Need to check macro extension as well as macro
	  context for directed pickup.

2007-02-16 18:03 +0000 [r54888-54898]  Russell Bryant <russell@digium.com>

	* pbx/pbx_config.c: Fix setting "autofallthrough" to yes by
	  default. It was set to enabled in pbx.c. However, if the option
	  was not present in extensions.conf, then pbx_config.c would set
	  it back to disabled.

	* res/res_features.c: Clean up a few coding guidelines issues -
	  spaces to tabs, use sizeof() to pass the size of a static buffer,
	  add spaces ...

2007-02-16 17:25 +0000 [r54886]  Jason Parker <jparker@digium.com>

	* main/asterisk.c: Clarify a restart message. It's silly, but the
	  reporter had a very valid point. Issue 9079

2007-02-16 17:02 +0000 [r54884]  Joshua Colp <jcolp@digium.com>

	* apps/app_dial.c: Allow directed pickup to pick up the real
	  context instead of the macro context if a Macro is used. (issue
	  #8984 reported by jamesb63)

2007-02-16 12:06 +0000 [r54772-54787]  Olle Johansson <oej@edvina.net>

	* channels/chan_sip.c: Issue #7541 - Handle multipart attachments
	  to SIP messages - even if boundary is quoted.

	* /, res/res_agi.c: Merged revisions 54771 via svnmerge from
	  https://origsvn.digium.com/svn/asterisk/branches/1.2 ........
	  r54771 | oej | 2007-02-16 12:38:03 +0100 (Fri, 16 Feb 2007) | 2
	  lines Issue #9069 - If we open with TH we should not close with
	  /TD. (seanbright) ........

2007-02-16 00:48 +0000 [r54481-54714]  Joshua Colp <jcolp@digium.com>

	* apps/app_speech_utils.c: Don't let dtmf leak over into the engine
	  and let it skew the results... also give DTMF results priority.
	  (issue #9014 reported by surftek)

	* apps/app_dial.c, /: Merged revisions 54622 via svnmerge from
	  https://origsvn.digium.com/svn/asterisk/branches/1.2 ........
	  r54622 | file | 2007-02-15 11:14:40 -0500 (Thu, 15 Feb 2007) | 2
	  lines Use a separate variable to indicate execution should
	  continue instead of the return value. (issue #8842 reported by
	  pluto70) ........

	* apps/app_dial.c: Forward begin DTMF frames as well as end. (issue
	  #9068 reported by mhardeman)

2007-02-14 18:44 +0000 [r54439]  Olle Johansson <oej@edvina.net>

	* /: Block patch only needed in 1.2

2007-02-14 16:56 +0000 [r54375]  Matt Frederickson <creslin@digium.com>

	* channels/chan_zap.c, /: Merged revisions 54373 via svnmerge from
	  https://origsvn.digium.com/svn/asterisk/branches/1.2 ........
	  r54373 | mattf | 2007-02-14 10:25:49 -0600 (Wed, 14 Feb 2007) | 2
	  lines When handling glare on a PRI, move the requested channel
	  rather than hang up the old one. Fix for 8957 and 9011. ........

2007-02-14 01:09 +0000 [r54290]  Joshua Colp <jcolp@digium.com>

	* main/channel.c: Add G722 to ast_best_codec. If anyone disagrees
	  with it's placement, feel free to change it. (issue #9045
	  reported by gork)

2007-02-13 21:31 +0000 [r54204-54235]  Russell Bryant <russell@digium.com>

	* channels/chan_sip.c: Remove a couple of leftover debug messages

	* include/asterisk/devicestate.h: Fix the documentation on the
	  return values from device state provider registration and
	  deletion.

	* channels/chan_sip.c: If we fail to create the SIP socket, then
	  return -1 from reload_config() so that load_module() will return
	  AST_MODULE_LOAD_DECLINE. Otherwise, the console will just get
	  spammed with error messages every time chan_sip tries to send a
	  message.

2007-02-13 18:41 +0000 [r54180]  Olle Johansson <oej@edvina.net>

	* /: Blocking patch for 1.2 only

2007-02-12 19:17 +0000 [r54066-54103]  Russell Bryant <russell@digium.com>

	* main/dial.c, include/asterisk/dial.h: Change
	  ast_set_state_callback() to ast_dial_set_state_callback()

	* main/dial.c, apps/app_meetme.c, apps/app_page.c,
	  include/asterisk/dial.h: - Add the ability to register a callback
	  to monitor state changes in an asynchronous dial operation. -
	  Rename the various references to "status" to "state" in the dial
	  API

2007-02-12 16:34 +0000 [r54026]  Joshua Colp <jcolp@digium.com>

	* configure, configure.ac: Make the --without-oss argument work.
	  (issue #9026 reported by puzzled)

2007-02-12 15:38 +0000 [r54002]  Russell Bryant <russell@digium.com>

	* configs/users.conf.sample: Fix a typo where "vmpassword" should
	  be "vmsecret"

2007-02-10 09:09 +0000 [r53878-53881]  Paul Cadach <paul@odt.east.telecom.kz>

	* channels/chan_h323.c: Fix VLDTMF reception

	* apps/app_echo.c: Much simpler than previous one ;-)

	* main/channel.c: Provide correct DTMF duration

	* main/cli.c: Bring deprecated 'debug channel <x|all>' command back

2007-02-10 06:06 +0000 [r53850]  Kevin P. Fleming <kpfleming@digium.com>

	* configure, configure.ac, acinclude.m4: don't display the
	  --with-imap message unless --with-imap was specified without a
	  path use '-n' instead of '! -z' for tests

2007-02-10 01:02 +0000 [r53783-53821]  Russell Bryant <russell@digium.com>

	* apps/app_meetme.c: Add some output for "show application
	  SLAStation/SLATrunk"

	* channels/chan_sip.c: Change some text to properly state "On
	  Hold", which was already done in trunk.

	* configs/sla.conf.sample, include/asterisk/app.h,
	  include/asterisk/utils.h, main/dial.c, apps/app_meetme.c,
	  channels/chan_sip.c, doc/sla.txt (added),
	  include/asterisk/linkedlists.h, include/asterisk/dial.h: Merge
	  team/russell/sla_rewrite This is a completely new implementation
	  of the SLA functionality introduced in Asterisk 1.4. It is now
	  functional and ready for testing. However, I will be adding some
	  additional features over the next week, as well. For information
	  on how to set this up, see configs/sla.conf.sample and
	  doc/sla.txt. In addition to the changes in app_meetme.c for the
	  SLA implementation itself, this merge brings in various other
	  changes: chan_sip: - Add the ability to indicate HOLD state in
	  NOTIFY messages. - Queue HOLD and UNHOLD control frames even if
	  the channel is not bridged to another channel. linkedlists.h: -
	  Add support for rwlock based linked lists. dial.c: - Add the
	  ability to run ast_dial_start() without a reference channel to
	  inherit information from.

	* apps/app_echo.c: When the Echo() application receives the digit
	  '#', echo that back as well. Since we already sent the BEGIN
	  frame for that digit, it makes sense to send the END as well.

2007-02-09 23:52 +0000 [r53779-53781]  Kevin P. Fleming <kpfleming@digium.com>

	* channels/chan_gtalk.c: another dependency

	* apps/app_adsiprog.c, apps/app_voicemail.c, res/res_config_odbc.c,
	  funcs/func_odbc.c, res/res_adsi.c: add some inter-module
	  dependencies

	* build_tools/get_moduleinfo, build_tools/get_makeopts: fix awk
	  scripts to work when both MODULEINFO and MAKEOPTS are present in
	  a source file

2007-02-09 19:33 +0000 [r53749]  Joshua Colp <jcolp@digium.com>

	* apps/app_dial.c: Temporarily change musicclass on channel to one
	  specified in Dial so that the 'm' option functions properly.
	  (issue #8969 reported by christianbee)

2007-02-09 16:42 +0000 [r53715]  Kevin P. Fleming <kpfleming@digium.com>

	* doc/imapstorage.txt, configure, configure.ac: clarify the fact
	  that voicemail IMAP storage cannot be built against a distro's
	  binary c-client library package (at least not at this time)

2007-02-08 23:18 +0000 [r53672]  Olle Johansson <oej@edvina.net>

	* main/acl.c: Don't output debug unless we asked for it

2007-02-08 17:54 +0000 [r53601]  Joshua Colp <jcolp@digium.com>

	* apps/app_speech_utils.c: Fix timeout issue when utterance is
	  longer then timeout itself.

2007-02-08 13:47 +0000 [r53530-53532]  Tilghman Lesher <tilghman@mail.jeffandtilghman.com>

	* main/loader.c: Issue 9007 - Mutex not released on early return

	* apps/app_voicemail.c, /: Merged revisions 53529 via svnmerge from
	  https://origsvn.digium.com/svn/asterisk/branches/1.2 ........
	  r53529 | tilghman | 2007-02-08 07:36:10 -0600 (Thu, 08 Feb 2007)
	  | 2 lines Issue 9003 - If fullname is empty, quote() passes back
	  "\"" ........

2007-02-07 23:52 +0000 [r53464-53497]  Russell Bryant <russell@digium.com>

	* main/db1-ast/Makefile: When building libdb1.a, put the additional
	  flags needed at the beginning of ASTCFLAGS, instead of at the
	  end. This way, we ensure that we find the local headers first
	  before accidentally trying to use headers that exist in locations
	  specified in the ASTCFLAGS passed from the main Makefile. (issue
	  #8637, ovi)

	* main/Makefile: The clean target actually needs to run "distclean"
	  on editline. This is because we need to make sure that its
	  configure script gets executed again, because the CFLAGS we want
	  to pass to editline may have changed.

2007-02-07 17:53 +0000 [r53434]  Joshua Colp <jcolp@digium.com>

	* main/rtp.c: We can not reliably do P2P bridging with DTMF passing
	  back with compensation if we need to listen for DTMF frames.
	  (issue #8962 reported by caio1982)

2007-02-07 17:39 +0000 [r53429]  Russell Bryant <russell@digium.com>

	* main/rtp.c: When parsing the NTP timestamp in a sender report
	  message, you are supposed to take the low 16 bits of the integer
	  part, and the high 16 bits of the fractional part. However, the
	  code here was erroneously taking the low 16 bits of the
	  fractional part. It then shifted the result 16 bits down, so the
	  result was always zero. This fix makes it grab the appropriate
	  high 16 bits, instead. (issue #8991, pointed out by
	  andre_abrantes)

2007-02-07 17:04 +0000 [r53358-53399]  Joshua Colp <jcolp@digium.com>

	* apps/app_playback.c: Directly load say.conf in load_module
	  instead of calling the reload function. (issue #8946 reported by
	  junky)

	* /, channels/chan_iax2.c: Merged revisions 53357 via svnmerge from
	  https://origsvn.digium.com/svn/asterisk/branches/1.2 ........
	  r53357 | file | 2007-02-07 10:38:48 -0500 (Wed, 07 Feb 2007) | 2
	  lines Fix a few potential memory leaks with realtime users and
	  peers. (issue #8999 reported by bsmithurst) ........

2007-02-07 15:33 +0000 [r53355]  Tilghman Lesher <tilghman@mail.jeffandtilghman.com>

	* /, apps/app_macro.c: Merged revisions 53354 via svnmerge from
	  https://origsvn.digium.com/svn/asterisk/branches/1.2 ........
	  r53354 | tilghman | 2007-02-07 09:30:02 -0600 (Wed, 07 Feb 2007)
	  | 2 lines Issue 7440 - Macro called from Macro from the h
	  extension exits prematurely ........

2007-02-07 09:22 +0000 [r53324]  Christian Richter <christian.richter@beronet.com>

	* channels/misdn/isdn_lib.c, channels/chan_misdn.c, /: Merged
	  revisions 52843 via svnmerge from
	  https://origsvn.digium.com/svn/asterisk/branches/1.2 ........
	  r52843 | crichter | 2007-01-30 15:38:08 +0100 (Di, 30 Jan 2007) |
	  1 line fixed some possible segfaults. also fixed an very
	  important bug which occurs on high load (when calls are very fast
	  generated) ........

2007-02-07 05:24 +0000 [r53246-53294]  Tilghman Lesher <tilghman@mail.jeffandtilghman.com>

	* res/res_jabber.c: Text fix for jabber reload command (reported by
	  bkruse via IRC)

	* main/manager.c, /: Merged revisions 53245 via svnmerge from
	  https://origsvn.digium.com/svn/asterisk/branches/1.2 ........
	  r53245 | tilghman | 2007-02-06 00:58:28 -0600 (Tue, 06 Feb 2007)
	  | 2 lines Issue 8987 - Status could return two responses
	  (mnicholson) ........

2007-02-05 23:43 +0000 [r53222]  Olle Johansson <oej@edvina.net>

	* channels/chan_sip.c: Formatting

2007-02-05 17:06 +0000 [r53150-53152]  Joshua Colp <jcolp@digium.com>

	* apps/app_playback.c: Ensure say_cfg is NULL when the module is
	  loaded. (issue #8946 reported by junky)

	* apps/app_playback.c: Unregister Playback CLI commands as well as
	  dialplan application. (issue #8946 reported by junky)

2007-02-05 00:18 +0000 [r53143]  Olle Johansson <oej@edvina.net>

	* channels/chan_sip.c: Add some comments on queue system behaviour
	  and how it affects the SIP channel

2007-02-03 21:05 +0000 [r53138]  Joshua Colp <jcolp@digium.com>

	* channels/chan_sip.c: Make SIPDtmfMode application work with
	  recent capability changes, and also fix an RTP stack issue when
	  the auto option was used. (issue #8972 reported by mdu113)

2007-02-03 20:44 +0000 [r53135-53136]  Russell Bryant <russell@digium.com>

	* apps/app_dial.c, /: Merged revisions 53133 via svnmerge from
	  https://origsvn.digium.com/svn/asterisk/branches/1.2 ........
	  r53133 | russell | 2007-02-03 14:38:13 -0600 (Sat, 03 Feb 2007) |
	  4 lines set the DIALSTATUS variable to contain "INVALIDARGS" when
	  the dial application exits early because of invalid arguments
	  instead of just leaving it empty. (issue #8975) ........

	* /: Blocked revisions 53134 via svnmerge ........ r53134 | russell
	  | 2007-02-03 14:39:45 -0600 (Sat, 03 Feb 2007) | 2 lines Revert
	  some changes that accidentally got committed as a part of another
	  fix. ........

2007-02-03 10:02 +0000 [r53131]  Paul Cadach <paul@odt.east.telecom.kz>

	* channels/h323/ast_h323.cxx: Remove quote from H.323 vendor string
	  because due to compatibilities with CS1000 reported at
	  www.voip-info.org

2007-02-02 21:26 +0000 [r53129]  BJ Weschke <bweschke@btwtech.com>

	* UPGRADE.txt, apps/app_queue.c: I'm baaaaaaaaaack. :) Post a
	  warning to the console that things might possibly be
	  misconfigured when queue member's states are still 'Not in Use'
	  when we're about to bridge them with a caller from queue. Also,
	  put some documentation quoted from oej's queues.txt efforts
	  started in /trunk today. This commit puts #7433 into feedback
	  state for 1.4, and pending no further negative feedback, it will
	  finally be closed.

2007-02-02 17:15 +0000 [r53114-53120]  Joshua Colp <jcolp@digium.com>

	* main/rtp.c: Correct a copy/pasted error message line for RTCP.

	* main/config.c, /: Merged revisions 53117 via svnmerge from
	  https://origsvn.digium.com/svn/asterisk/branches/1.2 ........
	  r53117 | file | 2007-02-02 10:58:09 -0600 (Fri, 02 Feb 2007) | 2
	  lines Pass the glob expanded filename to process_text_line so
	  that error messages contain the actual filename, not the original
	  include one. (issue #8959 reported by tzafrir) ........

	* Makefile: Add systemname to asterisk.conf generation per recent
	  discussions about it. (issue #8968 reported by blitzrage)

2007-02-02 00:24 +0000 [r53109]  Olle Johansson <oej@edvina.net>

	* channels/chan_sip.c, configs/sip.conf.sample: Disable the direct
	  p2p RTP call setup in SIP. You can enable it in sip.conf, but it
	  is now considered experimental until we solve the
	  AST_CONTROL_ANSWER with payload and videocaps stuff.

2007-02-01 23:16 +0000 [r53108]  Jason Parker <jparker@digium.com>

	* /: Blocked revisions 53107 via svnmerge ........ r53107 | qwell |
	  2007-02-01 17:14:09 -0600 (Thu, 01 Feb 2007) | 2 lines Fix a
	  small typo. Synopsis lines shouldn't have a newline ........

2007-02-01 22:24 +0000 [r53097-53104]  Joshua Colp <jcolp@digium.com>

	* /, channels/chan_sip.c: Merged revisions 53103 via svnmerge from
	  https://origsvn.digium.com/svn/asterisk/branches/1.2 ........
	  r53103 | file | 2007-02-01 16:21:56 -0600 (Thu, 01 Feb 2007) | 2
	  lines Copy noncodeccapability over to the joint variable so that
	  telephone-event will get transmitted in the sent INVITE. ........

	* main/db1-ast/hash/hash.c: Huh... fix the berkeley DB to compile
	  here as well, but it apparently required both dev mode and no
	  optimizations to creep up.

	* /, channels/chan_sip.c: Merged revisions 53095 via svnmerge from
	  https://origsvn.digium.com/svn/asterisk/branches/1.2 ........
	  r53095 | file | 2007-02-01 15:47:11 -0600 (Thu, 01 Feb 2007) | 2
	  lines Don't negotiate RFC2833 when not configured to do so.
	  (issue #8799 reported by mdu113) ........

2007-02-01 21:24 +0000 [r53093]  Russell Bryant <russell@digium.com>

	* funcs/func_strings.c: Fix the FIELDQTY function to not crash.
	  (reported by blitzrage and Corydon on IRC)

2007-02-01 21:15 +0000 [r53091]  Olle Johansson <oej@edvina.net>

	* /: Going backwards, blame file.

2007-02-01 21:11 +0000 [r53086-53088]  Joshua Colp <jcolp@digium.com>

	* /, res/res_musiconhold.c: Merged revisions 53084 via svnmerge
	  from https://origsvn.digium.com/svn/asterisk/branches/1.2
	  ........ r53084 | file | 2007-02-01 15:03:10 -0600 (Thu, 01 Feb
	  2007) | 2 lines Return previous behavior of having MOH pick up
	  where it was left off. (issue #8672 reported by sinistermidget)
	  ........

	* funcs/func_strings.c: Make func_strings build under dev mode.
	  Didn't I do this today already in the berkeley DB?

2007-02-01 21:05 +0000 [r53079-53085]  Olle Johansson <oej@edvina.net>

	* channels/chan_sip.c: - Clean INC_COUNT flag when we decrement
	  call counter - If it's still set at time of dialog destruction,
	  make sure we decrement the device call counter properly before we
	  destroy the dialog

	* apps/app_queue.c: Change debug level for state change message
	  that is not really informative when debugging app_queue

	* channels/chan_sip.c: Cleaning up the devicestate callback
	  function

2007-02-01 20:13 +0000 [r53075-53077]  Tilghman Lesher <tilghman@mail.jeffandtilghman.com>

	* funcs/func_strings.c: Oops.

	* /, funcs/func_strings.c: Merged revisions 53074 via svnmerge from
	  https://origsvn.digium.com/svn/asterisk/branches/1.2 ........
	  r53074 | tilghman | 2007-02-01 14:07:35 -0600 (Thu, 01 Feb 2007)
	  | 2 lines Bug 8965 ........

2007-02-01 19:33 +0000 [r53072]  Joshua Colp <jcolp@digium.com>

	* main/asterisk.c: Add missing 'F' letter to getopt so it magically
	  becomes a valid option. (issue #8960 reported by tzafrir)

2007-02-01 19:21 +0000 [r53070]  Tilghman Lesher <tilghman@mail.jeffandtilghman.com>

	* main/pbx.c, /, funcs/func_strings.c: Merged revisions 53069 via
	  svnmerge from
	  https://origsvn.digium.com/svn/asterisk/branches/1.2 ........
	  r53069 | tilghman | 2007-02-01 13:13:53 -0600 (Thu, 01 Feb 2007)
	  | 2 lines No wonder FIELDQTY doesn't work with functions... the
	  documentation in pbx.c was wrong ........

2007-02-01 17:37 +0000 [r53064]  Joshua Colp <jcolp@digium.com>

	* channels/chan_sip.c: Fix silly logic. We really want to write
	  UDPTL frames out when the call is up.

2007-02-01 16:35 +0000 [r53062]  Olle Johansson <oej@edvina.net>

	* configs/sip.conf.sample: Add explanation of port= in combination
	  with defaultip= (thanks jsmith)

2007-02-01 13:17 +0000 [r53060]  Christian Richter <christian.richter@beronet.com>

	* channels/chan_misdn.c: we update the name on any first reply of
	  our setup

2007-02-01 11:07 +0000 [r53057]  Paul Cadach <paul@odt.east.telecom.kz>

	* channels/chan_h323.c: chan_h323 is very stable, so let it built
	  by default

2007-02-01 00:24 +0000 [r53050-53052]  Joshua Colp <jcolp@digium.com>

	* main/rtp.c: When going on hold have the side that was put on hold
	  reinvite back to Asterisk. When going off hold have the side that
	  was taken off hold reinvited back to the other party.

	* main/rtp.c: Add more frame types to forward in the RTP bridge
	  loops.

2007-01-31 21:32 +0000 [r52859-53046]  Russell Bryant <russell@digium.com>

	* main/cdr.c, main/manager.c, pbx/pbx_spool.c,
	  channels/chan_skinny.c, channels/chan_h323.c, main/http.c,
	  pbx/pbx_dundi.c, apps/app_rpt.c, channels/chan_mgcp.c,
	  main/pbx.c, channels/chan_zap.c, /, apps/app_meetme.c,
	  channels/chan_sip.c, apps/app_queue.c, channels/chan_iax2.c:
	  Merged revisions 53045 via svnmerge from
	  https://origsvn.digium.com/svn/asterisk/branches/1.2 ........
	  r53045 | russell | 2007-01-31 15:25:11 -0600 (Wed, 31 Jan 2007) |
	  3 lines Fix a bunch of places where pthread_attr_init() was
	  called, but pthread_attr_destroy() was not. ........

	* apps/app_userevent.c: Remove an extra \r\n from manager user
	  events. (issue #8955, mnicholson)

	* main/rtp.c, /: Merged revisions 53039 via svnmerge from
	  https://origsvn.digium.com/svn/asterisk/branches/1.2 ........
	  r53039 | russell | 2007-01-31 11:41:51 -0600 (Wed, 31 Jan 2007) |
	  3 lines Use the proper format string to print unsigned values in
	  the rtp debug output. (issue #8954, wmis) ........

	* apps/app_queue.c: Only changed the paused status in an existing
	  queue member if the paused column exists.

	* apps/app_queue.c: Instead of always creating a realtime queue
	  member as unpaused, read the "paused" column and use that value
	  for the paused status of the member. (issue #8949, jmls)

	* contrib/init.d/rc.suse.asterisk: Update init script for SuSE 10.
	  (issue #8363, johnlange)

	* doc/cdrdriver.txt: Add documentation for using cdr_pgsql. (issue
	  #8942, lters)

	* configure, include/asterisk/autoconfig.h.in, configure.ac,
	  codecs/codec_gsm.c: When we are checking for a system installed
	  version of libgsm, we need to check for gsm.h as well.
	  Furthermore, when checking for this header, it may be located in
	  a gsm/ sub directory, so check for that, as well. (issue #8773)

	* /: Blocked revisions 52954 via svnmerge ........ r52954 | russell
	  | 2007-01-30 13:41:52 -0600 (Tue, 30 Jan 2007) | 4 lines Don't
	  print a message indicating that we don't know what to do with a
	  proceeding control frame in ast_request_and_dial(). We just need
	  to ignore it. (reported by JerJer on #asterisk-dev) ........

	* channels/chan_sip.c: Only set the DTMF flag on the rtp structure
	  if the DTMF mode is actually RFC2833, not just that it is not
	  INFO. This makes it get set for inband DTMF as well, which is not
	  valid. (issue #8936)

	* main/asterisk.c, /: Merged revisions 52903 via svnmerge from
	  https://origsvn.digium.com/svn/asterisk/branches/1.2 ........
	  r52903 | russell | 2007-01-30 11:12:04 -0600 (Tue, 30 Jan 2007) |
	  9 lines The SIGHUP handler was implemented to allow admins to
	  send SIGHUP to a running Asterisk process to reload the
	  configuration. However, doing the actual reload in the signal
	  handler itself is a very bad thing to do, because the reload
	  process includes calling non-reentrant functions such as
	  malloc/calloc/etc. If Asterisk is running in the background, then
	  the reload will happen immediately. However, if running in
	  console mode, the reload doesn't work until something is typed at
	  the console. That sort of defeats the purpose, but I don't see an
	  easy way to get around it at this point. ........

	* /: Blocked revisions 52857 via svnmerge ........ r52857 | russell
	  | 2007-01-30 09:35:23 -0600 (Tue, 30 Jan 2007) | 5 lines Comment
	  out the parts in the Makefile that make codec_zap get built. It
	  will not yet build against zaptel 1.2, so I am disabling it to
	  prevent further bug reports until it gets merged. (issue #8940)
	  ........

2007-01-30 15:29 +0000 [r52856]  Joshua Colp <jcolp@digium.com>

	* channels/chan_iax2.c: Drop the deprecated show commands since the
	  original ones were changed back. (issue #8937 reported by
	  PCadach)

2007-01-30 08:46 +0000 [r52807-52809]  Paul Cadach <paul@odt.east.telecom.kz>

	* channels/chan_h323.c: Revert reprecation of h.323 gk cycle
	  command from pre-1.4 version instead of duplicated h323 cycle gk

	* res/res_odbc.c: Don't play with free()'d pointers

	* configure, acinclude.m4: Handle non-standard OpenH323/PWLib
	  library names

2007-01-30 00:15 +0000 [r52763]  Russell Bryant <russell@digium.com>

	* /, channels/chan_iax2.c: Merged revisions 52762 via svnmerge from
	  https://origsvn.digium.com/svn/asterisk/branches/1.2 ........
	  r52762 | russell | 2007-01-29 18:15:06 -0600 (Mon, 29 Jan 2007) |
	  5 lines Fix the extraction of the timestamp from video frames. It
	  was using the mapping for a mini-frame instead of a video-frame,
	  which caused it to get invalid data. (issue #8795, mihai)
	  ........

2007-01-29 23:43 +0000 [r52717]  Joshua Colp <jcolp@digium.com>

	* apps/app_mixmonitor.c, /: Merged revisions 52716 via svnmerge
	  from https://origsvn.digium.com/svn/asterisk/branches/1.2
	  ........ r52716 | file | 2007-01-29 18:39:39 -0500 (Mon, 29 Jan
	  2007) | 2 lines Now that filename is part of the structure and
	  since it comes before postprocess... we have to add it to our
	  postprocess line. (reported on asterisk-dev by Boris Bakchiev)
	  ........

2007-01-29 22:58 +0000 [r52688-52695]  Russell Bryant <russell@digium.com>

	* main/Makefile: Add a missing quotation mark. This was pointed out
	  by jcmoore on #asterisk-dev.

	* main/manager.c: Remove a recursive lock of the manager session.
	  This was pointed out by zandbelt in issue #8711.

2007-01-29 22:12 +0000 [r52679]  Tilghman Lesher <tilghman@mail.jeffandtilghman.com>

	* pbx/pbx_config.c: Argument number correction

2007-01-29 21:36 +0000 [r52611-52647]  Russell Bryant <russell@digium.com>

	* main/Makefile: ASTLDFLAGS needs to be passed to the editline
	  configure script as LDFLAGS. (issue #8928, zandbelt)

	* main/rtp.c: Fix a problem with packet-to-packet bridging and DTMF
	  mode translation. P2P bridging can only be used when the DTMF
	  modes don't match if the core is monitoring DTMF in both
	  directions. Then, the core will handle the translation.
	  Otherwise, this bridging method can not be used. (issue #8936)

	* main/manager.c: The session lock can not be held while calling
	  action callbacks. If so, then when the WaitEvent callback gets
	  called, then no event can happen because the session can't be
	  locked by another thread. Also, the session needs to be locked in
	  the HTTP callback when it reads out the output string. This fixes
	  the deadlock reported in both 8711 and 8934. Regarding issue
	  8711, there still may be an issue. If there is a second action
	  requested before the processing of the first action is finished,
	  there could still be some corruption of the output string buffer
	  used to build the result. (issue #8711, #8934)

2007-01-29 18:59 +0000 [r52572]  Joshua Colp <jcolp@digium.com>

	* apps/app_voicemail.c: Use ast_calloc instead of malloc.

2007-01-29 17:57 +0000 [r52535]  Steve Murphy <murf@digium.com>

	* apps/app_voicemail.c, main/say.c: this is for 8778 (pt_BR
	  backport to 1.4). It was committed to trunk via 7663. But it
	  wasn't so much an enhancement as a fix for the bad language
	  output for portuguese in Brazil, so, after a lot of prodding from
	  patient Brazilians, here is the same fix for 1.4

2007-01-29 17:33 +0000 [r52523]  Joshua Colp <jcolp@digium.com>

	* apps/app_voicemail.c: Set quota information to 0 when creating a
	  vm_state. (issue #8924 reported by neutrino88)

2007-01-29 16:54 +0000 [r52506]  Russell Bryant <russell@digium.com>

	* main/jitterbuf.c, include/jitterbuf.h: Clean up a few things in
	  the last commit to the adaptive jitterbuffer code. - Specifically
	  indicate to the compiler that the "dropem" variable only needs
	  one but. - Change formatting to conform to coding guidelines.

2007-01-29 04:18 +0000 [r52494]  Jim Dixon <telesistant@hotmail.com>

	* main/jitterbuf.c, include/jitterbuf.h: Fixed problem with
	  jitterbuf, whereas it would not complain about, and would allow
	  itself to be overfilled (per the max_jitterbuf parameter). Now it
	  rejects any data over and above that size, and complains about
	  it.

2007-01-28 05:15 +0000 [r52462]  Tilghman Lesher <tilghman@mail.jeffandtilghman.com>

	* configure, configure.ac: Suggested change to fix normal usage of
	  --with-tds=/usr/local (Sean Bright, via asterisk-dev mailing
	  list)

2007-01-27 02:13 +0000 [r52335-52416]  Joshua Colp <jcolp@digium.com>

	* /, apps/app_queue.c: Merged revisions 52415 via svnmerge from
	  https://origsvn.digium.com/svn/asterisk/branches/1.2 ........
	  r52415 | file | 2007-01-26 21:09:10 -0500 (Fri, 26 Jan 2007) | 2
	  lines Make COMPLETECALLER and COMPLETEAGENT output to queue_log
	  follow documentation. (issue #7677 reported by amilcar) ........

	* main/manager.c: Have the manager interface send back an "Already
	  logged in" message instead of "Invalid/Unknown Command" when the
	  client authenticates for a second time. (issue #8509 reported by
	  pari)

	* /, channels/chan_iax2.c: Merged revisions 52360 via svnmerge from
	  https://origsvn.digium.com/svn/asterisk/branches/1.2 ........
	  r52360 | file | 2007-01-26 19:03:23 -0500 (Fri, 26 Jan 2007) | 2
	  lines Make the last context entry read in the dominant one.
	  (issue #8918 reported by pj) ........

	* main/file.c: Fix core show file formats CLI command.

2007-01-25 19:18 +0000 [r52163-52265]  Joshua Colp <jcolp@digium.com>

	* /, main/jitterbuf.c: Merged revisions 52264 via svnmerge from
	  https://origsvn.digium.com/svn/asterisk/branches/1.2 ........
	  r52264 | file | 2007-01-25 14:15:29 -0500 (Thu, 25 Jan 2007) | 2
	  lines Allow dequeueing of frames with negative timestamp by
	  moving jitterbuffer frames check to jb_next. (issue #8546
	  reported by harmen) ........

	* channels/chan_sip.c: Drop out variables I accidentally put in.

	* channels/chan_sip.c: Decrement onHold count if we are hung up on
	  and still on hold. (issue #8909 reported by alexh42)

	* apps/app_mixmonitor.c, /: Merged revisions 52162 via svnmerge
	  from https://origsvn.digium.com/svn/asterisk/branches/1.2
	  ........ r52162 | file | 2007-01-24 20:48:52 -0500 (Wed, 24 Jan
	  2007) | 2 lines Add another note about audio files being played
	  back to each bridged party. (issue #8718 reported by ppyy)
	  ........

2007-01-25 01:37 +0000 [r52107-52160]  Russell Bryant <russell@digium.com>

	* apps/app_voicemail.c, configs/users.conf.sample: By suggestion
	  from kpfleming last week, change "vmpassword" to "vmsecret".

	* configure, configure.ac: Remove libnsl as a required lib for
	  libiksemel to work. This change was already made in the trunk.
	  (issue #8762)

	* /: Blocked revisions 52137 via svnmerge ........ r52137 | russell
	  | 2007-01-24 18:39:50 -0600 (Wed, 24 Jan 2007) | 3 lines Fix a
	  seg fault when running this application with no arguments from
	  AGI. (issue #8905, junky) ........

	* include/asterisk/dial.h: Fix the formatting of doxygen comments
	  to properly indicate that the comment documents the previous
	  entity, as opposed to the next one.

2007-01-24 18:26 +0000 [r52052]  Steve Murphy <murf@digium.com>

	* utils/check_expr.c, utils/Makefile, /: Merged revisions 52002 via
	  svnmerge from
	  https://origsvn.digium.com/svn/asterisk/branches/1.2 ........
	  r52002 | murf | 2007-01-24 10:43:50 -0700 (Wed, 24 Jan 2007) | 1
	  line updated check_expr via 8322 (refactoring of expression
	  checking impl); elfring contributed a nice code reorg, I
	  contributed some time to get it working again, better messages
	  ........

2007-01-24 18:20 +0000 [r52016-52049]  Joshua Colp <jcolp@digium.com>

	* main/dial.c (added), apps/app_page.c, main/Makefile,
	  include/asterisk/dial.h (added): Merge in dialing API and the
	  app_page that uses it. (issue #BE-118)

	* channels/chan_sip.c: Fix changing channel formats when joint
	  capability changes and there are no audio formats... I didn't
	  break it originally! (issue #8535 reported by ivoc)

2007-01-24 17:14 +0000 [r52000]  Russell Bryant <russell@digium.com>

	* configure: rebuild configure script to reflect last chan_h323
	  related changes.

2007-01-24 12:57 +0000 [r51979-51989]  Christian Richter <christian.richter@beronet.com>

	* channels/chan_misdn.c: added fix from #8899

	* channels/chan_misdn.c, /: Merged revisions 51966 via svnmerge
	  from https://origsvn.digium.com/svn/asterisk/branches/1.2
	  ........ r51966 | crichter | 2007-01-24 11:48:09 +0100 (Mi, 24
	  Jan 2007) | 1 line fixed the busy problem (dialstatus was not
	  busy when we called a busy extension) ........

2007-01-24 09:30 +0000 [r51931]  Olle Johansson <oej@edvina.net>

	* channels/chan_sip.c: Show capabilities *and* preference in
	  general settings in "sip show settings" (reported by Clona/Telio
	  - Thanks!)

2007-01-24 08:04 +0000 [r51895]  Paul Cadach <paul@odt.east.telecom.kz>

	* acinclude.m4: Allow x64 builds of H.323 (please, rebuild
	  configure)

2007-01-24 00:59 +0000 [r51829-51848]  Russell Bryant <russell@digium.com>

	* main/channel.c, /: Merged revisions 51843 via svnmerge from
	  https://origsvn.digium.com/svn/asterisk/branches/1.2 ........
	  r51843 | russell | 2007-01-23 18:57:28 -0600 (Tue, 23 Jan 2007) |
	  6 lines Fix an issue related to synchronization of recordings
	  when using Monitor(). The bug is a miscalculation of the amount
	  to seek the stream for writing to disk when the number of samples
	  coming in and out of a channel do not match up. (issue #8298,
	  #8887, report and patch by guillecabeza, patch files created and
	  testing done by whoiswes) ........

	* apps/app_while.c, /: Merged revisions 51828 via svnmerge from
	  https://origsvn.digium.com/svn/asterisk/branches/1.2 ........
	  r51828 | russell | 2007-01-23 18:17:50 -0600 (Tue, 23 Jan 2007) |
	  4 lines Don't set a new value for the END_ variable on the
	  channel before using the old value. If you do, it will lead to
	  accessing a memory address that has been free()'d. (issue #8895,
	  arkadia) ........

2007-01-23 22:46 +0000 [r51788]  Joshua Colp <jcolp@digium.com>

	* channels/chan_oss.c, channels/chan_phone.c, channels/chan_zap.c,
	  channels/chan_sip.c, channels/chan_skinny.c,
	  channels/chan_features.c, channels/chan_alsa.c,
	  channels/chan_gtalk.c, channels/chan_iax2.c: Update channel
	  drivers to use module referencing so that unloading them while in
	  use will not result in crashes. (issue #8897 reported by junky)

2007-01-23 22:04 +0000 [r51750-51781]  Russell Bryant <russell@digium.com>

	* main/manager.c: Fix some bugs in process_message(). The manager
	  session lock needs to be held when sending some sort of response,
	  or calling one of the manager action callbacks. This resolves an
	  issue where people using the GUI would get random crashes when
	  they start clicking around a lot. (issue #8711, reported and
	  debugged by zandbelt)

	* main/http.c: Fix setting the default port of 8088 on 64-bit or
	  big-endian machines.

	* main/manager.c: When traversing the list of manager actions, the
	  iterator needs to be initialized to the list head *after* locking
	  the list. Also, lock the actions list in one place it is being
	  accessed where it was not being done.

2007-01-23 20:32 +0000 [r51683-51716]  Steve Murphy <murf@digium.com>

	* res/res_features.c: this mod from 8593 (dstchannel in cdr is
	  empty when transfer call).

	* main/callerid.c: via 8748 (callerid.c loses name when returning
	  PRIVATE_NUMBER flag), the user suggested this mod, saying it
	  would allow 'WITHHELD' to appear in the name field, which would
	  be useful

2007-01-23 10:28 +0000 [r51648-51649]  Christian Richter <christian.richter@beronet.com>

	* channels/misdn/isdn_lib.c, channels/chan_misdn.c, /,
	  channels/misdn/isdn_msg_parser.c: Merged revisions 50495,50506
	  via svnmerge from
	  https://origsvn.digium.com/svn/asterisk/branches/1.2 ........
	  r50495 | crichter | 2007-01-11 14:27:52 +0100 (Do, 11 Jan 2007) |
	  6 lines * more additions to make the RESTART message work * added
	  fix for misdn_call to allow SETUPs with empty extensions,
	  replaced the strtok_r functions with strsep for that (inspired by
	  Sandro Cappellazzo, thanks) ........ r50506 | crichter |
	  2007-01-11 15:45:38 +0100 (Do, 11 Jan 2007) | 1 line when we get
	  L2 UP, the L1 is UP definitely too, so we set the L1 state up as
	  well. ........

	* channels/misdn/isdn_lib.c, channels/misdn/isdn_lib.h,
	  channels/chan_misdn.c: manually merged r49922 and r50335, because
	  of conflicts. this commint includes addition of the ISDN RESTART
	  Message

2007-01-23 06:51 +0000 [r51615]  Paul Cadach <paul@odt.east.telecom.kz>

	* channels/chan_h323.c, channels/Makefile: Do not abort Asterisk
	  startup if h323 configuration file not found (reported by
	  mithraen)

2007-01-23 03:00 +0000 [r51513-51558]  Joshua Colp <jcolp@digium.com>

	* channels/chan_sip.c: Only change audio formats on the channel if
	  we have an audio format to change to. (issue #8535 reported by
	  ivoc)

	* /, res/res_musiconhold.c: Merged revisions 51512 via svnmerge
	  from https://origsvn.digium.com/svn/asterisk/branches/1.2
	  ........ r51512 | file | 2007-01-22 20:41:35 -0500 (Mon, 22 Jan
	  2007) | 2 lines Yield before reading from zaptel timing source
	  under Solaris so that other threads get a chance to do things.
	  (issue #7875 reported by bob) ........

2007-01-22 19:41 +0000 [r51411]  Russell Bryant <russell@digium.com>

	* /: Blocked revisions 51410 via svnmerge ........ r51410 | russell
	  | 2007-01-22 13:39:30 -0600 (Mon, 22 Jan 2007) | 3 lines Merge
	  codec_zap support for the transcoder card. This is a standalone
	  codec module so it will not affect anything else. ........

2007-01-22 19:28 +0000 [r51409]  Steve Murphy <murf@digium.com>

	* pbx/pbx_ael.c: This fixes 8836, according to dnatural

2007-01-22 19:13 +0000 [r51360-51407]  Joshua Colp <jcolp@digium.com>

	* apps/app_mixmonitor.c, /: Merged revisions 51406 via svnmerge
	  from https://origsvn.digium.com/svn/asterisk/branches/1.2
	  ........ r51406 | file | 2007-01-22 14:08:52 -0500 (Mon, 22 Jan
	  2007) | 2 lines Move filestream creation to Mixmonitor loop. This
	  will prevent a blank file from being created if no frames ever
	  pass through to be recorded. (issue #7589 reported by
	  steve_mcneil) ........

	* /: Blocked revisions 51359 via svnmerge ........ r51359 | file |
	  2007-01-22 11:23:03 -0500 (Mon, 22 Jan 2007) | 2 lines Explicitly
	  declare what codecs are supported by default globally since using
	  a bitmask for all may include ones we don't need. (issue #8357
	  reported by gknispel_proformatique) ........

2007-01-20 06:53 +0000 [r51348-51350]  Jason Parker <jparker@digium.com>

	* configs/say.conf.sample: Fix Italian numeral support in say.conf
	  for "_[2-9]00" case. "2131" would've translated to something
	  along the lines of (pardon my..Italian {or lack thereof})
	  "duecentocentotrentuno", which makes no sense at all.

	* configs/say.conf.sample: Fix German language support in say.conf
	  Properly support 21, 31, 41, 51, 61, 71, 81, and 91.
	  einundzwanzig has the same format as zweiundzwanzig (as do all
	  other "_ZX" spoken numerals) Fix support for numbers in the
	  10,000,000 to 99,999,999 range. Add support for numbers in the
	  100,000,000 to 999,999,999 range.

2007-01-20 00:13 +0000 [r51302-51343]  Russell Bryant <russell@digium.com>

	* apps/app_meetme.c: Remove an unused instance of an unnamed enum.

	* apps/app_meetme.c: Remove another duplicated definition

	* apps/app_meetme.c: Remove a variable that was declared twice.

	* codecs/gsm/Makefile: Add a couple more processors that need
	  optimizations excluded. (issue #8637)

	* channels/chan_gtalk.c: Fix VLDTMF support in chan_gtalk.
	  AST_FRAME_DTMF and AST_FRAME_DTMF_END are actually the same
	  thing. So, a digit would have been interpreted incorrectly here.
	  Since the channel driver will always have the begin and end
	  callbacks called for a digit, only support the button-down and
	  button-up messages.

	* .cleancount: Bump the cleancount since my last commit changed the
	  channel structure.

	* channels/chan_oss.c, main/rtp.c, main/channel.c,
	  channels/chan_phone.c, channels/chan_misdn.c,
	  channels/chan_skinny.c, channels/chan_features.c,
	  channels/chan_h323.c, channels/chan_alsa.c, channels/chan_mgcp.c,
	  channels/chan_zap.c, channels/chan_local.c, main/frame.c,
	  channels/chan_sip.c, channels/chan_agent.c,
	  include/asterisk/channel.h, channels/chan_gtalk.c,
	  channels/chan_iax2.c: Merge the changes from the
	  /team/group/vldtmf_fixup branch. The main bug being addressed
	  here is a problem introduced when two SIP channels using SIP INFO
	  dtmf have their media directly bridged. So, when a DTMF END frame
	  comes into Asterisk from an incoming INFO message, Asterisk would
	  try to emulate a digit of some length by first sending a DTMF
	  BEGIN frame and sending a DTMF END later timed off of incoming
	  audio. However, since there was no audio coming in, the DTMF_END
	  was never generated. This caused DTMF based features to no longer
	  work. To fix this, the core now knows when a channel doesn't care
	  about DTMF BEGIN frames (such as a SIP channel sending INFO
	  dtmf). If this is the case, then Asterisk will not emulate a
	  digit of some length, and will instead just pass through the
	  single DTMF END event. Channel drivers also now get passed the
	  length of the digit to their digit_end callback. This improves
	  SIP INFO support even further by enabling us to put the real
	  digit duration in the INFO message instead of a hard coded 250ms.
	  Also, for an incoming INFO message, the duration is read from the
	  frame and passed into the core instead of just getting ignored.
	  (issue #8597, maybe others...)

	* main/asterisk.c: Merged revisions 51300 via svnmerge from
	  https://origsvn.digium.com/svn/asterisk/branches/1.2 ........
	  r51300 | russell | 2007-01-19 10:44:09 -0600 (Fri, 19 Jan 2007) |
	  4 lines Fix a memory leak on command line tab completion. The
	  container for the matches was freed, but the individual matches
	  themselves were not. (issue #8851, arkadia) ........

2007-01-19 00:17 +0000 [r51272-51274]  Dwayne M. Hubbard <dhubbard@digium.com>

	* channels/chan_zap.c: chan_zap compiles without libpri after
	  committing 7877 patch

	* channels/chan_zap.c, /: Merged revisions 51271 via svnmerge from
	  https://origsvn.digium.com/svn/asterisk/branches/1.2 ........
	  r51271 | dhubbard | 2007-01-18 17:47:10 -0600 (Thu, 18 Jan 2007)
	  | 3 lines issue 7877: chan_zap module reload does not use
	  default/initialized values on subsequent loads. Reset
	  configuration variables to default values prior to parsing
	  configuration file. ........

2007-01-18 23:36 +0000 [r51270]  Kevin P. Fleming <kpfleming@digium.com>

	* /: block this patch since it is already here

2007-01-18 22:50 +0000 [r51265]  Jason Parker <jparker@digium.com>

	* apps/app_voicemail.c, main/channel.c, main/pbx.c,
	  funcs/func_strings.c, main/app.c: Add some more checks for
	  option_debug before ast_log(LOG_DEBUG, ...) calls. Issue 8832,
	  patch(es) by tgrman

2007-01-18 21:54 +0000 [r51262]  Russell Bryant <russell@digium.com>

	* Makefile, configure, main/Makefile, acinclude.m4, makeopts.in:
	  Ensure that the locations given to the Asterisk configure script
	  for ncurses, curses, termcap, or tinfo are further passed along
	  to the editline configure script. This fixes some
	  cross-compilation environments. (issue #8637, reported by ovi,
	  patch by me)

2007-01-18 21:14 +0000 [r51256]  Tilghman Lesher <tilghman@mail.jeffandtilghman.com>

	* /, main/stdtime/localtime.c: Merged revisions 51255 via svnmerge
	  from https://origsvn.digium.com/svn/asterisk/branches/1.2
	  ........ r51255 | tilghman | 2007-01-18 15:11:34 -0600 (Thu, 18
	  Jan 2007) | 2 lines If a timezone is not specified, assume
	  localtime (instead of gmtime) (Issue #7748) ........

2007-01-18 19:17 +0000 [r51251]  Joshua Colp <jcolp@digium.com>

	* apps/app_speech_utils.c: Only start timeout once we reach the end
	  of the files to play back.

2007-01-18 18:42 +0000 [r51245]  Jason Parker <jparker@digium.com>

	* main/cli.c: Fix an issue with file name completion in "module
	  load" and "load". Issue 8846

2007-01-18 18:36 +0000 [r51243]  Joshua Colp <jcolp@digium.com>

	* channels/chan_sip.c: Copy MOH settings when calling a peer so
	  that if they put someone on hold or get put on hold themselves
	  they get the right music class. (issue #8840 reported by mdu113)

2007-01-18 18:28 +0000 [r51241]  Jason Parker <jparker@digium.com>

	* main/channel.c: Fix an issue with deprecated commands

2007-01-18 17:49 +0000 [r51236]  Tilghman Lesher <tilghman@mail.jeffandtilghman.com>

	* contrib/scripts/vmdb.sql, /: Merged revisions 51235 via svnmerge
	  from https://origsvn.digium.com/svn/asterisk/branches/1.2
	  ........ r51235 | tilghman | 2007-01-18 11:42:17 -0600 (Thu, 18
	  Jan 2007) | 2 lines Document all the fields, including the
	  indication that "uniqueid" should not be renamed. ........

2007-01-18 17:18 +0000 [r51233]  Russell Bryant <russell@digium.com>

	* main/manager.c: Make the "hasmanager" option in users.conf
	  actually have an effect. (issue #8740, LnxPrgr3)

2007-01-18 00:48 +0000 [r51211-51213]  Joshua Colp <jcolp@digium.com>

	* apps/app_voicemail.c: Build the IMAP remote directory string
	  better and properly. Fix an issue with encoding the GSM voicemail
	  when attaching to the voicemail. (issue #8808 reported by
	  akohlsmith)

	* main/rtp.c: Pass data as well for hold/unhold/vidupdate frames.
	  (issue #8840 reported by mdu113)

2007-01-17 23:31 +0000 [r51198-51205]  Russell Bryant <russell@digium.com>

	* funcs/func_odbc.c: Fix some instances where when loading
	  func_odbc, a double-free could occur. Also, remove an unneeded
	  error message. If the failure condition is actually a memory
	  allocation failure, a log message will already be generated
	  automatically.

	* channels/chan_zap.c: Instead of dividing the offset by 2
	  directly, make it more clear that the offset is being scaled by
	  the size of the elements in the buffer. (Inspired by a discussing
	  on the asterisk-dev list about this code)

	* /, channels/chan_sip.c: Merged revisions 51197 via svnmerge from
	  https://origsvn.digium.com/svn/asterisk/branches/1.2 ........
	  r51197 | russell | 2007-01-17 15:17:21 -0600 (Wed, 17 Jan 2007) |
	  3 lines Move the check for a failure of ast_channel_alloc() to
	  before locking the pvt structure again. Otherwise, on a failure,
	  this will cause a deadlock. ........

2007-01-17 20:56 +0000 [r51195]  Tilghman Lesher <tilghman@mail.jeffandtilghman.com>

	* /, main/utils.c: Merged revisions 51194 via svnmerge from
	  https://origsvn.digium.com/svn/asterisk/branches/1.2 ........
	  r51194 | tilghman | 2007-01-17 14:52:21 -0600 (Wed, 17 Jan 2007)
	  | 4 lines When ast_strip_quoted was called with a zero-length
	  string, it would treat a NULL as if it were the quoting character
	  (and would thus return the string in memory immediately following
	  the passed-in string). ........

2007-01-17 17:36 +0000 [r51186]  Jason Parker <jparker@digium.com>

	* apps/app_voicemail.c: re-add "password" for realtime voicemail

2007-01-17 06:36 +0000 [r51182]  Joshua Colp <jcolp@digium.com>

	* main/rtp.c: Return the correct result when directly writing out a
	  packet so that the core doesn't then decide to handle it the
	  regular way again. (issue #8833 reported by rcourtna)

2007-01-17 01:29 +0000 [r51176]  Kevin P. Fleming <kpfleming@digium.com>

	* apps/app_voicemail.c: a few more coding style cleanups and one
	  bug fix (from AnthonyL)

2007-01-17 00:46 +0000 [r51172]  Joshua Colp <jcolp@digium.com>

	* channels/chan_iax2.c: Move rescheduling of lagrq/pings into the
	  scheduler callback.

2007-01-17 00:20 +0000 [r51165-51170]  Jason Parker <jparker@digium.com>

	* main/rtp.c: Fix issue with dtmf continuation packets when the
	  dtmf digit is 0... Issue 8831

	* apps/app_voicemail.c, contrib/scripts/vmdb.sql: Fix an issue with
	  IMAP storage and realtime voicemail. Also update the vmdb sql
	  script for IMAP specific options. Issue 8819, initial patches by
	  bsmithurst (slightly modified by me)

	* doc/voicemail_odbc_postgresql.txt: change documentation to
	  reflect new procedure in 1.4/trunk

2007-01-16 21:51 +0000 [r51159-51162]  Tilghman Lesher <tilghman@mail.jeffandtilghman.com>

	* /, doc/voicemail_odbc_postgresql.txt (added): Merged revisions
	  51161 via svnmerge from
	  https://origsvn.digium.com/svn/asterisk/branches/1.2 ........
	  r51161 | tilghman | 2007-01-16 15:50:04 -0600 (Tue, 16 Jan 2007)
	  | 2 lines Add documentation walkthrough on getting Postgres to
	  work with voicemail (from Issue 8513) ........

	* apps/app_voicemail.c, /: Merged revisions 51158 via svnmerge from
	  https://origsvn.digium.com/svn/asterisk/branches/1.2 ........
	  r51158 | tilghman | 2007-01-16 15:26:06 -0600 (Tue, 16 Jan 2007)
	  | 2 lines Postgres driver doesn't like a NULL pointer when
	  retrieving the length (Bug 8513) ........

2007-01-16 17:46 +0000 [r51150]  Matt O'Gorman <mogorman@digium.com>

	* apps/app_voicemail.c: minor things i missed before i get jumped
	  on

2007-01-16 17:39 +0000 [r51148]  Joshua Colp <jcolp@digium.com>

	* /, res/res_features.c: Merged revisions 51145 via svnmerge from
	  https://origsvn.digium.com/svn/asterisk/branches/1.2 ........
	  r51145 | file | 2007-01-16 12:36:50 -0500 (Tue, 16 Jan 2007) | 2
	  lines Return previous behavior. ParkedCalls will be able to do
	  DTMF based transfers again. trunk however will get an option to
	  allow this to be set on/off. (issue #8804 reported by nortex)
	  ........

2007-01-16 17:36 +0000 [r51146]  Jason Parker <jparker@digium.com>

	* main/file.c: Display more useful output when streaming files.
	  Include the channel name to which the file is being played. Issue
	  8828, patch by junky.

2007-01-16 05:55 +0000 [r51087]  Joshua Colp <jcolp@digium.com>

	* channels/chan_zap.c, /: Merged revisions 51085 via svnmerge from
	  https://origsvn.digium.com/svn/asterisk/branches/1.2 ........
	  r51085 | file | 2007-01-16 00:53:31 -0500 (Tue, 16 Jan 2007) | 2
	  lines Add none as a valid callgroup/pickupgroup option. I
	  consider it a bug that it would inherit it all the way down and
	  not have any way to reset it to nothing - so that's why it is in
	  1.2. (issue #8296 reported by gkloepfer) ........

2007-01-16 01:15 +0000 [r51057]  Russell Bryant <russell@digium.com>

	* main/config.c: It is possible for the config pointer to be NULL
	  here, so it needs to be checked before dereferencing it.

2007-01-16 00:22 +0000 [r51030]  Matt O'Gorman <mogorman@digium.com>

	* apps/app_voicemail.c, configs/users.conf.sample: Patch allows for
	  changing voicemail password in users.conf from voicemail main,
	  written by AnthonyL bug #8436

2007-01-15 23:49 +0000 [r50994]  Russell Bryant <russell@digium.com>

	* Makefile.rules: Filter out a few CFLAGS that are not valid
	  CXXFLAGS.

2007-01-15 23:10 +0000 [r50988]  Tilghman Lesher <tilghman@mail.jeffandtilghman.com>

	* /: Blocked revisions 50987 via svnmerge ........ r50987 |
	  tilghman | 2007-01-15 17:09:02 -0600 (Mon, 15 Jan 2007) | 2 lines
	  Check return value before dereferencing (Bug 8822) ........

2007-01-15 21:08 +0000 [r50957]  Matt O'Gorman <mogorman@digium.com>

	* apps/app_voicemail.c, /: Merged revisions 50946 via svnmerge from
	  https://svn.digium.com/svn/asterisk/branches/1.2 ........ r50946
	  | mogorman | 2007-01-15 14:44:53 -0600 (Mon, 15 Jan 2007) | 4
	  lines Solves issue with forwarding voicemails from folders other
	  than inbox. patch by anthonyl. ........

2007-01-15 18:23 +0000 [r50921]  Jason Parker <jparker@digium.com>

	* main/asterisk.c: re-add deprecated "show version" CLI command.

2007-01-15 16:36 +0000 [r50895]  Joshua Colp <jcolp@digium.com>

	* main/manager.c: Move event processing into do_message so that it
	  gets executed again when events are tripped.

2007-01-15 15:03 +0000 [r50867]  Kevin P. Fleming <kpfleming@digium.com>

	* configure, include/asterisk/autoconfig.h.in, main/Makefile,
	  configure.ac, Makefile.rules, acinclude.m4, makeopts.in: use the
	  ACX_PTHREAD macro from the Autoconf macro archive for setting up
	  compiler pthreads support... should improve portability to
	  platforms with unusual pthreads requirements

2007-01-14 21:59 +0000 [r50820]  Joshua Colp <jcolp@digium.com>

	* main/astmm.c: Add missing newlines for two memory CLI commands.

2007-01-14 05:13 +0000 [r50782]  Tilghman Lesher <tilghman@mail.jeffandtilghman.com>

	* main/db1-ast/db/db.c, main/db1-ast/recno/rec_get.c,
	  main/db1-ast/btree/bt_seq.c, main/db1-ast/hash/hash_func.c,
	  main/db1-ast/btree/bt_utils.c, main/db1-ast/recno/rec_seq.c,
	  main/db1-ast/btree/bt_overflow.c, main/db1-ast/btree/bt_search.c,
	  main/db1-ast/btree/bt_conv.c, main/db1-ast/btree/bt_close.c,
	  main/db1-ast/btree/bt_put.c, main/db1-ast/recno/rec_utils.c,
	  main/db1-ast/recno/rec_open.c, main/db1-ast/hash/hash_bigkey.c,
	  main/db1-ast/recno/rec_delete.c, main/db1-ast/hash/hash_buf.c,
	  main/db1-ast/hash/hash_page.c, main/db1-ast/recno/rec_close.c,
	  main/db1-ast/recno/rec_put.c, main/db1-ast/include/ndbm.h,
	  main/db1-ast/btree/bt_debug.c, main/db1-ast/mpool/mpool.c,
	  main/db1-ast/btree/bt_split.c, main/db1-ast/btree/bt_open.c,
	  main/db1-ast/btree/bt_delete.c, main/db1-ast/hash/hash_log2.c,
	  main/db1-ast/hash/hsearch.c, /, main/db1-ast/btree/bt_page.c,
	  main/db1-ast/recno/rec_search.c, main/db1-ast/btree/bt_get.c,
	  main/db1-ast/hash/hash.c: Merged revisions 50781 via svnmerge
	  from https://origsvn.digium.com/svn/asterisk/branches/1.2
	  ........ r50781 | tilghman | 2007-01-13 23:01:16 -0600 (Sat, 13
	  Jan 2007) | 2 lines Bug 8814 - db should look for its header
	  using a relative path, instead of the system path (Fixes FreeWRT)
	  ........

2007-01-13 16:45 +0000 [r50754]  Kevin P. Fleming <kpfleming@digium.com>

	* Makefile, build_tools/make_sample_voicemail (added): when
	  building the sample greetings for maibox 1234@default during
	  'make samples', build a greeting for each language and file
	  format the user selected to install with menuselect (reported by
	  Brian Capouch on asterisk-dev)

2007-01-13 06:00 +0000 [r50674-50727]  Joshua Colp <jcolp@digium.com>

	* main/channel.c: Only write a frame out to the channel if one
	  exists. There are cases where one may not and would therefore
	  cause the channel driver to segfault. (issue #8434 reported by
	  slimey)

	* res/res_snmp.c: Only join the snmp thread on an unload if the
	  thread is actually running. (issue #8810 reported by junky)

2007-01-12 19:24 +0000 [r50647]  Jason Parker <jparker@digium.com>

	* configs/voicemail.conf.sample: Update documentation to state that
	  you shouldn't use realtime static with voicemail.conf

2007-01-12 16:42 +0000 [r50602]  Joshua Colp <jcolp@digium.com>

	* main/manager.c: We need to check for res being 0 in do_message
	  itself, otherwise our headers will get lost.

2007-01-12 14:42 +0000 [r50562]  Kevin P. Fleming <kpfleming@digium.com>

	* main/pbx.c, /: Merged revisions 50561 via svnmerge from
	  https://origsvn.digium.com/svn/asterisk/branches/1.2 ........
	  r50561 | kpfleming | 2007-01-12 08:34:15 -0600 (Fri, 12 Jan 2007)
	  | 2 lines minor documentation clarification ........

2007-01-11 05:53 +0000 [r50377-50468]  Joshua Colp <jcolp@digium.com>

	* channels/chan_sip.c: Remove check for channel state as it can
	  definitely be something other then ring, and also clean up the
	  code a bit. This should solve the parking issues and maybe some
	  attended transfer issues people have been seeing.

	* main/rtp.c, channels/chan_sip.c, include/asterisk/rtp.h: Add
	  support to see whether NAT was detected (yay symmetric RTP) and
	  also add a check in chan_sip so that if NAT has been detected and
	  the reinvite behind nat option has been turned off, then just do
	  partial bridge. (issue #8655 reported by mnicholson)

	* apps/app_speech_utils.c: Merge speech-multi branch which adds
	  support for joining multiple sound files together to be played
	  one after another in SpeechBackground.

	* main/config.c: Fix parsing when using something like ldap
	  settings. (done by anthonyl)

	* channels/chan_sip.c: Fix chan_sip not working issue. Let's not
	  prematurely return 0. (issue #8783 reported by st41ker)

2007-01-10 16:45 +0000 [r50346]  Jason Parker <jparker@digium.com>

	* cdr/cdr_manager.c: Reverse some logic in cdr_manager, which made
	  it fail to load if the config file existed. Issue 8777

2007-01-10 04:55 +0000 [r50266-50298]  Joshua Colp <jcolp@digium.com>

	* apps/app_dial.c, /: Merged revisions 50295 via svnmerge from
	  https://origsvn.digium.com/svn/asterisk/branches/1.2 ........
	  r50295 | file | 2007-01-09 23:51:06 -0500 (Tue, 09 Jan 2007) | 2
	  lines Add another return value to dial_exec_full that indicates
	  execution is going to continuing at a new
	  extension/context/priority and to just let it slide. (issue #8598
	  reported by jon) ........

	* main/pbx.c: Ensure data's existence before trying to access it.
	  (issue #8774 reported by rcourtna)

2007-01-10 02:17 +0000 [r50228]  Russell Bryant <russell@digium.com>

	* Makefile, /: Merged revisions 50227 via svnmerge from
	  https://origsvn.digium.com/svn/asterisk/branches/1.2 ........
	  r50227 | russell | 2007-01-09 21:16:45 -0500 (Tue, 09 Jan 2007) |
	  6 lines Make the number that represents the major version number
	  a single digit instead of 2. Using two digits makes it an octal
	  number when put into version.h, which breaks the compilation of
	  any out of tree module that checks the version for any version
	  after 1.2.7 (reported by Matteo Brancaleoni on the asterisk-dev
	  mailing list, who gave credit to vihai for pointing it out)
	  ........

2007-01-09 17:11 +0000 [r50186]  Jason Parker <jparker@digium.com>

	* main/cli.c: Re-add CLI command that should have only been
	  deprecated in 1.4. Thanks kshumard! (reported in person, so no
	  associated issue #)

2007-01-09 13:40 +0000 [r50151]  Tilghman Lesher <tilghman@mail.jeffandtilghman.com>

	* apps/app_voicemail.c, /: Merged revisions 50150 via svnmerge from
	  https://origsvn.digium.com/svn/asterisk/branches/1.2 ........
	  r50150 | tilghman | 2007-01-09 07:30:04 -0600 (Tue, 09 Jan 2007)
	  | 4 lines The advent of realtime has enabled people to use commas
	  in the fullname field. This could cause an issue with sending
	  voicemails, when the field is unquoted. (Issue 8595) ........

2007-01-09 11:25 +0000 [r50124]  Olle Johansson <oej@edvina.net>

	* channels/chan_sip.c: - handle re-invites properly in sip_hangup()
	  - Add some invitestate status changes just to be sure

2007-01-08 23:39 +0000 [r50098]  Jason Parker <jparker@digium.com>

	* apps/app_voicemail.c: Fix an issue with voicemail and users.conf,
	  where it wouldn't ever parse a password, since it was using
	  "secret" instead of "password" Issue 8761, reported by and patch
	  suggestion from ssokol.

2007-01-08 21:11 +0000 [r50073]  Matt O'Gorman <mogorman@digium.com>

	* apps/app_senddtmf.c: we can't unlock a channel if we cant find
	  it. - AnthonyL bug #8741

2007-01-08 18:21 +0000 [r50032]  Joshua Colp <jcolp@digium.com>

	* main/rtp.c: Disable the more intense packet2packet bridging until
	  the bugs can be worked out.

2007-01-08 14:26 +0000 [r49925-50006]  Olle Johansson <oej@edvina.net>

	* channels/chan_sip.c: Issue #8677 - Handle failure of T.38
	  re-invite This is not a fix, but adding an error message to tell
	  the admin that we have a bad configuration. We should not send
	  T.38 re-invites to devices that can't handle it (with the current
	  architecture where you have to hard-code t.38 support per
	  device). To really fix this, we need to figure out a way to tell
	  the incoming call that the re-invite failed, so we can signal
	  failure on that end and go back to the original call.

	* channels/chan_sip.c: Issue #8524, support multiple via header
	  values (tardieu) Thanks!

	* channels/chan_sip.c: We only need one forward declaration

	* channels/chan_sip.c: Issue 8735: Terminate state when extension
	  is unavailable for subscription

2007-01-08 05:11 +0000 [r49890]  Joshua Colp <jcolp@digium.com>

	* /, channels/chan_iax2.c: Merged revisions 49889 via svnmerge from
	  https://origsvn.digium.com/svn/asterisk/branches/1.2 ........
	  r49889 | file | 2007-01-08 00:10:07 -0500 (Mon, 08 Jan 2007) | 2
	  lines Ensure we use the default refresh value of 60 if the remote
	  server does not send one. (issue #8746 reported by maethor)
	  ........

2007-01-08 03:53 +0000 [r49866]  Kevin P. Fleming <kpfleming@digium.com>

	* configure, configure.ac: since we use AC_PATH_TOOL to find tools,
	  we should use the results it provides for us (reported by Brian
	  Capouch on the asterisk-dev list)

2007-01-07 21:44 +0000 [r49831-49834]  Tilghman Lesher <tilghman@mail.jeffandtilghman.com>

	* /, apps/app_dictate.c: Merged revisions 49833 via svnmerge from
	  https://origsvn.digium.com/svn/asterisk/branches/1.2 ........
	  r49833 | tilghman | 2007-01-07 15:43:10 -0600 (Sun, 07 Jan 2007)
	  | 2 lines If openstream fails, then we crash (Issue 8564)
	  ........

	* channels/chan_sip.c: Second condition was a subset of the first,
	  so hold was never decremented, thus hint stayed stuck (Issue
	  8747)

2007-01-06 00:24 +0000 [r49742]  Jason Parker <jparker@digium.com>

	* main/pbx.c, res/res_features.c, pbx/pbx_config.c: Save 1 whopping
	  byte of allocated memory! This looks like it may have been a
	  chicken/egg scenario.. You had to call a cleanup func, because
	  everything was allocated. Then since you had to call a cleanup
	  func, you were forced to allocate - ie; strdup("").

2007-01-05 23:51 +0000 [r49710-49715]  Kevin P. Fleming <kpfleming@digium.com>

	* configure, acinclude.m4: one more time...

	* configure, acinclude.m4: proper fix for r49712

	* configure, acinclude.m4: if --with-foo=<path> is specific for a
	  configure option, ensure that it is used for header file checking
	  as well

	* main/manager.c: ast_func_read() needs a writable copy of the
	  function name to be passed

2007-01-05 23:16 +0000 [r49705]  Jason Parker <jparker@digium.com>

	* channels/chan_zap.c, codecs/codec_zap.c: Make codec_zap and
	  chan_zap also depend on zaptel. This fixes an issue (8727) with
	  zaptel being in a different directory, using --with-zaptel.

2007-01-05 22:52 +0000 [r49676-49680]  Kevin P. Fleming <kpfleming@digium.com>

	* main/manager.c: don't 'consume' the params list before we try to
	  use it again

	* res/res_monitor.c, main/config.c, apps/app_setcdruserfield.c,
	  main/manager.c, include/asterisk/jabber.h, apps/app_senddtmf.c,
	  main/db.c, channels/chan_zap.c, channels/chan_sip.c,
	  apps/app_meetme.c, res/res_features.c, channels/chan_agent.c,
	  utils/astman.c, include/asterisk/manager.h, channels/chan_iax2.c,
	  apps/app_queue.c, res/res_jabber.c: reduce stack consumption for
	  AMI and AMI/HTTP requests by nearly 20K in most cases

2007-01-05 22:14 +0000 [r49675]  Joshua Colp <jcolp@digium.com>

	* main/channel.c: Don't keep repeating the warning over and over
	  when the end of the call is reached. (issue #8724 reported by
	  xrg)

2007-01-05 17:09 +0000 [r49581-49636]  Kevin P. Fleming <kpfleming@digium.com>

	* /, channels/chan_sip.c, channels/chan_skinny.c,
	  channels/chan_iax2.c: Merged revisions 49635 via svnmerge from
	  https://origsvn.digium.com/svn/asterisk/branches/1.2 ........
	  r49635 | kpfleming | 2007-01-05 10:56:40 -0600 (Fri, 05 Jan 2007)
	  | 2 lines ensure that threads which are supposed to be detached
	  (because we aren't going to wait on them) are created properly
	  ........

	* channels/chan_iax2.c: revert the dynamic_list insertion change...
	  that was not the right thing to do

	* channels/chan_iax2.c: create the IAX2 processing threads as
	  background threads so they will use smaller stacks when we create
	  a dynamic thread, put it on the dynamic_list right away so we
	  don't lose track of it

2007-01-04 23:00 +0000 [r49568]  Joshua Colp <jcolp@digium.com>

	* channels/chan_iax2.c: It's possible for the iax2 pvt to
	  disappear, so if it has... don't bother looking for dpentries.

2007-01-04 22:51 +0000 [r49553]  Kevin P. Fleming <kpfleming@digium.com>

	* include/asterisk/threadstorage.h, main/asterisk.c,
	  build_tools/cflags.xml, include/asterisk.h, main/Makefile,
	  main/threadstorage.c (added), main/utils.c: add support for
	  tracking thread-local-storage objects that exist via
	  'threadstorage' CLI commands

2007-01-04 22:28 +0000 [r49551]  Joshua Colp <jcolp@digium.com>

	* main/config.c: Only free comments and line buffer once we reach
	  the first level. (issue #8678 reported by ssokol, fixed by
	  anthonyl)

2007-01-04 21:58 +0000 [r49460-49536]  Kevin P. Fleming <kpfleming@digium.com>

	* channels/iax2-parser.c, main/frame.c: don't mark these
	  allocations as 'cache' allocations when caching has been disabled

	* channels/iax2-parser.c: if we're going to decrement the frame
	  count when we free a frame, we should inrement it when we create
	  one :-)

	* channels/iax2-parser.c, channels/iax2-parser.h,
	  channels/chan_iax2.c: only do IAX2 frame caching for voice and
	  video frames

	* main/frame.c: don't do frame header caching in the core if
	  LOW_MEMORY is defined

	* channels/iax2-parser.c: don't define this type either if
	  LOW_MEMORY is enabled

2007-01-04 18:11 +0000 [r49459]  Matt O'Gorman <mogorman@digium.com>

	* apps/app_voicemail.c, /: Merged revisions 49447 via svnmerge from
	  https://svn.digium.com/svn/asterisk/branches/1.2 ........ r49447
	  | mogorman | 2007-01-04 11:45:16 -0600 (Thu, 04 Jan 2007) | 2
	  lines converted a lot of 256 to PATH_MAX and some white space
	  fixes. ........

2007-01-04 18:06 +0000 [r49457-49458]  Kevin P. Fleming <kpfleming@digium.com>

	* channels/iax2-parser.c: don't do frame caching in LOW_MEMORY mode

	* codecs/Makefile: make building of codec_gsm against the system
	  GSM library actually work

2007-01-04 16:50 +0000 [r49413]  Matt O'Gorman <mogorman@digium.com>

	* apps/app_voicemail.c, /: Merged revisions 49412 via svnmerge from
	  https://svn.digium.com/svn/asterisk/branches/1.2 ........ r49412
	  | mogorman | 2007-01-04 10:48:43 -0600 (Thu, 04 Jan 2007) | 3
	  lines good catch russell sorry i missed that. fix magic number
	  with proper sizeof ........

2007-01-04 04:33 +0000 [r49388]  Russell Bryant <russell@digium.com>

	* funcs/func_realtime.c: Fix the REALTIME() dialplan function.
	  ast_build_string() advances the string pointer to the position to
	  begin the next write into the buffer. So, this pointer can not be
	  used to copy the contents of the string later. The beginning of
	  the buffer must be saved. Interestingly enough, this code could
	  not have ever worked. (Pointed out by Sebb on IRC, thanks!)

2007-01-03 23:32 +0000 [r49355]  Matt O'Gorman <mogorman@digium.com>

	* apps/app_voicemail.c, /: Merged revisions 49354 via svnmerge from
	  https://svn.digium.com/svn/asterisk/branches/1.2 ........ r49354
	  | mogorman | 2007-01-03 17:22:47 -0600 (Wed, 03 Jan 2007) | 6
	  lines When using ODBC_STORAGE VoicemailMain doesn't create the
	  subdirectories for a mailbox such as the INBOX directory. this
	  patch solves that problem, was written by anthony be-125 ........

2007-01-03 09:06 +0000 [r49313]  Christian Richter <christian.richter@beronet.com>

	* channels/misdn/isdn_lib.c, channels/misdn_config.c,
	  doc/misdn.txt, channels/misdn/isdn_lib.h, channels/chan_misdn.c,
	  /, channels/misdn/ie.c, channels/misdn/isdn_msg_parser.c,
	  configs/misdn.conf.sample: Merged revisions
	  48319,48321,48467,48552,48576,49135,49303 via svnmerge from
	  https://origsvn.digium.com/svn/asterisk/branches/1.2 ........
	  r48319 | crichter | 2006-12-06 15:35:25 +0100 (Mi, 06 Dez 2006) |
	  1 line changed a few debugs to higher debug levels ........
	  r48321 | crichter | 2006-12-06 16:48:45 +0100 (Mi, 06 Dez 2006) |
	  1 line added the export and import of the MISDN_ADDRESS_COMPLETE
	  Variable to inidcate wether the extension is already completely
	  dialed or if there might come additional digits by information
	  elements. also added some docs for that. ........ r48467 |
	  crichter | 2006-12-14 14:03:49 +0100 (Do, 14 Dez 2006) | 1 line
	  removed FIXUP state. added check for channel allocation conflict
	  when we create a setup while the other site creates a setup on
	  the same channel, besides the check we resolve this conflict.
	  ........ r48552 | crichter | 2006-12-18 11:19:39 +0100 (Mo, 18
	  Dez 2006) | 1 line when our PTP Partner sends us a SETUP with a
	  preselected channel we just accept it, even when we're NT. added
	  some checks for segfaults. ........ r48576 | crichter |
	  2006-12-19 14:08:51 +0100 (Di, 19 Dez 2006) | 1 line when we
	  reject a channel, because it's in use already, we shouldn't
	  process the setup anymore. made the channel allocation a bit
	  easier and more understandable, removed a few unused lines
	  ........ r49135 | crichter | 2007-01-02 11:07:22 +0100 (Di, 02
	  Jan 2007) | 1 line added check for channel ranges in the
	  set/empty channel functions. set pmp_l1_check default to no.
	  added misdn restart pid cli command. added cleaning of channel
	  when we send a RELEASE_COMPLETE. ........ r49303 | crichter |
	  2007-01-03 09:24:00 +0100 (Mi, 03 Jan 2007) | 9 lines * Added
	  check for bridging in misdn_call to avoid setting
	  echocancellation when 2 mISDN channels are involved and when
	  bridging is set. That lead to a kernel panic before under
	  different situations, because we switched about 2 times between
	  hardware bridging and echocancelation * readded MISDN_URATE
	  variable which got lost before, this should make app_v110 work
	  again * fixed typo ........

2007-01-03 03:21 +0000 [r49282]  Kevin P. Fleming <kpfleming@digium.com>

	* Makefile, Makefile.rules: various Makefile improvements to get
	  chan_vpb (and any other C++ modules) to build properly

2007-01-03 01:19 +0000 [r49259]  Joshua Colp <jcolp@digium.com>

	* channels/chan_iax2.c: Check pvt structure presence before passing
	  to send_command. This gets rid of the irritating message about a
	  packet without pvt structure. This happens because the scheduled
	  item is getting cancelled at almost the exact moment it is
	  getting executed.

2007-01-02 22:30 +0000 [r49237]  Steve Murphy <murf@digium.com>

	* main/ast_expr2.fl, main/ast_expr2f.c, pbx/ael/ael_lex.c,
	  pbx/ael/ael.flex: This is a slight modification to Josh's edits
	  for #8579; both files edited were the produced by flex; so the
	  source files need to be changed instead, and the generated files
	  regenerated.

2007-01-02 19:58 +0000 [r49212]  Olle Johansson <oej@edvina.net>

	* channels/chan_sip.c: Small cleanup of add_t38sdp - it's always
	  enabled at that point in the code

2007-01-02 17:33 +0000 [r49189]  Jason Parker <jparker@digium.com>

	* main/pbx.c: Allow fractions of a second in the Wait()
	  application, like it says it allows.

2007-01-02 13:59 +0000 [r49165]  Kevin P. Fleming <kpfleming@digium.com>

	* channels/chan_zap.c: remove comment that is unrelated to this
	  function

2007-01-02 12:08 +0000 [r49145]  Olle Johansson <oej@edvina.net>

	* configs/features.conf.sample: Adding note on effect of
	  applicationmap features on re-invites

2007-01-01 23:34 +0000 [r49098-49102]  Kevin P. Fleming <kpfleming@digium.com>

	* channels/chan_zap.c, build_tools/menuselect-deps.in, configure,
	  configure.ac, codecs/codec_zap.c: check specifically for VLDTMF
	  and transcoding support in the system's Zaptel installation, and
	  make only the modules that need those features dependent on them
	  (this will allow building the other Zaptel-using parts of
	  Asterisk against older versions of Zaptel or those on other
	  platforms that haven't caught up yet to the Linux version)

	* Makefile: use a simpler (and portable) method to ensure that
	  menuselect is built as a host binary

	* Makefile: revert this change until a better solution can be
	  found... 'env -i' was not being used properly, but even when
	  changed to do so, this process fails during cross-compilation
	  because the menuselect build still sees 'CC' as set to the
	  cross-compiler

2007-01-01 20:14 +0000 [r49096]  Olle Johansson <oej@edvina.net>

	* channels/chan_sip.c: remove incomplete implementation of dnsmgr.
	  Let's fix this in trunk.

2006-12-30 18:31 +0000 [r49063-49073]  Joshua Colp <jcolp@digium.com>

	* pbx/pbx_config.c: IAX has been deprecated for quite some time so
	  we had better use IAX2 when creating the dial string for users.
	  (issue #8697 reported by ssokol)

	* channels/chan_zap.c: Use asprintf to build the channel names
	  instead of custom function. I believe the custom function is
	  doing some things that are not portable across all
	  implementations. (issue #8570 reported by hterag & issue #8692
	  reported by nicolasg)

	* main/rtp.c: If the Packet2Packet bridge is being broken because
	  of a masquerade then attempt to read a frame in so the masquerade
	  actually happens. Otherwise weirdness will occur. (issue #8696
	  reported by kjotte)

	* channels/chan_iax2.c: Initialize the packet queue in load_module
	  instead of just declaring the list with the default value. (issue
	  #8695 reported by ssokol)

2006-12-30 00:40 +0000 [r49061]  Steve Murphy <murf@digium.com>

	* pbx/pbx_ael.c: A fix for 8661, where the CUT func needed to have
	  comma args converted to vertical bars. I hope this change does
	  little harm.

2006-12-29 00:50 +0000 [r49042-49048]  Kevin P. Fleming <kpfleming@digium.com>

	* /: put this value into the correct property

	* /, BUGS: Merged revisions 49045 via svnmerge from
	  https://origsvn.digium.com/svn/asterisk/branches/1.2 ........
	  r49045 | kpfleming | 2006-12-28 18:32:32 -0600 (Thu, 28 Dec 2006)
	  | 2 lines location of the bug posting guidelines has changed
	  ........

	* sample.call: simple commit to test CIA integration

2006-12-28 21:26 +0000 [r49032-49035]  Jason Parker <jparker@digium.com>

	* main/cli.c: Fix some deprecated commands. Issue 8682, patch by me

	* main/http.c: saw this in passing... fix a small typo

2006-12-28 20:08 +0000 [r49028]  Kevin P. Fleming <kpfleming@digium.com>

	* sounds/Makefile: new versions of sounds

2006-12-28 19:52 +0000 [r49024]  Jason Parker <jparker@digium.com>

	* main/http.c: make the uris_lock a rwlock instead of a mutex lock
	  - needs to be forward ported to trunk

2006-12-28 19:43 +0000 [r49022]  Joshua Colp <jcolp@digium.com>

	* configure, include/asterisk/autoconfig.h.in, configure.ac,
	  include/asterisk/lock.h: Backport support for read/write locks.

2006-12-28 19:21 +0000 [r49020]  Steve Murphy <murf@digium.com>

	* main/ast_expr2.fl, main/ast_expr2.c, main/frame.c,
	  pbx/ael/ael.tab.c, main/ast_expr2.y, main/ast_expr2f.c,
	  pbx/ael/ael_lex.c, include/asterisk/ael_structs.h,
	  pbx/ael/ael.tab.h, utils/ael_main.c: removed <err.h> as in trunk
	  from the ael stuff. Also, threw in a minor fix to frame.c to
	  avoid build-killing compiler warnings.

2006-12-27 22:28 +0000 [r49009]  Joshua Colp <jcolp@digium.com>

	* main/ast_expr2f.c, pbx/ael/ael_lex.c: ast_copy_string is not
	  available when LOW_MEMORY is used and things are being built in
	  the utils directory, so we need to resort to the old method of
	  strncpy. (issue #8579 reported by mottano)

2006-12-27 22:06 +0000 [r48998-49006]  Kevin P. Fleming <kpfleming@digium.com>

	* main/enum.c, main/asterisk.c, main/rtp.c, main/term.c,
	  main/cdr.c, main/channel.c, main/udptl.c, main/pbx.c,
	  main/dnsmgr.c, main/frame.c, main/manager.c, main/file.c,
	  main/http.c, main/logger.c: since these variables all have static
	  duration, none of them need initializers (they default to zero
	  anyway)

	* include/asterisk/options.h, main/asterisk.c, main/file.c: move
	  extern declaration for this option to a header file where it
	  belongs provide an initial value for 'languageprefix' option,
	  instead of relying on randomness to provide a useful value

2006-12-27 21:06 +0000 [r48993-48997]  Olle Johansson <oej@edvina.net>

	* channels/chan_sip.c: Only include acl.h and lock.h once

	* channels/chan_sip.c: Only set rfc2833compensate flag once
	  (handle_common_options)

	* channels/chan_sip.c: - Remove checking for T38 options twice.
	  Keeping them in handle_common_options

2006-12-27 18:33 +0000 [r48987-48988]  Kevin P. Fleming <kpfleming@digium.com>

	* channels/chan_sip.c: make the option actually match the
	  documentation

	* channels/iax2-parser.c, include/asterisk/utils.h,
	  include/asterisk/astmm.h, main/frame.c, main/astmm.c: allow 'show
	  memory' and 'show memory summary' to distinguish memory
	  allocations that were done for caching purposes, so they don't
	  look like memory leaks

2006-12-27 17:59 +0000 [r48975-48985]  Olle Johansson <oej@edvina.net>

	* channels/chan_sip.c, configs/sip.conf.sample: Be a bit more
	  politically correct

	* channels/chan_sip.c, configs/sip.conf.sample: Issue #8575 - Buggy
	  cisco MWI support. Normally we try not to change our software for
	  bugs in other devices. But in this case, the Cisco phones are so
	  widespread so we try to implement a fix while waiting for a
	  bugfix from Cisco.

	* channels/chan_sip.c: - Make sure handle_common_options return 1
	  when we found a common option - Move uncommon (only global)
	  option away from handle_common_options Reported by rizzo. Thanks!

	* channels/chan_sip.c: Issue 8599 (rizzo) Change invitestate before
	  re-sending invite with auth.

	* /, channels/chan_sip.c: Fix bogus content-length in t38 sdp.
	  (rizzo, #8600)

2006-12-26 05:20 +0000 [r48960-48966]  Joshua Colp <jcolp@digium.com>

	* apps/app_meetme.c: Get rid of a needless memory allocation and
	  only create a conference structure in find_conf_realtime if data
	  was read from realtime. (issue #8669 reported by robl)

	* main/rtp.c, channels/chan_sip.c, include/asterisk/rtp.h: Add an
	  API call that initializes an RTP structure. We need this because
	  chan_sip is cheeky and uses a temporary RTP structure for codec
	  purposes, and the API calls that are used rely on the lock.
	  (Pointed out on asterisk-dev by Andy Wang)

	* configure, configure.ac: Clean up autoconf file (gets rid of
	  warnings seen when rebuilding configure) and rebuild configure.

2006-12-25 05:21 +0000 [r48931-48956]  Russell Bryant <russell@digium.com>

	* /, funcs/func_math.c: Merged revisions 48955 via svnmerge from
	  https://origsvn.digium.com/svn/asterisk/branches/1.2 ........
	  r48955 | russell | 2006-12-25 00:19:48 -0500 (Mon, 25 Dec 2006) |
	  6 lines Fix an error introduced by copying and pasting the
	  handling of the >= operator for the MATH function. If a single
	  equal sign was used as an operator, the function would treat it
	  is as if it were the >= operator. Now, it properly handles it as
	  an invalid operator. (issue #8665, patch by tempest1) ........

	* channels/chan_oss.c: Fix a typo in an error message that
	  indicated that the MGCP channel type could not be registered,
	  instead of the correct type, OSS.

	* /, channels/chan_iax2.c: Merged revisions 48943 via svnmerge from
	  https://origsvn.digium.com/svn/asterisk/branches/1.2 ........
	  r48943 | russell | 2006-12-24 02:23:07 -0500 (Sun, 24 Dec 2006) |
	  3 lines Check for the proper return value on an error in a call
	  to mmap(). This was reported by Andy Wang on the asterisk-dev
	  list. Thanks! ........

	* /, channels/chan_sip.c: Merged revisions 48939 via svnmerge from
	  https://origsvn.digium.com/svn/asterisk/branches/1.2 ........
	  r48939 | russell | 2006-12-24 01:47:29 -0500 (Sun, 24 Dec 2006) |
	  3 lines Remove a couple of misplaced dots in log messages. This
	  was reported by Andrea Spadaccini on the asterisk-dev mailing
	  list. ........

	* main/http.c: Implement locking for the list of URI handlers to
	  make it thread-safe.

2006-12-23  Kevin P. Fleming  <kpfleming@digium.com>

	* Asterisk 1.4.0 released.

2006-12-22 22:33 +0000 [r48870-48906]  Jason Parker <jparker@digium.com>

	* Makefile, main/stdtime/localtime.c: Minor fixes for Solaris.

	* channels/chan_skinny.c: Fix for issue 7774 - patch by alamantia

2006-12-21 20:26 +0000 [r48783]  Joshua Colp <jcolp@digium.com>

	* /, redhat/asterisk.spec: Merged revisions 48782 via svnmerge from
	  https://origsvn.digium.com/svn/asterisk/branches/1.2 ........
	  r48782 | file | 2006-12-21 15:25:01 -0500 (Thu, 21 Dec 2006) | 2
	  lines Add new silence sound files to the spec for Redhat. (issue
	  #8652 reported by alvaro_palma_aste) ........

2006-12-20 02:56 +0000 [r48592-48637]  Joshua Colp <jcolp@digium.com>

	* apps/app_voicemail.c: vms doesn't exist on non-IMAP storage
	  builds.

	* apps/app_voicemail.c: Pass 'vms' pointer to record_and_review so
	  it is then passed to the IMAP store file function. (issue #8614
	  reported by punknow)

	* doc/snmp.txt: find is not the same as bind when it comes to
	  documentation. (issue #8626 reported by johann8384)

2006-12-19 21:28 +0000 [r48586]  Kevin P. Fleming <kpfleming@digium.com>

	* channels/Makefile: suppress compiler warnings in this module
	  until it can be improved

2006-12-19 21:12 +0000 [r48585]  Joshua Colp <jcolp@digium.com>

	* apps/app_dial.c, /: Merged revisions 48584 via svnmerge from
	  https://origsvn.digium.com/svn/asterisk/branches/1.2 ........
	  r48584 | file | 2006-12-19 16:10:26 -0500 (Tue, 19 Dec 2006) | 2
	  lines Free localuser structure when we fail to dial (issue #8612
	  reported by rizzo) ........

2006-12-19 21:03 +0000 [r48583]  Luigi Rizzo <rizzo@icir.org>

	* apps/app_sms.c: fix a bogus datalen in the frames generated by
	  app_sms (causing noisy output if you listen to the output!) This
	  affects trunk as well, whereas 1.2 is ok.

2006-12-19 14:57 +0000 [r48577]  Kevin P. Fleming <kpfleming@digium.com>

	* res/res_config_odbc.c, funcs/func_odbc.c: use the proper variable
	  type for these unixODBC API calls, eliminating warnings on 64-bit
	  platforms that use the 'new' 64-bit types for ODBC API calls

2006-12-19 03:46 +0000 [r48571]  Joshua Colp <jcolp@digium.com>

	* Makefile: Use env -i to start a fresh environment when going to
	  build menuselect. This is more portable then using unset. (issue
	  #8543 reported by jtodd)

2006-12-18 17:23 +0000 [r48566]  Luigi Rizzo <rizzo@icir.org>

	* include/asterisk/channel.h: unbreak the macro used for
	  incrementing the frame counters. I don't know when the bug was
	  introduced, but with the typical usage c->fin =
	  FRAMECOUNT_INC(c->fin) the frame counters stay to 0. affects
	  trunk as well (fix coming).

2006-12-18 17:15 +0000 [r48564]  Joshua Colp <jcolp@digium.com>

	* channels/chan_iax2.c: Put thread into proper list if we abort
	  handling due to an error, and also hold the lock while putting it
	  back into the proper idle list so we don't prematurely get a
	  signal. (issue #8604 reported by arkadia)

2006-12-18 11:59 +0000 [r48513-48554]  Kevin P. Fleming <kpfleming@digium.com>

	* codecs/lpc10/Makefile, main/Makefile, codecs/gsm/Makefile,
	  utils/astman.c, utils/smsq.c, codecs/ilbc/Makefile,
	  utils/ael_main.c: remove some now-unnecessary explicit includes
	  of autoconfig.h clean up per-file dependencies during 'make
	  clean'

	* build_tools/prep_tarball: need an additional argument here to
	  make the downloads actually occur

	* configure, include/asterisk/autoconfig.h.in, configure.ac,
	  acinclude.m4: use m4 quoting for AC_MSG_NOTICE calls, to keep
	  these calls from thinking they have multiple arguments

	* codecs/ilbc, formats, utils/Makefile, agi/Makefile, Makefile,
	  funcs, build_tools/mkdep (removed), codecs/lpc10, main/db1-ast,
	  main, codecs/gsm, pbx, res, channels, codecs, utils, agi,
	  main/Makefile, apps, Makefile.moddir_rules, Makefile.rules, cdr:
	  simplify dependency tracking system, using the compiler's
	  built-in method for generating them, and only doing dependency
	  tracking if developer mode is enabled via the configure script

	* Makefile, include/asterisk.h, main/stdtime/localtime.c: since we
	  really, really have to have autoconfig.h included before all
	  other headers (especially system headers), the Makefile will now
	  force it to happen (this will fix build problems with files like
	  ast_expr2f.c, where we can't control the inclusion order in the
	  file itself)

	* funcs/func_curl.c: instead of initializing the curl library every
	  time the CURL() function is invoked, do it only once per thread
	  (this allows multiple calls to CURL() in the dialplan for a
	  channel to run much more quickly, and also to re-use connections
	  to the server) (thanks to JerJer for frequently complaining about
	  this performance problem)

2006-12-15 19:55 +0000 [r48502-48506]  Joshua Colp <jcolp@digium.com>

	* main/rtp.c: Turn payload_lock into bridge_lock and make it
	  encompass all RTP structure contents that may relate to bridge
	  information, including who we are bridged to.

	* channels/chan_iax2.c: Hold call structure lock in places where a
	  qualify or peer action can destroy it.

	* channels/chan_iax2.c: Lock network retransmission queue in all
	  places that it is used.

2006-12-15 10:55 +0000 [r48481-48487]  Olle Johansson <oej@edvina.net>

	* /, channels/chan_sip.c: Issue #8592 - treat 504 as 503 (imported
	  from 1.2)

	* channels/chan_sip.c: Update to latest IANA spec

2006-12-15 06:28 +0000 [r48461-48478]  Joshua Colp <jcolp@digium.com>

	* channels/chan_iax2.c: Use a wakeup variable so that we don't wait
	  on IO indefinitely if packets need to be retransmitted.

	* main/rtp.c, include/asterisk/rtp.h: Payload values on the RTP
	  structure can change AFTER a bridge has started. This comes from
	  the packet handling of the SIP response when indication that it
	  was answered has been sent. Therefore we need to protect this
	  data with a lock when we read/write. (issue #8232 reported by
	  tgrman)

	* main/rtp.c: Remove direct RTCP bridging. I've come to the
	  conclusion that we should handle this through the core and not
	  just forward it on. Should solve a few bugs.

2006-12-12  Kevin P. Fleming  <kpfleming@digium.com>

	* Asterisk 1.4.0-beta4 released.

2006-12-12 04:13 +0000 [r48401]  Joshua Colp <jcolp@digium.com>

	* apps/app_voicemail.c: Use S_OR in my previous app_voicemail. This
	  is the way it should have been done.

2006-12-11 23:02 +0000 [r48396-48399]  Matt O'Gorman <mogorman@digium.com>

	* sounds/Makefile: new sounds package with 100% more silence

	* /, apps/app_externalivr.c: Merged revisions 48394 via svnmerge
	  from https://svn.digium.com/svn/asterisk/branches/1.2 ........
	  r48394 | mogorman | 2006-12-11 15:55:43 -0600 (Mon, 11 Dec 2006)
	  | 4 lines app_externalivr needs a real silence file, and
	  additional changes to add silence files into core instead of
	  extra patch provided by bug 8177 with minor additions. ........

2006-12-11 21:31 +0000 [r48391]  Joshua Colp <jcolp@digium.com>

	* apps/app_voicemail.c: Return non-existant callerid handling to
	  that which it was before. In 1.4 and trunk callerid can be
	  allocated but not have any contents so we have to use
	  ast_strlen_zero before passing it to the relevant functions.
	  (issue #8567 reported by pabelanger)

2006-12-11 05:37 +0000 [r48382]  Tilghman Lesher <tilghman@mail.jeffandtilghman.com>

	* funcs/func_strings.c: STRFTIME() does not actually require an
	  argument (issue 8540)

2006-12-11 05:36 +0000 [r48377-48381]  Joshua Colp <jcolp@digium.com>

	* main/rtp.c: Merge in my latest RTP changes. Break out RTP and
	  RTCP callback functions so they no longer share a common one.

	* apps/app_meetme.c: Use the correct API call to say a device state
	  changed. (Yes, I'm a nub.)

	* apps/app_meetme.c: Don't access the conference structure after it
	  has been freed.

2006-12-11 00:47 +0000 [r48375]  Tilghman Lesher <tilghman@mail.jeffandtilghman.com>

	* apps/app_nbscat.c, /, apps/app_festival.c, apps/app_mp3.c,
	  res/res_agi.c, apps/app_zapras.c, apps/app_externalivr.c,
	  apps/app_ices.c, res/res_musiconhold.c: Merged revisions 48374
	  via svnmerge from
	  https://origsvn.digium.com/svn/asterisk/branches/1.2 ........
	  r48374 | tilghman | 2006-12-10 18:33:59 -0600 (Sun, 10 Dec 2006)
	  | 5 lines When doing a fork() and exec(), two problems existed
	  (Issue 8086): 1) Ignored signals stayed ignored after the exec().
	  2) Signals could possibly fire between the fork() and exec(),
	  causing Asterisk signal handlers within the child to execute,
	  which caused nasty race conditions. ........

2006-12-10 03:04 +0000 [r48372]  Steve Murphy <murf@digium.com>

	* channels/chan_zap.c, /: Merged revisions 48371 via svnmerge from
	  https://origsvn.digium.com/svn/asterisk/branches/1.2 ........
	  r48371 | murf | 2006-12-09 19:14:13 -0700 (Sat, 09 Dec 2006) | 1
	  line This version applies the patch suggested by stevens in bug
	  7836 (make inbound channel RINGING state consistent with other
	  channels). ........

2006-12-09 15:59 +0000 [r48362-48363]  Russell Bryant <russell@digium.com>

	* channels/chan_iax2.c: Use locking when accessing the
	  registrations list. This list is not actually used very often, so
	  the likelihood of there being a problem is pretty small, but
	  still possible. For example, if the CLI command to list the
	  registrations was called at the same time that a reload was
	  occurring and the registrations list was getting destroyed and
	  rebuilt, a crash could occur. In passing, go ahead and convert
	  this list to use the linked list macros.

	* /: Blocked revisions 48361 via svnmerge ........ r48361 | russell
	  | 2006-12-09 10:45:37 -0500 (Sat, 09 Dec 2006) | 6 lines Use
	  locking when accessing the registrations list. This list is not
	  actually used very often, so the likelihood of there being a
	  problem is pretty small, but still possible. For example, if the
	  CLI command to list the registrations was called at the same time
	  that a reload was occurring and the registrations list was
	  getting destroyed and rebuilt, a crash could occur. ........

2006-12-07 18:17 +0000 [r48357]  Russell Bryant <russell@digium.com>

	* /, res/res_musiconhold.c: Merged revisions 48356 via svnmerge
	  from https://origsvn.digium.com/svn/asterisk/branches/1.2
	  ........ r48356 | russell | 2006-12-07 13:14:13 -0500 (Thu, 07
	  Dec 2006) | 3 lines Ensure that the file position is not
	  incremented beyond the total number of files available for
	  playback. (issue #8539, ulogic) ........

2006-12-07 15:33 +0000 [r48349]  Steve Murphy <murf@digium.com>

	* main/manager.c, UPGRADE.txt, CHANGES: Here lies the fixes that
	  killed bug 8423 -- OriginateSuccess and OriginateError incomplete
	  channel name. May it rest in peace.

2006-12-06 16:25 +0000 [r48326]  Olle Johansson <oej@edvina.net>

	* /, channels/chan_sip.c: Issue #8258 - fix handling of 487 being
	  retransmitted to Asterisk

2006-12-06 16:15 +0000 [r48323]  Russell Bryant <russell@digium.com>

	* configs/iax.conf.sample, /: Merged revisions 48322 via svnmerge
	  from https://origsvn.digium.com/svn/asterisk/branches/1.2
	  ........ r48322 | russell | 2006-12-06 11:05:54 -0500 (Wed, 06
	  Dec 2006) | 3 lines Fix the name of the rtignoreregexpire option
	  in the sample configuration file. (issue #8526, arkadia) ........

2006-12-06 12:27 +0000 [r48316-48317]  Olle Johansson <oej@edvina.net>

	* /, channels/chan_sip.c: Don't send Contact on MESSAGE

2006-12-05 20:42 +0000 [r48279]  Jason Parker <jparker@digium.com>

	* configure.ac: Fix curl version number testing to be much more
	  friendly to non-bash shells. Issue 8508, patch by me. This
	  *SHOULD* be POSIX compliant now..

2006-12-05 17:29 +0000 [r48264-48270]  Olle Johansson <oej@edvina.net>

	* channels/chan_sip.c: Merging the invitestate-1.4 branch after
	  successful testing. Will check if I can solve this with less
	  changes in 1.2.

	* configs/sip.conf.sample: Add missing s from another repository.
	  (thanks jcmoore!)

	* configs/sip.conf.sample: Updating sip.conf.sample with
	  information about T38 not working when chan_local or chan_agent
	  is involved in the call. I don't know how big a fix that would be
	  to solve, but this is the current state of affairs. (Chan_sip
	  currently checks if the other side of the bridge has a SIP tech.
	  We could/should implement another check, possibly for udptl_write
	  or some flag in the ast_channel structure).

2006-12-05 01:41 +0000 [r48252-48254]  Tilghman Lesher <tilghman@mail.jeffandtilghman.com>

	* apps/app_voicemail.c: Oops, forgot to release the odbc handle

	* apps/app_voicemail.c, /: Merged revisions 48251 via svnmerge from
	  https://origsvn.digium.com/svn/asterisk/branches/1.2 ........
	  r48251 | tilghman | 2006-12-04 19:26:08 -0600 (Mon, 04 Dec 2006)
	  | 6 lines If the recording in the database is too large, it will
	  fail to retrieve with an mmap error. Not too sure why this
	  doesn't happen when we put it in the database, also, but since
	  that doesn't seem to be broken, I'm not going to fix it (at least
	  until someone reports it). Solution is to ask for the file in
	  smaller chunks. (Bug 8385) ........

2006-12-04 21:48 +0000 [r48237-48248]  Jason Parker <jparker@digium.com>

	* apps/app_voicemail.c: Fix an issue which didn't allow
	  unavail/greet/busy/etc messages from being saved into ODBC (and
	  probably IMAP).

	* /: Blocked revisions 48246 via svnmerge ........ r48246 | qwell |
	  2006-12-04 15:20:34 -0600 (Mon, 04 Dec 2006) | 7 lines Revert
	  change from 8016 - this breaks other stuff... Needs further
	  review. Tip: When you've reported a bug about something and
	  somebody has put up a patch for it.. It's not a good idea to open
	  a completely new bug and say that something is broken because of
	  the patch in the other bug - PLEASE mention something in the bug
	  where the patch was actually created. ........

	* /: Blocked revisions 48236 via svnmerge ........ r48236 | qwell |
	  2006-12-04 13:06:26 -0600 (Mon, 04 Dec 2006) | 4 lines Fix an
	  issue where a message isn't saved correctly when using ODBC
	  storage and reviewing a message. Issue 8016 - patch by sokhapkin.
	  ........

2006-12-04 18:16 +0000 [r48234]  Joshua Colp <jcolp@digium.com>

	* /: Blocked revisions 48233 via svnmerge ........ r48233 | file |
	  2006-12-04 13:14:46 -0500 (Mon, 04 Dec 2006) | 2 lines If the
	  generic bridge tells us not to retry, and we have a frame to spit
	  out then break the bridge. Props to markit in #asterisk-bugs for
	  bringing this up. ........

2006-12-04 17:54 +0000 [r48228-48230]  Jason Parker <jparker@digium.com>

	* configs/voicemail.conf.sample: Add documentation to
	  voicemail.conf.sample for ODBC storage. Issue 8499 - patch by
	  blitzrage.

	* doc/snmp.txt: Attempt to document some of the dependencies that
	  are needed for net-snmp Issue 8499 - initial patch by blitzrage.

2006-12-03 06:34 +0000 [r48223]  Russell Bryant <russell@digium.com>

	* sounds/Makefile: When "fetch" is in use, instead of "wget",
	  --continue is not a valid option. (issue #8451)

2006-12-02 21:45 +0000 [r48199-48219]  Olle Johansson <oej@edvina.net>

	* channels/chan_sip.c: - Removing one of two pieces of code to
	  handle 481 response on INVITE - Move handling of REFER response
	  to handle_response_refer()

	* main/rtp.c, channels/chan_sip.c, include/asterisk/rtp.h,
	  configs/sip.conf.sample: - Disable RTP hold timers while T.38 fax
	  transmission happens - Encapsulate RTP timers in the rtp
	  structure so we have one for video and one for audio The video
	  one is not used in 1.4, really. Will be used for RTP keepalives
	  when we can send something that video phones support in the RTP
	  stream. I now this is a big architectual change at this stage for
	  1.4, but decided it was needed to avoid future bug reports. -
	  Document the RTP NAT keepalive option in sip.conf.sample Issue
	  7679 in the bug tracker. Please test.

2006-12-02 03:50 +0000 [r48195]  Russell Bryant <russell@digium.com>

	* include/asterisk/utils.h: Backport the comment containing the
	  warning regarding the limitations on the usage of this function.
	  It is thread safe, but not technically reentrant.

2006-12-01 23:37 +0000 [r48193]  Kevin P. Fleming <kpfleming@digium.com>

	* apps/app_dial.c, /: Merged revisions 48192 via svnmerge from
	  https://origsvn.digium.com/svn/asterisk/branches/1.2 ........
	  r48192 | kpfleming | 2006-12-01 17:30:59 -0600 (Fri, 01 Dec 2006)
	  | 2 lines if Dial() is going to send music-on-hold to the calling
	  party, it has to send PROGRESS first to ensure that the reverse
	  audio path has been setup first (BE-106) ........

2006-12-01 23:16 +0000 [r48190]  Russell Bryant <russell@digium.com>

	* Makefile, configure, configure.ac, makeopts.in, sounds/Makefile:
	  FreeBSD 6.1 does not include wget by default. However, it has
	  fetch which will work just fine for our purposes of downloading
	  the sounds packages. So, check for both wget and fetch and the
	  configure script and use what was found to download them. If
	  neither one was found, and sound packages are selected that must
	  be downloaded, the install process will print out an informative
	  error message indicating the situation. Also, fix a couple places
	  where "make" was hard coded into some output messages by
	  replacing them with the $(MAKE) variable. (issue #8451, initial
	  patch by pabelanger, with additional modifications by me)

2006-12-01 20:25 +0000 [r48184-48186]  Jason Parker <jparker@digium.com>

	* configs/extensions.conf.sample, /: Merged revisions 48183 via
	  svnmerge from
	  https://origsvn.digium.com/svn/asterisk/branches/1.2 ........
	  r48183 | qwell | 2006-12-01 14:19:10 -0600 (Fri, 01 Dec 2006) | 2
	  lines Fix a small typo - issue 8848, reported by pabelanger
	  ........

2006-12-01 19:38 +0000 [r48179]  Tilghman Lesher <tilghman@mail.jeffandtilghman.com>

	* main/cli.c: Double-unlock error (reported by blitzrage on IRC)

2006-12-01 17:41 +0000 [r48177]  Olle Johansson <oej@edvina.net>

	* channels/chan_sip.c, configs/sip.conf.sample: - Backport of the
	  "limitonpeers" patch from trunk, to fix a lot of issues with
	  queues and SIP device states - Remove support for T.38 early
	  media, since it's impossible. (Two patches in one - extra friday
	  evening offer due to being off line from svn today... :-)

2006-11-30 21:18 +0000 [r48168]  Joshua Colp <jcolp@digium.com>

	* main/rtp.c, include/asterisk/rtp.h, channels/chan_gtalk.c: Do not
	  do a partial bridge for Google Talk since we need to handle STUN.
	  (issue #8448 reported by phsultan)

2006-11-30 20:51 +0000 [r48166]  Olle Johansson <oej@edvina.net>

	* /, channels/chan_sip.c: Issue 8319 - change noncecount before
	  using it.

2006-11-30 20:28 +0000 [r48143-48162]  Joshua Colp <jcolp@digium.com>

	* /: Blocked revisions 48161 via svnmerge ........ r48161 | file |
	  2006-11-30 15:27:29 -0500 (Thu, 30 Nov 2006) | 2 lines Don't
	  write AST_FRAME_NULL or AST_FRAME_IAX frames out to the channel
	  driver. (issue #8390 reported by hselasky) ........

	* /, channels/chan_iax2.c: Merged revisions 48157 via svnmerge from
	  https://origsvn.digium.com/svn/asterisk/branches/1.2 ........
	  r48157 | file | 2006-11-30 15:06:43 -0500 (Thu, 30 Nov 2006) | 2
	  lines Only print out debug message if bridged channel is not
	  NULL. (issue #8412 reported by jubilex) ........

	* /, res/res_features.c: Merged revisions 48154 via svnmerge from
	  https://origsvn.digium.com/svn/asterisk/branches/1.2 ........
	  r48154 | file | 2006-11-30 14:04:11 -0500 (Thu, 30 Nov 2006) | 2
	  lines Do not listen for DTMF on the bridge that comes into
	  existence when ParkedCall is executed. This means native bridging
	  can now occur for this. (issue #8406 reported by kebl0155)
	  ........

	* main/cdr.c, /: Merged revisions 48151 via svnmerge from
	  https://origsvn.digium.com/svn/asterisk/branches/1.2 ........
	  r48151 | file | 2006-11-30 13:42:45 -0500 (Thu, 30 Nov 2006) | 2
	  lines Print certain CDR messages out at the NOTICE level versus
	  WARNING since they can occur when used with the CDR applications
	  and are perfectly fine. (issue #8367 reported by dartvader)
	  ........

	* /: Blocked revisions 48146 via svnmerge ........ r48146 | file |
	  2006-11-30 13:17:54 -0500 (Thu, 30 Nov 2006) | 2 lines Remember
	  the pointer to the allocated block of memory so that we can free
	  it and not cause a memory leak. (issue #8449 reported by arkadia)
	  ........

	* /, configs/sip.conf.sample: Merged revisions 48142 via svnmerge
	  from https://origsvn.digium.com/svn/asterisk/branches/1.2
	  ........ r48142 | file | 2006-11-30 12:55:23 -0500 (Thu, 30 Nov
	  2006) | 2 lines Document 'port' for SIP peers, came up because of
	  the current mailing list thread. (issue #8450 reported by
	  blitzrage) ........

2006-11-30 14:29 +0000 [r48129-48135]  Olle Johansson <oej@edvina.net>

	* doc/manager.txt: Explain status reports and make codefreeze more
	  happy :-)

	* /, channels/chan_sip.c: Clean up bad dialogs properly. Caused by
	  GS 487 adapter without CSEQ on separate line in the REGISTER
	  request. Imported from 1.2.

2006-11-29 21:05 +0000 [r48115]  Joshua Colp <jcolp@digium.com>

	* apps/app_voicemail.c: Use MAILTMPLEN instead of sizeof in
	  mm_login. (issue #8420 reported by slimey)

2006-11-29 19:56 +0000 [r48113]  Olle Johansson <oej@edvina.net>

	* configs/sip.conf.sample: Explain the use device status system
	  implemented in SIP for subscriptions, queues and manager a bit
	  better. Like in 1.2, you will get more detailed information if
	  you set a call limit for a device. When the call limit is
	  reached, the status system will report a device as busy. For
	  queues, setting a call limit per SIP device is propably a
	  requirement. In most cases, it will work much better if you only
	  use type=peer and not type=friend. We might decide to backport
	  the new setting from trunk to apply all call limits to the peer
	  part of a friend only.

2006-11-29 16:50 +0000 [r48107]  Joshua Colp <jcolp@digium.com>

	* main/rtp.c, /: Merged revisions 48106 via svnmerge from
	  https://origsvn.digium.com/svn/asterisk/branches/1.2 ........
	  r48106 | file | 2006-11-29 11:47:10 -0500 (Wed, 29 Nov 2006) | 2
	  lines If the frame was duplicated before writing out then we need
	  to free it. (issue #8429 reported by edguy3) ........

2006-11-29 08:03 +0000 [r48105]  Olle Johansson <oej@edvina.net>

	* configs/sip.conf.sample: Clarify RTP timers. Sorry, grandma.

2006-11-29 04:26 +0000 [r48101]  Joshua Colp <jcolp@digium.com>

	* apps/app_voicemail.c: Don't crash if the mailstream was not
	  created.

2006-11-28 18:26 +0000 [r48095]  Jason Parker <jparker@digium.com>

	* Makefile: Export several more variables in top level Makefile.
	  Inspired by issue 8438.

2006-11-28 16:57 +0000 [r48054-48088]  Joshua Colp <jcolp@digium.com>

	* channels/chan_phone.c, /: Merged revisions 48087 via svnmerge
	  from https://origsvn.digium.com/svn/asterisk/branches/1.2
	  ........ r48087 | file | 2006-11-28 11:56:01 -0500 (Tue, 28 Nov
	  2006) | 2 lines According to the research I have done we never
	  needed to include compiler.h in the first place so let's not!
	  (issue #8430 reported by edguy3) ........

	* apps/app_voicemail.c, /: Merged revisions 48053 via svnmerge from
	  https://origsvn.digium.com/svn/asterisk/branches/1.2 ........
	  r48053 | file | 2006-11-27 13:03:57 -0500 (Mon, 27 Nov 2006) | 2
	  lines Use the proper function to get the new message count
	  instead of always using the filesystem. (issue #8421 reported by
	  slimey) ........

2006-11-27 17:20 +0000 [r48049]  Tilghman Lesher <tilghman@mail.jeffandtilghman.com>

	* /, res/res_musiconhold.c: Merged revisions 48045 via svnmerge
	  from https://origsvn.digium.com/svn/asterisk/branches/1.2
	  ........ r48045 | tilghman | 2006-11-27 11:15:54 -0600 (Mon, 27
	  Nov 2006) | 2 lines Random MOH wasn't really random (bug 8381)
	  ........

2006-11-27 17:17 +0000 [r48046]  Russell Bryant <russell@digium.com>

	* main/manager.c: Remove a couple of unused variables (issue #8380,
	  casper)

2006-11-27 15:32 +0000 [r48038]  Joshua Colp <jcolp@digium.com>

	* pbx/pbx_spool.c, /: Merged revisions 48037 via svnmerge from
	  https://origsvn.digium.com/svn/asterisk/branches/1.2 ........
	  r48037 | file | 2006-11-27 10:30:37 -0500 (Mon, 27 Nov 2006) | 2
	  lines Do not reference the freed outgoing structure in the debug
	  message. (issue #8425 reported by arkadia) ........

2006-11-27 06:41 +0000 [r48031]  Olle Johansson <oej@edvina.net>

	* channels/chan_sip.c: Change logging message

2006-11-26 00:26 +0000 [r48015-48017]  Steve Murphy <murf@digium.com>

	* funcs/func_cdr.c: might as well also document the raw values of
	  the flag vars

	* /, funcs/func_cdr.c: A little bit of func_cdr documentation
	  upgrade-- no bug# involved, although 8221 may have inspired it.

2006-11-25 09:28 +0000 [r48002]  Olle Johansson <oej@edvina.net>

	* /, channels/chan_sip.c: Not having a HINT is not an ERROR. In 1.4
	  and future releases, you can disable subscription support totally
	  or per peer in sip.conf with allowsubscribe = yes | no

2006-11-24 17:17 +0000 [r47992]  Steve Murphy <murf@digium.com>

	* main/translate.c: bug 8189 posted this fix for main/translate.c
	  for PLC

2006-11-24 15:46 +0000 [r47989]  Christian Richter <christian.richter@beronet.com>

	* channels/misdn/isdn_lib.c, channels/misdn_config.c,
	  channels/chan_misdn.c, /: Merged revisions 47968 via svnmerge
	  from https://origsvn.digium.com/svn/asterisk/branches/1.2
	  ........ r47968 | crichter | 2006-11-23 17:10:23 +0100 (Do, 23
	  Nov 2006) | 1 line fixed a litle bug regarding HOLD/RETRIEVE.
	  beatufied some logs, changed some loglevels. changed the default
	  value of block_on_alarm ........

2006-11-23 11:01 +0000 [r47959]  Olle Johansson <oej@edvina.net>

	* /, channels/chan_sip.c: Don't allocate unused variable.

2006-11-22 21:47 +0000 [r47944]  Joshua Colp <jcolp@digium.com>

	* main/rtp.c: Video will never reach Packet2Packet bridging and can
	  do more harm then good.

2006-11-21 17:32 +0000 [r47897]  Joshua Colp <jcolp@digium.com>

	* main/rtp.c: If we have the non standard G726-32 setting turned on
	  we want to return G726-32 to the SDP, not our AAL2 string. (issue
	  #8330 reported by voipgate)

2006-11-21 15:20 +0000 [r47892]  Olle Johansson <oej@edvina.net>

	* channels/chan_sip.c: Apparently Exosip sends a 101 after a 100
	  provisional response. Let's not treat that as early media.
	  (discovered at the AVTF meeting in Paris).

2006-11-20 20:01 +0000 [r47863-47864]  Tilghman Lesher <tilghman@mail.jeffandtilghman.com>

	* apps/app_voicemail.c: Oops, merge missed release of odbc object

	* apps/app_voicemail.c, /: Merged revisions 47862 via svnmerge from
	  https://origsvn.digium.com/svn/asterisk/branches/1.2 ........
	  r47862 | tilghman | 2006-11-20 13:59:07 -0600 (Mon, 20 Nov 2006)
	  | 2 lines Failing to trap -1 error from mmap causes segfault
	  (Issue 8385) ........

2006-11-20 19:51 +0000 [r47850-47860]  Joshua Colp <jcolp@digium.com>

	* main/frame.c, /: Merged revisions 47859 via svnmerge from
	  https://origsvn.digium.com/svn/asterisk/branches/1.2 ........
	  r47859 | file | 2006-11-20 14:50:21 -0500 (Mon, 20 Nov 2006) | 2
	  lines Don't forget to byte swap if we are exiting the smoother
	  feed early. (issue #8287 reported by arturs) ........

	* /: Blocked revisions 47855 via svnmerge ........ r47855 | file |
	  2006-11-20 11:16:22 -0500 (Mon, 20 Nov 2006) | 2 lines Free
	  history items at the end of use of the temporary SIP pvt
	  structure. (issue #8383 reported by benh) ........

	* main/rtp.c: Only remove/destroy the RTCP I/O item if it exists.

	* .cleancount, apps/app_dial.c, apps/app_directed_pickup.c,
	  include/asterisk/channel.h: Use a separate variable in the
	  channel structure to store the context that the channel was
	  dialed from. (issue #8382 reported by jiddings)

2006-11-20 11:45 +0000 [r47843-47845]  Olle Johansson <oej@edvina.net>

	* configs/sip.conf.sample: Explain properly how videosupport works.
	  Committ from Asterisk Video Task Force meeting in Paris!

	* /, channels/chan_sip.c: Make sure we destroy scheduled items and
	  not use them ever again after destruction (rizzo)

2006-11-18 17:59 +0000 [r47823]  Luigi Rizzo <rizzo@icir.org>

	* channels/chan_sip.c: fix bug 7450 - Parsing fails if From header
	  contains angle brackets (the bug was only in a corner case where
	  the < was right after the opening quote, and the fix is trivial).

2006-11-16 23:19 +0000 [r47781-47782]  Jason Parker <jparker@digium.com>

	* apps/app_db.c, apps/app_dial.c: Fix a couple of typos. Initially
	  pointed out by mrobinson.

	* /: Blocked revisions 47780 via svnmerge ........ r47780 | qwell |
	  2006-11-16 17:16:35 -0600 (Thu, 16 Nov 2006) | 2 lines Fix a
	  couple of typos in applications.. Initially spotted by mrobinson.
	  ........

2006-11-16 23:00 +0000 [r47777]  Kevin P. Fleming <kpfleming@digium.com>

	* /, doc/billing.txt: update documentation regarding IAX2 transfers
	  and CDRs Merged revisions 47776 via svnmerge from
	  https://origsvn.digium.com/svn/asterisk/branches/1.2 ........
	  r47776 | kpfleming | 2006-11-16 16:57:31 -0600 (Thu, 16 Nov 2006)
	  | 2 lines update clearly wrong documentation regarding cdr_custom
	  ........

2006-11-16 21:11 +0000 [r47762-47764]  Joshua Colp <jcolp@digium.com>

	* channels/chan_sip.c: Compare technology using the pointers
	  instead of a straight comparison based on name. (issue #8228
	  reported by dean bath)

	* /: Blocked revisions 47761 via svnmerge ........ r47761 | file |
	  2006-11-16 15:29:28 -0500 (Thu, 16 Nov 2006) | 2 lines Look for
	  the header file specifically in all cases, not just the existence
	  of the directory. (issue #8358 reported by mrness) ........

2006-11-16 20:09 +0000 [r47758]  Kevin P. Fleming <kpfleming@digium.com>

	* configure, configure.ac: check for pre-1.4 versions of Zaptel and
	  abort the configure script if found with an appropriate error
	  message

2006-11-16 19:24 +0000 [r47755]  Olle Johansson <oej@edvina.net>

	* channels/chan_sip.c, configs/sip.conf.sample: Make the HOLD
	  notification optional, in order to avoid a lot of extra database
	  lookups for all those realtime users out there.

2006-11-16 18:29 +0000 [r47748-47751]  Joshua Colp <jcolp@digium.com>

	* channels/chan_local.c, /: Merged revisions 47750 via svnmerge
	  from https://origsvn.digium.com/svn/asterisk/branches/1.2
	  ........ r47750 | file | 2006-11-16 13:26:50 -0500 (Thu, 16 Nov
	  2006) | 2 lines Because of the way chan_local is written we
	  should be extra careful and make sure our callback functions have
	  a tech_pvt. (issue #8275 reported by mflorell) ........

	* apps/app_meetme.c: Don't unreference the SLA object if there is
	  no SLA object in the devicestate callback. (issue #8354 reported
	  by loloski)

2006-11-16 16:51 +0000 [r47733-47744]  Olle Johansson <oej@edvina.net>

	* /, channels/chan_sip.c: Don't fixup if there's nothing to fixup

	* UPGRADE.txt: Warn users about change in canreinvite

	* channels/chan_sip.c, configs/sip.conf.sample: - CANCEL is never
	  authenticated (according to the RFC) - Update docs on
	  canreinvite. "nonat" is the recommended setting for most users
	  with phones behind a NAT.

2006-11-15 22:31 +0000 [r47712]  Joshua Colp <jcolp@digium.com>

	* channels/chan_local.c, /: Merged revisions 47711 via svnmerge
	  from https://origsvn.digium.com/svn/asterisk/branches/1.2
	  ........ r47711 | file | 2006-11-15 17:29:30 -0500 (Wed, 15 Nov
	  2006) | 2 lines Make sure that the pvt structure exists before
	  trying to do fixup on Local channels. (issue #7937 reported by
	  mada123, fix by alamantia with mods by me) ........

2006-11-15 21:56 +0000 [r47709]  Tilghman Lesher <tilghman@mail.jeffandtilghman.com>

	* apps/app_voicemail.c: Fix ODBC_STORAGE for when context is NULL

2006-11-15 21:33 +0000 [r47707]  Joshua Colp <jcolp@digium.com>

	* main/channel.c: We need to ensure timelimit stuff is included as
	  well so warnings get played. (issue #8050 reported by KNK)

2006-11-15 20:50 +0000 [r47701]  Kevin P. Fleming <kpfleming@digium.com>

	* main/file.c: don't try to call fclose() if fopen() failed

2006-11-15 20:31 +0000 [r47698]  Olle Johansson <oej@edvina.net>

	* channels/chan_sip.c: - Improve SIP history - Never send reply to
	  ACK (again...)

2006-11-15 20:31 +0000 [r47684-47697]  Kevin P. Fleming <kpfleming@digium.com>

	* apps/app_voicemail.c, /: Merged revisions 47677 via svnmerge from
	  https://origsvn.digium.com/svn/asterisk/branches/1.2 ........
	  r47677 | kpfleming | 2006-11-15 11:56:42 -0600 (Wed, 15 Nov 2006)
	  | 4 lines ensure that message duration is included in email
	  notifications for forwarded messages (BE-96, fix by me after
	  corydon used his clue-bat on me) ensure that duration in the
	  message metadata is updated if prepending is done during
	  forwarding (related to BE-96) remove prototype for API call that
	  does not exist ........

	* main/config.c, /: Merged revisions 47686,47688-47689 via svnmerge
	  from https://origsvn.digium.com/svn/asterisk/branches/1.2
	  ........ r47686 | kpfleming | 2006-11-15 13:42:05 -0600 (Wed, 15
	  Nov 2006) | 2 lines clear the category's variable tail pointer as
	  well when variables are detached from it ........ r47688 |
	  kpfleming | 2006-11-15 13:47:43 -0600 (Wed, 15 Nov 2006) | 2
	  lines when appending a list of variable to a category, ensure the
	  tail pointer points to the last variable in the list ........
	  r47689 | kpfleming | 2006-11-15 13:58:46 -0600 (Wed, 15 Nov 2006)
	  | 2 lines when re-writing the config file, don't repeat the path
	  if it hasn't changed ........

	* main/config.c, /: Merged revisions 47682 via svnmerge from
	  https://origsvn.digium.com/svn/asterisk/branches/1.2 ........
	  r47682 | kpfleming | 2006-11-15 12:39:47 -0600 (Wed, 15 Nov 2006)
	  | 2 lines ouch... don't use printf, use ast_log/ast_verbose
	  ........

2006-11-15 17:46 +0000 [r47672]  Luigi Rizzo <rizzo@icir.org>

	* main/cli.c: fix longest match search in find_cli. Trunk already
	  fixed. 1.2 not affected (well, i have no idea, the code is
	  totally different there).

2006-11-15 15:25 +0000 [r47649-47656]  Olle Johansson <oej@edvina.net>

	* /, channels/chan_sip.c: Send error message when we can't allocate
	  SIP dialog, possibly due to limitation of file descriptors.
	  (imported from 1.2)

2006-11-15 04:45 +0000 [r47645]  Joshua Colp <jcolp@digium.com>

	* main/rtp.c: If NAT detection is turned on or already detected
	  then say NAT is active when setting the remote RTP peer when
	  doing early bridging. (issue #8365 reported by marcelbarbulescu)

2006-11-15 00:19 +0000 [r47641]  Kevin P. Fleming <kpfleming@digium.com>

	* main/term.c: more formatting cleanup, and avoid running off the
	  end of the string

2006-11-15 00:14 +0000 [r47639]  Joshua Colp <jcolp@digium.com>

	* main/rtp.c: Turn notice about unknown RTCP packet type into a
	  debug message instead.

2006-11-15 00:05 +0000 [r47635]  Kevin P. Fleming <kpfleming@digium.com>

	* channels/misdn/isdn_lib.c: silence compiler warning on 64-bit
	  platforms (this variable is an 'int' anyway, comparing it to
	  'signed long' is not useful)

2006-11-14 22:17 +0000 [r47625-47632]  Joshua Colp <jcolp@digium.com>

	* apps/app_voicemail.c, /: Merged revisions 47631 via svnmerge from
	  https://origsvn.digium.com/svn/asterisk/branches/1.2 ........
	  r47631 | file | 2006-11-14 17:15:10 -0500 (Tue, 14 Nov 2006) | 2
	  lines Update copyright information in the ADSI logo blob.
	  ........

	* channels/chan_sip.c: Only keep the video RTP structure around if
	  1. Video support is enabled and 2. A video codec is enabled on
	  the dialog

	* funcs/func_uri.c: Small documentation clarification for
	  URIENCODE. (issue #8294 reported by salaud)

2006-11-14 18:54 +0000 [r47621]  Tilghman Lesher <tilghman@mail.jeffandtilghman.com>

	* apps/app_voicemail.c: Conversion of res_odbc API to include ast_
	  prefix did not completely transition app_voicemail when
	  ODBC_STORAGE is used (reported on IRC by caio1982, not in
	  bugtracker)

2006-11-14 16:45 +0000 [r47617]  Joshua Colp <jcolp@digium.com>

	* apps/app_amd.c: Use LOG_DEBUG to print out the indication that
	  app_amd is using default settings instead of using LOG_NOTICE.
	  This stops needless logging of this information under normal
	  circumstances. (issue #8361 reported by Seb7)

2006-11-14 16:22 +0000 [r47597-47613]  Olle Johansson <oej@edvina.net>

	* channels/chan_sip.c: Update documentation to fit the
	  implementation...

	* /, channels/chan_sip.c: Issue #8272 - Don't destroy dialog in
	  retransmission system if it's an OPTION packet from peerpoke

2006-11-13 21:28 +0000 [r47584]  Joshua Colp <jcolp@digium.com>

	* /, cdr/cdr_pgsql.c: Merged revisions 47583 via svnmerge from
	  https://origsvn.digium.com/svn/asterisk/branches/1.2 ........
	  r47583 | file | 2006-11-13 16:26:36 -0500 (Mon, 13 Nov 2006) | 2
	  lines Initialize global pointers for connection and result to
	  NULL. (issue #8356 reported by james) ........

2006-11-13 20:20 +0000 [r47581]  Tilghman Lesher <tilghman@mail.jeffandtilghman.com>

	* /, channels/chan_sip.c: Merged revisions 47580 via svnmerge from
	  https://origsvn.digium.com/svn/asterisk/branches/1.2 ........
	  r47580 | tilghman | 2006-11-13 14:18:30 -0600 (Mon, 13 Nov 2006)
	  | 2 lines Having more than 255 old messages caused corruption in
	  the new/old count ........

2006-11-13 19:15 +0000 [r47576]  Steve Murphy <murf@digium.com>

	* main/config.c: This solves bug 8342, whereby a crash occurs under
	  certain circumstances while reading a config file with comments--
	  a call to CB_ADD shouldn't happen if withcomments is zero

2006-11-13 19:11 +0000 [r47573]  Tilghman Lesher <tilghman@mail.jeffandtilghman.com>

	* main/cli.c, channels/chan_sip.c: Re-enable old deprecated
	  commands

2006-11-13 19:10 +0000 [r47572]  Olle Johansson <oej@edvina.net>

	* /, channels/chan_sip.c: - Don't reply to INVITE already replied
	  to when we get BYE - Declare errmsg as int. Oops.

2006-11-13 18:18 +0000 [r47564]  Steve Murphy <murf@digium.com>

	* pbx/ael/ael-test/ref.ael-test3: Eager people beat me to fixing
	  the messed if, but we all forgot to update the regressions. Until
	  now.

2006-11-13 17:13 +0000 [r47553]  Steve Murphy <murf@digium.com>

	* pbx/pbx_ael.c: AEL need not complain about parkedcalls not being
	  found... just confuses users

2006-11-13 17:08 +0000 [r47542-47551]  Joshua Colp <jcolp@digium.com>

	* /, apps/app_sms.c: Merged revisions 47549 via svnmerge from
	  https://origsvn.digium.com/svn/asterisk/branches/1.2 ........
	  r47549 | file | 2006-11-13 12:05:32 -0500 (Mon, 13 Nov 2006) | 2
	  lines When sending an SMS with a user data header properly set
	  the UDH flag in the first byte. (issue #8347 reported by
	  hoffmeis) ........

	* main/cli.c: Free full command string upon unregistering of CLI
	  command. Backported from revision 47536 from rizzo.

2006-11-13 16:00 +0000 [r47540]  Olle Johansson <oej@edvina.net>

	* channels/chan_sip.c: Only produce error message about sip history
	  once

2006-11-13 05:48 +0000 [r47527]  Russell Bryant <russell@digium.com>

	* configure, acinclude.m4: AC_PROG_SED is included in autoconf
	  2.60, but apparently it is not included in 2.59. So, to maintain
	  compatability with 2.59 since it is a small change, copy this
	  macro into acinclude.m4 and rename it to AST_PROG_SED. (issue
	  #8345)

2006-11-13 05:46 +0000 [r47523-47526]  Tilghman Lesher <tilghman@mail.jeffandtilghman.com>

	* res/res_odbc.c, /: Merged revisions 47525 via svnmerge from
	  https://origsvn.digium.com/svn/asterisk/branches/1.2 ........
	  r47525 | tilghman | 2006-11-12 23:45:11 -0600 (Sun, 12 Nov 2006)
	  | 2 lines If the execute fails a second time, make sure that we
	  don't pass back a stale handle ........

	* channels/chan_zap.c, /: Merged revisions 47522 via svnmerge from
	  https://origsvn.digium.com/svn/asterisk/branches/1.2 ........
	  r47522 | tilghman | 2006-11-12 18:34:44 -0600 (Sun, 12 Nov 2006)
	  | 2 lines Don't play dialtone if the seizing the channel fails
	  (Bug 7754) ........

2006-11-12 16:12 +0000 [r47507-47513]  Olle Johansson <oej@edvina.net>

	* channels/chan_sip.c: Issue 8314 - Restore auto-framing (Thanks
	  DEA!!!)

	* channels/chan_sip.c: Part of issue 8078 - parse even if udptl is
	  UDPTL in sdp...

	* channels/chan_sip.c: - Don't destroy SIP dialog because of a
	  failed T.38 re-invite. Wait for a bye. Final response to a
	  re-invite does not mean that the session dies, only that the
	  re-invite fails. - Keep RTP active during processing of T.38
	  re-invite. If the re-invite fails, RTP needs to remain as before
	  the re-invite. Issue 8338 - darren1713. Please test.

	* channels/chan_sip.c: -Remove blocking of ptime: parsing in sdp
	  -Add some comments to t.38 code

2006-11-12 06:23 +0000 [r47492-47497]  Russell Bryant <russell@digium.com>

	* /, channels/chan_iax2.c: Merged revisions 47496 via svnmerge from
	  https://origsvn.digium.com/svn/asterisk/branches/1.2 ........
	  r47496 | russell | 2006-11-12 01:09:03 -0500 (Sun, 12 Nov 2006) |
	  4 lines Only do the check to determine whether the channel
	  calling this function is an IAX2 channel when getting the IP
	  address using the special argument, CURRENTCHANNEL. (issue #8341,
	  jcovert) ........

	* Makefile: Add the target "menuconfig" as an alias for the
	  "menuselect" target. This is just a favor to users so that if you
	  accidentally type "make menuconfig" instead of "make menuselect",
	  it still works. (inspired by a comment on IRC from wangster
	  calling me an "especially devious asterisk developer" for having
	  it be menuselect instead of menuconfig. :) )

	* main/term.c: Tweak the formatting of this new function to better
	  conform to coding guidelines.

2006-11-11 02:04 +0000 [r47490]  Matt O'Gorman <mogorman@digium.com>

	* main/term.c, /, main/logger.c, include/asterisk/term.h: woohoo
	  safe output!

2006-11-10 22:23 +0000 [r47480]  Matt Frederickson <creslin@digium.com>

	* channels/chan_zap.c: Make sure we don't use 32 bits when we only
	  need one bit.

2006-11-10 21:42 +0000 [r47463-47476]  Olle Johansson <oej@edvina.net>

	* channels/chan_sip.c: ...and make sure that the dialog is
	  destroyed, even if we don't get any answer on the bye... This is
	  the channel that remains dead after the SIP transfer

	* channels/chan_sip.c: Add debug output while trying to trace bug
	  in bug report

	* channels/chan_sip.c: Make sure we destroy dialog...

	* /, channels/chan_sip.c: Small cleanup of handle_request_invite()
	  - imported from 1.2 with changes

2006-11-10 19:47 +0000 [r47462]  Matt Frederickson <creslin@digium.com>

	* channels/chan_zap.c: Fix for #7321. Be able to explicitly hide
	  callerid name for switches that bork on it.

2006-11-10 18:56 +0000 [r47454]  Olle Johansson <oej@edvina.net>

	* /, channels/chan_sip.c: Issue 8010 - Fix support for multipart
	  SDP (alphaque)

2006-11-10 17:13 +0000 [r47444]  Luigi Rizzo <rizzo@icir.org>

	* build_tools/prep_moduledeps: grep -m is not available on BSD, so
	  use head -1 instead

2006-11-10 16:53 +0000 [r47437]  Joshua Colp <jcolp@digium.com>

	* apps/app_chanspy.c: Only split up extension and context if a
	  value exists. (issue #8332 reported by loloski)

2006-11-10 16:51 +0000 [r47436]  Tilghman Lesher <tilghman@mail.jeffandtilghman.com>

	* channels/chan_mgcp.c, main/cli.c, channels/chan_sip.c,
	  channels/chan_skinny.c, channels/chan_h323.c,
	  channels/chan_iax2.c: Discussion of these CLI changes resulted in
	  more consistency (Bug 8236)

2006-11-10 16:36 +0000 [r47432-47433]  Kevin P. Fleming <kpfleming@digium.com>

	* apps/app_queue.c: if adding a queue member is LOG_NOTICE, then
	  removing them should be LOG_NOTICE, not LOG_DEBUG

	* apps/app_queue.c: reflect addition/removal of dynamic queue
	  members in queue_log, so that people using dialplan replacement
	  for AgentCallbackLogin can still track login/logout (issue #7736,
	  reported/patched by whoiswes but this commit was written by me
	  and covers all three paths for AQM/RQM)

2006-11-10 13:04 +0000 [r47414-47418]  Olle Johansson <oej@edvina.net>

	* channels/chan_sip.c: Rip out half implementation of 491 response
	  support, since it wasn't implemented properly and caused memory
	  leaks in the case of us getting 491's, which Asterisk actually
	  sends... Since it is a bit too complicated to fix this, I'll rip
	  it out of 1.4 and put it on the to-do-list for future releases.
	  Now, we handle this as congestion, which it really is. Issue
	  #8331

	* channels/chan_sip.c: Fix bit definition for SIP_PAG2_CALL_ONHOLD.
	  Thanks fenlander!

2006-11-10 03:44 +0000 [r47398-47405]  Joshua Colp <jcolp@digium.com>

	* channels/chan_h323.c: Fix building of chan_h323 by completeing
	  some structure definitions. (issue #8327 reported by Mithraen)

	* apps/app_voicemail.c: Do conversion in a more easier to read and
	  working way for \r, \n, and \t. (issue #8324 reported by
	  johnlange)

2006-11-09 21:26 +0000 [r47391]  Russell Bryant <russell@digium.com>

	* apps/app_voicemail.c, channels/chan_zap.c,
	  build_tools/prep_moduledeps: Work around an issue that caused
	  menuselect to display a bogus description for app_voicemail and
	  chan_zap. These modules use some preprocessor directives to
	  determine what it will report to Asterisk as its description.
	  However, the way we extract this information from the source
	  files for menuselect is not smart enough to figure this out.
	  (issue #8326, #8328)

2006-11-09 16:53 +0000 [r47380]  Joshua Colp <jcolp@digium.com>

	* channels/chan_phone.c, /: Merged revisions 47379 via svnmerge
	  from https://origsvn.digium.com/svn/asterisk/branches/1.2
	  ........ r47379 | file | 2006-11-09 11:48:05 -0500 (Thu, 09 Nov
	  2006) | 2 lines Don't include compiler.h on kernels 2.6.18 and
	  higher as, well, it's apparently going to be removed. This should
	  make all you FC6 fans happy as your Asterisk will now build
	  without any mods. ........

2006-11-09 16:28 +0000 [r47352-47377]  Russell Bryant <russell@digium.com>

	* main/cli.c: fix tab completion for "core debug channel" and "core
	  no debug channel"

	* main/cli.c: Fix "core show channel". Also, fix tab completion for
	  both "core show channel" and "core show channels".

	* main/cli.c: Fix "core debug channel <whatever>". I guess someone
	  needs to go through and audit every CLI command that changed
	  number of arguments ...

	* main/asterisk.c: revert the previous change, which actually
	  modified the deprecated command, "show profile". Now, actually
	  apply the change to "core show profile".

	* main/asterisk.c: Fix argument parsing for the "core show profile"
	  CLI command (fixed by rizzo in his branch, team/rizzo/astobj2)

	* main/cli.c: Fix another CLI command, "core show uptime" ...
	  (issue #8323, reported by johnlange, fixed by myself)

	* main/asterisk.c: fix "core show version" to reflect the new
	  number of arguments for this CLI command (issue #8316, kshumard)

2006-11-08 23:14 +0000 [r47344-47348]  Steve Murphy <murf@digium.com>

	* main/channel.c: This update fixes 7531

	* channels/chan_skinny.c: Committed in behalf of 8190.

2006-11-08 21:46 +0000 [r47333-47338]  Kevin P. Fleming <kpfleming@digium.com>

	* main/frame.c: the battle over CLI command formats has broken
	  stuff...

	* channels/chan_sip.c: add simple fix for SDP to report proper
	  sample rate for G.722 media sessions

2006-11-08 17:03 +0000 [r47323-47331]  Russell Bryant <russell@digium.com>

	* utils/streamplayer.c: I occasionally get email from users that
	  are trying to figure out what this does, or due to some
	  misunderstanding as to what it is supposed to do, can't get it to
	  work. So, I have added some text here to hopefully explain what
	  this application does and does not do.

	* channels/chan_gtalk.c: Make this module build again

	* configure, configure.ac, acinclude.m4: Copy the macros from
	  libtool.m4 to our own acinclude.m4 such that libtool is no longer
	  required to be installed to be able to generated the configure
	  script.

2006-11-08 07:43 +0000 [r47309-47310]  Olle Johansson <oej@edvina.net>

	* /, channels/chan_sip.c: Destroy dialog properly at unload (rizzo)

2006-11-07 23:46 +0000 [r47303]  Steve Murphy <murf@digium.com>

	* channels/chan_oss.c, main/channel.c, channels/chan_phone.c,
	  channels/chan_misdn.c, channels/chan_skinny.c,
	  channels/chan_features.c, channels/chan_h323.c,
	  channels/chan_alsa.c, channels/chan_nbs.c, channels/chan_mgcp.c,
	  include/asterisk/stringfields.h, apps/app_voicemail.c,
	  main/pbx.c, channels/chan_vpb.cc, channels/chan_local.c,
	  channels/chan_zap.c, channels/chan_sip.c, res/res_features.c,
	  channels/chan_agent.c, main/utils.c, include/asterisk/channel.h,
	  channels/chan_gtalk.c, channels/chan_iax2.c: These mods are to
	  solve the problem in bug 7506. It's a lot of rework to solve a
	  fairly small problem... such is life.

2006-11-07 20:14 +0000 [r47284-47287]  Joshua Colp <jcolp@digium.com>

	* channels/chan_local.c: Make MOH work as it did before in
	  chan_local, without this then it can go funky when transfers and
	  MOH are involved. (issue #7671 reported by jmls)

2006-11-07 18:56 +0000 [r47279]  Kevin P. Fleming <kpfleming@digium.com>

	* configs/musiconhold.conf.sample: clean up sample config, and make
	  native file playback the more obvious default choice

2006-11-07 18:38 +0000 [r47275]  Matt O'Gorman <mogorman@digium.com>

	* apps/app_voicemail.c: large overhaul to voicemail imap support.
	  Allows support for more imap servers, also a better
	  implementation of several parts of the original work. patch
	  provided by 8033 with major upgrades.

2006-11-07 17:30 +0000 [r47268]  Olle Johansson <oej@edvina.net>

	* channels/chan_sip.c: Issue 8303 (lrizzo) - break instead of
	  continue.

2006-11-07 13:13 +0000 [r47250]  Olle Johansson <oej@edvina.net>

	* /, channels/chan_sip.c: Fixing the attack shield so it doesn't
	  produce attacks... Issue 8265 - never reply to an ACK

2006-11-07 01:25 +0000 [r47239]  Russell Bryant <russell@digium.com>

	* /, res/res_musiconhold.c: Merged revisions 47238 via svnmerge
	  from https://origsvn.digium.com/svn/asterisk/branches/1.2
	  ........ r47238 | russell | 2006-11-06 20:22:58 -0500 (Mon, 06
	  Nov 2006) | 5 lines If random order is enabled for files mode
	  music on hold, set a random initial position, instead of always
	  starting at the first file, and doing the random operation only
	  when switching to the next file. (bug reported by John Lange on
	  the asterisk-dev mailing list) ........

2006-11-04 18:32 +0000 [r47199]  Olle Johansson <oej@edvina.net>

	* channels/chan_sip.c: Issue #8284: Fixes to Invite/replaces and
	  transfer from "john" Thank you!

2006-11-04 18:10 +0000 [r47192-47196]  Russell Bryant <russell@digium.com>

	* main/cli.c: Fix another bug in "core set debug" ...

	* main/asterisk.c, main/cli.c: Really fix the "core set debug" and
	  "core set verbose" CLI commands.

	* main/cli.c: fix the "atleast" option to the "core set verbose"
	  and "core set debug" CLI commands

2006-11-03 23:17 +0000 [r47176]  Steve Murphy <murf@digium.com>

	* channels/chan_sip.c: This fix introduced via bug 8233

2006-11-03 17:53 +0000 [r47107-47108]  Luigi Rizzo <rizzo@icir.org>

	* bootstrap.sh: align bootstrap.sh with the version in trunk (needs
	  to be blocked as it is already in trunk)

	* configure.ac: add proper environment vars to detect modules on
	  freebsd. (already applied to trunk so it needs to be blocked
	  there)

2006-11-02 23:49 +0000 [r47051-47053]  Tilghman Lesher <tilghman@mail.jeffandtilghman.com>

	* main/rtp.c, main/udptl.c, channels/chan_skinny.c, res/res_agi.c,
	  channels/chan_h323.c, apps/app_queue.c, res/res_jabber.c: More
	  changes making the CLI more consistent with "category verb
	  arguments" (continuation of issue 8236)

	* main/config.c, main/cli.c, main/channel.c, main/manager.c,
	  channels/chan_skinny.c, channels/chan_features.c, res/res_agi.c,
	  main/http.c, main/file.c, main/logger.c, main/image.c,
	  res/res_indications.c, main/asterisk.c, res/res_odbc.c,
	  channels/chan_mgcp.c, apps/app_voicemail.c, main/pbx.c,
	  channels/chan_local.c, main/frame.c, channels/chan_sip.c,
	  res/res_features.c, channels/chan_agent.c, res/res_crypto.c,
	  res/res_musiconhold.c, channels/chan_iax2.c, apps/app_queue.c:
	  Reverse change of "show" to "list" and make several other
	  commands more consistent with "category verb arguments"

2006-11-02 19:56 +0000 [r46992-47015]  Olle Johansson <oej@edvina.net>

	* channels/chan_sip.c: Move check for codec translation to
	  sip_call() instead of in add_sdp. No one bothers with the result
	  of add_sdp anyway... Yet...

	* channels/chan_sip.c: Disable code for T38 over TCP and RTP since
	  there's no trace of actual functionality for it :-)

2006-11-02 17:49 +0000 [r46965]  Russell Bryant <russell@digium.com>

	* /, res/res_musiconhold.c: Merged revisions 46964 via svnmerge
	  from https://origsvn.digium.com/svn/asterisk/branches/1.2
	  ........ r46964 | russell | 2006-11-02 12:47:56 -0500 (Thu, 02
	  Nov 2006) | 3 lines ignore files in a music on hold directory
	  that begin with '.' (issue #8249, cboie) ........

2006-11-02 17:17 +0000 [r46963]  Nadi Sarrar <ns@beronet.com>

	* channels/misdn/isdn_lib.c: find_free_chan_in_stack usage fix

2006-11-02 16:45 +0000 [r46937]  Kevin P. Fleming <kpfleming@digium.com>

	* channels/chan_sip.c: don't send INVITE when we have determined
	  that we can't offer any audio formats due to lack of transcoding
	  support (or incorrect configuration)

2006-11-02 16:06 +0000 [r46930]  Joshua Colp <jcolp@digium.com>

	* /, channels/chan_sip.c: Merged revisions 46920 via svnmerge from
	  https://origsvn.digium.com/svn/asterisk/branches/1.2 ........
	  r46920 | file | 2006-11-02 11:02:27 -0500 (Thu, 02 Nov 2006) | 2
	  lines Repeat after me oej: I will at least make sure my code
	  compiles before I commit it. ........

2006-11-02 15:24 +0000 [r46901]  Olle Johansson <oej@edvina.net>

	* /, channels/chan_sip.c: Dont overwrite pkt->flags (from 1.2)

2006-11-02 14:02 +0000 [r46845-46883]  Russell Bryant <russell@digium.com>

	* /, main/callerid.c: Add the missing call to free described in
	  issue #8268. Also, add a bunch of missing calls to free in
	  callerid_feed_jp().

	* main/say.c: fix saying one hundred and two hundred in hebrew
	  (issue #7810, eldadran)

	* Makefile, configure, codecs/gsm/Makefile, configure.ac,
	  build_tools/strip_nonapi, makeopts.in: Fixes for
	  cross-compilation on mips (issue #8058, ywalther, with some
	  modifications)

	* aclocal.m4, build_tools/menuselect-deps.in, configure,
	  build_tools/embed_modules.xml, configure.ac: Add a check in the
	  configure script to determine whether ld is GNU ld or not. This
	  is needed because module embedding only works for gnu ld. GNU ld
	  is now listed as a dependency for all of the module embedding
	  options in menuselect. (issue #8143)

2006-11-01 20:35 +0000 [r46822]  Matt O'Gorman <mogorman@digium.com>

	* channels/chan_gtalk.c: bind address support from bug 8164

2006-11-01 19:49 +0000 [r46802]  Steve Murphy <murf@digium.com>

	* res/res_config_odbc.c: a fix for bug 8251; the var_val needs to
	  accept longer strings or mass confusion and a lot of lost time is
	  the result

2006-11-01 18:39 +0000 [r46780]  Joshua Colp <jcolp@digium.com>

	* main/Makefile: Force poll() emulation for Darwin to always be on.
	  It's too broken to consider being used. This resolves the console
	  issue OSX users have been seeing. I would have liked to autoconf
	  this but I haven't been able to come up with a test case that
	  works. Que sera.

2006-11-01 18:26 +0000 [r46778]  Russell Bryant <russell@digium.com>

	* res/res_monitor.c, /: Merged revisions 46776 via svnmerge from
	  https://origsvn.digium.com/svn/asterisk/branches/1.2 ........
	  r46776 | russell | 2006-11-01 13:24:17 -0500 (Wed, 01 Nov 2006) |
	  9 lines soxmix and Asterisk expect different file extensions for
	  certain formats. This was already handled for the wav49 format.
	  However, it was not handled for ulaw and alaw. I fixed this in
	  such a way that using the alternate extensions for ulaw and alaw
	  will only happen if we know we're calling soxmix, and not a
	  custom script defined using the MONITOR_EXEC variable. The wav49
	  processing was left alone so that external scripts will see no
	  behavior change. (issue #7550, reported by mnicholson, proposed
	  patch by junky, committed fix is a bit different) ........

2006-11-01 18:21 +0000 [r46775]  Joshua Colp <jcolp@digium.com>

	* channels/chan_iax2.c: It's another round of chan_iax2 fixes!
	  Should hopefully fix the deadlock issues people have been
	  reporting. IAXtel now has qualify turned on for 800 peers and it
	  is handling it fine.

2006-11-01 17:48 +0000 [r46760]  Steve Murphy <murf@digium.com>

	* main/config.c: Cleanups suggested by Russell.

2006-11-01 16:39 +0000 [r46744]  Russell Bryant <russell@digium.com>

	* channels/chan_zap.c: Prevent an infinite loop when config
	  processing gets to a jitterbuffer option

2006-10-31 22:02 +0000 [r46716]  Jason Parker <jparker@digium.com>

	* main/translate.c: Fix "core show translation" output. Issue
	  #8243, patch by Damin.

2006-10-31 21:47 +0000 [r46711-46714]  Kevin P. Fleming <kpfleming@digium.com>

	* include/asterisk/translate.h, main/translate.c: add an API so
	  that translators can activate/deactivate themselves when needed

	* include/asterisk/translate.h, main/translate.c: revert changes
	  that were the wrong way to address this... proper fix coming

	* main/translate.c: let's set the seen flag early enough to
	  actually make a difference...

	* include/asterisk/translate.h, main/translate.c: don't re-do setup
	  operations for translators that can dynamically register
	  themselves

2006-10-31 15:49 +0000 [r46663]  Tilghman Lesher <tilghman@mail.jeffandtilghman.com>

	* /: Blocked revisions 46662 via svnmerge ........ r46662 |
	  tilghman | 2006-10-31 09:46:04 -0600 (Tue, 31 Oct 2006) | 3 lines
	  Move thread-unsafe initializer to the module loading code; add
	  the corresponding function to the module unload to fix a memory
	  leak. ........

2006-10-31 10:56 +0000 [r46583-46631]  Olle Johansson <oej@edvina.net>

	* main/enum.c, funcs/func_enum.c, include/asterisk/enum.h: Issue
	  #8089 - Fix the ENUM support (picking one record by number).
	  Thanks otmar!

	* /, channels/chan_sip.c, configs/sip.conf.sample: Support ;rport
	  when we're supposed to support ;rport. Issue #7473.

	* /, channels/chan_sip.c: If peer fails ACL check, fail peer at
	  REGISTER

	* channels/chan_sip.c: Fix T38 too. Thanks, tgrman !

2006-10-31 06:30 +0000 [r46554-46563]  Russell Bryant <russell@digium.com>

	* contrib/init.d/rc.redhat.asterisk: Start Asterisk later in the
	  boot process to ensure it starts after stuff like MySQL (issue
	  #8253, Alric)

	* /, main/utils.c: Merged revisions 46560 via svnmerge from
	  https://origsvn.digium.com/svn/asterisk/branches/1.2 ........
	  r46560 | russell | 2006-10-31 01:18:36 -0500 (Tue, 31 Oct 2006) |
	  3 lines When handling the case where the hostname is just an IPV4
	  numeric address, be sure to set the address type. (issue #8247,
	  alexr) ........

	* /, res/res_agi.c: Merged revisions 46557 via svnmerge from
	  https://origsvn.digium.com/svn/asterisk/branches/1.2 ........
	  r46557 | russell | 2006-10-31 01:13:09 -0500 (Tue, 31 Oct 2006) |
	  3 lines fix some copy/paste bugs in the checking of arguments for
	  the "control stream file" AGI command (issue #8255, mnicholson)
	  ........

	* main/translate.c: Add a small tweak to the code that checks to
	  see whether destination formats are translatable based on the
	  source format. If we have already determined that there is no
	  translation path in one direction, don't bother checking the
	  other direction.

2006-10-30 22:19 +0000 [r46511-46526]  Kevin P. Fleming <kpfleming@digium.com>

	* main/translate.c: when unregistering a translator, don't rebuild
	  the translation matrix unless needed when filtering formats out
	  of an offer, ensure we check for translation ability in both
	  directions

	* include/asterisk/linkedlists.h: ensure that items removed from a
	  list are always unlinked from the list (next pointer set to NULL)

2006-10-30 21:09 +0000 [r46474-46506]  Joshua Colp <jcolp@digium.com>

	* configure, configure.ac: Don't explicitly link in crypt as it is
	  not used on some platforms.

	* channels/chan_iax2.c: We need to lock the pvt structure during
	  retransmission as another worker thread may be doing something as
	  well.

2006-10-30 16:27 +0000 [r46382-46433]  Olle Johansson <oej@edvina.net>

	* main/asterisk.c, apps/app_voicemail.c, include/asterisk/file.h,
	  include/asterisk/doxyref.h, channels/chan_sip.c,
	  main/ast_expr2f.c, include/asterisk/module.h,
	  formats/format_ogg_vorbis.c, main/app.c,
	  include/asterisk/channel.h, include/asterisk/lock.h,
	  include/asterisk/frame.h: Issue #8246 - Doxygen fixes from
	  kshumard. An extra big thankyou is given to everyone that
	  contributes to doxygen! THANK YOU!

	* main/rtp.c, /: Bind RTCP to the same IP as RTP

	* /, channels/chan_sip.c: Issue #7869 - Stop retransmission of 302
	  redirects (imported from 1.2)

	* /, channels/chan_sip.c: Issue #7608 - Notifications sent with
	  wrong content-type (imported from 1.2, modified)

	* channels/chan_sip.c, CHANGES: Backport of patch for #7828 that
	  was reported for trunk, but obviously exists in 1.4 too.

	* channels/chan_sip.c: Restoring the old logic, since working
	  around it and fixing it seemed too complicated. - The
	  SIP_OUTGOING flag indicates the direction of the last transaction
	  in the dialog. - The initreq stores the last request in the
	  dialog, the request that opened the latest transaction. Please
	  now retry all the 1.4 bug reports with mixed to/from headers,
	  tags etc in ACK, BYE, CANCEL. Thanks!

	* channels/chan_sip.c: Accepting a message twice may be
	  misinterpreted...

	* channels/chan_sip.c: - 183 is not reliable message... - Error
	  should not have SDP

2006-10-28 16:37 +0000 [r46377]  Joshua Colp <jcolp@digium.com>

	* utils/Makefile: Don't build muted on OpenBSD, it is not
	  supported.

2006-10-27 19:03 +0000 [r46370]  Russell Bryant <russell@digium.com>

	* channels/chan_zap.c: move the copy of the default settings to the
	  global settings back out of process_zap, so that they aren't
	  overwritten when process_zap is called multiple times

2006-10-27 18:29 +0000 [r46367]  Olle Johansson <oej@edvina.net>

	* contrib/asterisk-ng-doxygen: Put some doxygen pressure on
	  Christian :-)

2006-10-27 17:39 +0000 [r46358-46363]  Russell Bryant <russell@digium.com>

	* main/asterisk.c, res/res_agi.c, apps/app_externalivr.c,
	  res/res_musiconhold.c: We should always be using _exit() after a
	  fork() or vfork() instead of exit(). This is because exit() does
	  some extra cleanup which in some implementations of vfork(), for
	  example, can actually modify the state of the parent process,
	  causing very weird bugs or crashes. (issue #7971, Nick Gavrikov)

	* /: Blocked revisions 46361 via svnmerge ........ r46361 | russell
	  | 2006-10-27 12:36:07 -0500 (Fri, 27 Oct 2006) | 5 lines We
	  should always be using _exit() after a fork() or vfork() instead
	  of exit(). This is because exit() does some extra cleanup which
	  in some implementations of vfork(), for example, can actually
	  modify the state of the parent process, causing very weird bugs
	  or crashes. (issue #7971, Nick Gavrikov) ........

	* channels/chan_zap.c: Instead of iterating all of the options once
	  to look for jitterbuffer options, and then again for everything
	  else, move the processing of jitterbuffer options into the main
	  loop so that there are no erroneous messages about ignoring
	  unknown options. (issue #8226)

2006-10-27 10:03 +0000 [r46351-46353]  Christian Richter <christian.richter@beronet.com>

	* channels/misdn/isdn_lib.c, channels/misdn/isdn_lib.h,
	  channels/chan_misdn.c, /, channels/misdn/isdn_msg_parser.c:
	  Merged revisions 46350 via svnmerge from
	  https://origsvn.digium.com/svn/asterisk/branches/1.2 ........
	  r46350 | crichter | 2006-10-27 11:24:01 +0200 (Fr, 27 Okt 2006) |
	  1 line fixed a bug which caused chan_misdn to try to allocate 2
	  times the same channel on high load, which then caused
	  instability of mISDN. removed a useless function from isdn_lib.c
	  ........

	* channels/misdn_config.c: fixed not compile issue, which was just
	  introduced

	* channels/misdn_config.c, channels/chan_misdn.c, /,
	  channels/misdn/chan_misdn_config.h, configs/misdn.conf.sample:
	  Merged revisions 46176 via svnmerge from
	  https://origsvn.digium.com/svn/asterisk/branches/1.2 ........
	  r46176 | crichter | 2006-10-25 10:41:59 +0200 (Mi, 25 Okt 2006) |
	  1 line added nttimeout option to configure wether we disconnect
	  calls on NT timeouts or not during an overlapdial session
	  ........

2006-10-26 17:57 +0000 [r46335-46340]  Jason Parker <jparker@digium.com>

	* /, contrib/scripts/astgenkey.8: Merged revisions 46337 via
	  svnmerge from
	  https://origsvn.digium.com/svn/asterisk/branches/1.2 ........
	  r46337 | qwell | 2006-10-26 12:47:52 -0500 (Thu, 26 Oct 2006) | 2
	  lines oops - somebody forgot to change this - long ago, probably.
	  ........

	* CHANGES: grammar check

2006-10-26 16:38 +0000 [r46331]  Olle Johansson <oej@edvina.net>

	* CHANGES: Corrections to changes (Multiparking is not included)

2006-10-26 16:31 +0000 [r46329]  Russell Bryant <russell@digium.com>

	* main/translate.c: - If the source has no audio or no video
	  portion, do not call powerof() to get the format index. - Don't
	  run through the audio and video loops if there is no audio or
	  video portion of the source If 0 is passed to powerof, it will
	  return -1. This value of -1 was then being used as an array index
	  in these loops, which caused a crash on some systems. Other than
	  this issue, this code works as we expected it to. If a format is
	  not in the source, and we have to translation path to it, it is
	  not offered in the list of acceptable destination formats. (fixes
	  issue #8231)

2006-10-26 12:15 +0000 [r46317]  Kevin P. Fleming <kpfleming@digium.com>

	* CHANGES: update to reflect G.722 addition

2006-10-26 04:18 +0000 [r46298]  Russell Bryant <russell@digium.com>

	* doc/backtrace.txt: update backtrace documentation to reflect
	  changes in 1.4 (issue #8230, kshumard)

2006-10-26 01:37 +0000 [r46287]  Mark Spencer <markster@digium.com>

	* main/config.c, main/manager.c: Fix config comment code
	  preservation code (thanks murf!)

2006-10-25 20:14 +0000 [r46276]  Olle Johansson <oej@edvina.net>

	* channels/chan_sip.c: Old todo note - Don't add Contact header on
	  BYE and Cancel

2006-10-25 19:24 +0000 [r46253-46255]  Russell Bryant <russell@digium.com>

	* configure.ac: fix error output when checking for openh323 to
	  refer to openh323 instead of pwlib (issue #8222, misaksen)

2006-10-25 19:16 +0000 [r46252]  Olle Johansson <oej@edvina.net>

	* channels/chan_sip.c: Somewhat ugly code to try to fix issue
	  #7608. Since the problem was not very well defined, the fix is a
	  bit fuzzy too... Thanks to Luigi for accidentally spotting the
	  possible problem!

2006-10-25 19:08 +0000 [r46249]  Russell Bryant <russell@digium.com>

	* apps/app_queue.c: update warning message to include "agi" option
	  (issue #8225, jmls)

2006-10-25 18:13 +0000 [r46237-46248]  Kevin P. Fleming <kpfleming@digium.com>

	* sounds/Makefile: use 1.4.3 extra sounds with corrected silence
	  files

	* sounds/sounds.xml, sounds/Makefile: add support for prebuilt
	  G.722 prompts and music on hold files

2006-10-25 15:56 +0000 [r46214-46216]  Olle Johansson <oej@edvina.net>

	* channels/chan_sip.c: show settings doesn't produce a list of
	  similar objects, it should stay a "show"

2006-10-25 14:32 +0000 [r46200]  Kevin P. Fleming <kpfleming@digium.com>

	* main/cli.c, main/cdr.c, channels/chan_phone.c, pbx/pbx_spool.c,
	  channels/chan_features.c, pbx/pbx_ael.c, channels/chan_h323.c,
	  pbx/pbx_realtime.c, channels/chan_alsa.c, apps/app_sms.c,
	  main/image.c, channels/chan_nbs.c, apps/app_rpt.c, main/db.c,
	  cdr/cdr_custom.c, channels/chan_mgcp.c,
	  apps/app_parkandannounce.c, apps/app_voicemail.c,
	  channels/chan_sip.c, apps/app_softhangup.c, apps/app_record.c,
	  res/res_adsi.c, main/utils.c, apps/app_ices.c,
	  pbx/dundi-parser.c, channels/chan_iax2.c, apps/app_queue.c,
	  apps/app_getcpeid.c: apparently developers are still not aware
	  that they should be use ast_copy_string instead of strncpy... fix
	  up many more users, and fix some bugs in the process

2006-10-25 04:58 +0000 [r46165]  Tilghman Lesher <tilghman@mail.jeffandtilghman.com>

	* main/pbx.c: WaitExten truncates decimals of times to wait,
	  instead of accepting them (Bug 8208)

2006-10-25 00:26 +0000 [r46152-46154]  Kevin P. Fleming <kpfleming@digium.com>

	* main/rtp.c, main/frame.c, main/translate.c, formats/format_pcm.c,
	  channels/chan_h323.c, channels/chan_iax2.c,
	  include/asterisk/frame.h: add passthrough and file format support
	  for G.722 16KHz audio (issue #5084, original patch by andrew,
	  updated by mithraen)

	* channels/chan_sip.c, main/translate.c: code zone experiment:
	  don't offer formats in the outbound INVITE that aren't either
	  passthrough or translatable

	* main/translate.c: if multiple translators are registered for the
	  same source/dest combination, ensure that the lowest-cost one is
	  always inserted earlier in the list

2006-10-24 20:30 +0000 [r46142]  Mark Spencer <markster@digium.com>

	* res/res_agi.c: Fix FastAGI when there is no pid (bug #7628,
	  #8147)

2006-10-24 19:29 +0000 [r46130]  Joshua Colp <jcolp@digium.com>

	* channels/chan_iax2.c: We need to initialize our scheduler pthread
	  condition... yes.

2006-10-24 08:34 +0000 [r46114-46117]  Luigi Rizzo <rizzo@icir.org>

	* main/http.c: merge 45152 don't leak descriptors in http.c

	* channels/chan_sip.c: merge 45966 refer_to_domain potentially
	  containing options

	* channels/chan_sip.c: merge 46026 improper checks on get_header()
	  return values

	* channels/chan_sip.c: merge 46045 prevent NULL args to
	  ast_strdupa() in chan_sip.c

2006-10-24 05:23 +0000 [r46093]  Russell Bryant <russell@digium.com>

	* Makefile: Restore the ability to remove the firmware directory
	  without causing the installation to fail (issue #8111)

2006-10-24 03:53 +0000 [r46080-46083]  Kevin P. Fleming <kpfleming@digium.com>

	* main/translate.c: ensure that the translation matrix is properly
	  lock-protected every place it is used

	* include/asterisk/translate.h, main/translate.c: add an API call
	  to allow channel drivers to determine which media formats are
	  compatible (passthrough or transcode) with the format an existing
	  channel is already using

	* doc/imapstorage.txt: simplify and correct voicemail IMAP storage
	  build instructions

2006-10-24 03:01 +0000 [r46078]  Tilghman Lesher <tilghman@mail.jeffandtilghman.com>

	* main/channel.c: Pass through a frame if we don't know what it is,
	  rather than trying to pass a NULL, which will segfault a channel
	  driver (Bug 8149)

2006-10-24 01:27 +0000 [r45999-46067]  Russell Bryant <russell@digium.com>

	* utils/muted.c, utils/ael_main.c: In muted.c, check the return
	  value of strdup. In ael_main.c, check the return value of calloc.
	  (issue #8157) In passing fix a few minor bugs in ael_main.c. The
	  last argument to strncpy() was a hard-coded 100, where it should
	  have been 99. I changed this to use sizeof() - 1.

	* apps/app_meetme.c: Fix the descriptions of some of the
	  MeetMeAdmin options (issue #8098, mflorell)

	* res/res_jabber.c: don't crash when an incoming message has no
	  "from" (issue #8205, jmls)

2006-10-23 00:27 +0000 [r45928]  Joshua Colp <jcolp@digium.com>

	* /, cdr/cdr_odbc.c: Merged revisions 45927 via svnmerge from
	  https://origsvn.digium.com/svn/asterisk/branches/1.2 ........
	  r45927 | file | 2006-10-22 20:25:28 -0400 (Sun, 22 Oct 2006) | 2
	  lines Don't leak memory mmmk? ........

2006-10-22 21:44 +0000 [r45916]  Christian Richter <christian.richter@beronet.com>

	* channels/chan_misdn.c, /: Merged revisions 45808 via svnmerge
	  from https://origsvn.digium.com/svn/asterisk/branches/1.2
	  ........ r45808 | crichter | 2006-10-21 14:35:13 +0200 (Sat, 21
	  Oct 2006) | 1 line fixed issue, that if chan_misdn is loaded and
	  couldn't be initialized it would cause a segfault after 'reload'.
	  Reported by Drew/Matt thx. ........

2006-10-21 18:49 +0000 [r45818]  Russell Bryant <russell@digium.com>

	* res/res_monitor.c: Add a couple missing unregistrations of
	  manager actions and remove duplicate unregistrations of
	  applications. (issue #8194, jmls)

2006-10-21 18:48 +0000 [r45775-45817]  Joshua Colp <jcolp@digium.com>

	* main/loader.c: Don't use promotion on Darwin because it doesn't
	  seem to work quite right in all cases, this should solve the
	  unresolved symbol issue people have been seeing.

	* Makefile: Pass DESTDIR and ASTSBINDIR so that the utilities get
	  installed in the proper location (reported on asterisk-dev
	  mailing list)

2006-10-20 07:44 +0000 [r45741]  Olle Johansson <oej@edvina.net>

	* channels/chan_sip.c: Let's understand SIP: - REFER can create
	  dialog, Asterisk does not support it yet - NOTIFY can create
	  dialog in Asterisk's implementation (voicemail) even though we
	  don't support the server side of it. In this case, the standard
	  is a side issue ;-) - Added extened functionality for unsupported
	  methods (PING, PUBLISH) so we don't create PVT's for those
	  either. Russellb needs to judge what to do with this in 1.2, but
	  I think the current implementation n 1.2 is a bug since we're
	  sending bad replies to NOTIFY and REFER outside of dialogs

2006-10-19 17:24 +0000 [r45678-45694]  Joshua Colp <jcolp@digium.com>

	* res/res_jabber.c: Let's remember to unregister JabberStatus too
	  (issue #8184 reported by jmls)

	* /, apps/app_externalivr.c: Merged revisions 45691 via svnmerge
	  from https://origsvn.digium.com/svn/asterisk/branches/1.2
	  ........ r45691 | file | 2006-10-19 13:16:37 -0400 (Thu, 19 Oct
	  2006) | 2 lines Respect language selection when seeing if the
	  file exists (issue #8178 reported by mnicholson) ........

	* channels/chan_sip.c: If the jitterbuffer is forced on then we
	  can't partially bridge (reported by wangster on #asterisk-dev)

2006-10-19 00:59 +0000 [r45622]  Russell Bryant <russell@digium.com>

	* channels/chan_sip.c: Don't leak the actual thread-specific
	  sip_pvt struct

2006-10-18 23:49 +0000 [r45621]  Kevin P. Fleming <kpfleming@digium.com>

	* channels/chan_sip.c: don't leak memory when a chan_sip thread is
	  destroyed that has a thread-local temp_pvt allocated

2006-10-18 21:03 +0000 [r45595]  Joshua Colp <jcolp@digium.com>

	* main/asterisk.c: Don't modify things if we are using vfork as
	  this is very bad and may cause unexpected behavior (issue #7970
	  reported by Nick Gavrikov)

2006-10-18 11:54 +0000 [r45517]  Olle Johansson <oej@edvina.net>

	* channels/chan_sip.c: remove duplicate declarations

2006-10-18 04:09 +0000 [r45464]  Luigi Rizzo <rizzo@icir.org>

	* main/http.c: merge from trunk: move ast_variables_destroy() to a
	  better place in handle_uri() to avoid leaking memory on non
	  existing files.

2006-10-18 03:02 +0000 [r45452]  Joshua Colp <jcolp@digium.com>

	* main/rtp.c: Don't segfault if you're using a channel driver that
	  doesn't turn RTCP on

2006-10-18 02:41 +0000 [r45439-45441]  Russell Bryant <russell@digium.com>

	* main/channel.c: Don't attempt to access private data members of
	  the pthread_mutex_t object, because this does not work on all
	  linux systems. Instead, just access the reentrancy field in the
	  ast_mutex_info struct when DEBUG_THREADS is enabled. If
	  DEBUG_CHANNEL_LOCKS is enabled, the developer probably has
	  DEBUG_THREADS on as well. (issue #8139, me)

	* configs/sip_notify.conf.sample: update entry to reboot a snom
	  phone (issue #7850, pnlarsson)

2006-10-17  Kevin P. Fleming  <kpfleming@digium.com>

	* Asterisk 1.4.0-beta3 released.

2006-10-17 22:31 +0000 [r45408-45410]  Kevin P. Fleming <kpfleming@digium.com>

	* include/asterisk/stringfields.h, main/ast_expr2.c,
	  main/channel.c, channels/chan_sip.c, channels/chan_iax2.c:
	  optimize the 'quick response' code a bit more... no more malloc()
	  or memset() for each response expand stringfields API a bit to
	  allow reusing the stringfield pool on a structure when needed,
	  and remove some unnecessary code when the structure was being
	  freed

2006-10-17 20:38 +0000 [r45378-45381]  Joshua Colp <jcolp@digium.com>

	* channels/chan_sip.c: Don't create a "real" pvt structure for
	  requests that shouldn't be able to create one. Instead use a
	  temporary pvt and fill it with enough information so we can send
	  a reply.

2006-10-17 17:39 +0000 [r45329]  Olle Johansson <oej@edvina.net>

	* configs/sip.conf.sample: Adding information about Marks
	  direct-RTP hack to the docs...

2006-10-17 17:22 +0000 [r45327]  Kevin P. Fleming <kpfleming@digium.com>

	* LICENSE: provide licensing language for IAXy firmware file

2006-10-16 20:06 +0000 [r45246-45280]  Joshua Colp <jcolp@digium.com>

	* apps/app_dial.c, apps/app_directed_pickup.c: Backport of new
	  directed pickup (BE-85).

2006-10-16 13:59 +0000 [r45196-45213]  Olle Johansson <oej@edvina.net>

	* CREDITS: Adding Inotel to credits for SIP transfers. Thanks for
	  your support!

	* channels/chan_sip.c: Don't destroy dialog for unexpected REFER
	  response...

2006-10-14 04:38 +0000 [r45143]  Steve Murphy <murf@digium.com>

	* funcs/func_rand.c: update the doc string for both AEL and
	  extensions.conf users.

2006-10-13 23:02 +0000 [r45125]  Kevin P. Fleming <kpfleming@digium.com>

	* main/acl.c don't drop the entire permit/deny list when an attempt
	  is made to add an invalid entry (BE-92)

2006-10-13 21:06 +0000 [r45104-45106]  Joshua Colp <jcolp@digium.com>

	* res/res_speech.c: Clear the quiet flag too since we are
	  restarting a recognition again (reported on -dev by Stephan
	  Edelman)

	* res/res_speech.c: Check return value from engine in case of
	  failure (ie: out of licenses) (reported on -dev mailing list)

2006-10-13 20:52 +0000 [r45103]  Steve Murphy <murf@digium.com>

	* pbx/ael/ael-test/ref.ael-vtest17 (added),
	  pbx/ael/ael-test/ael-vtest17/extensions.ael (added),
	  pbx/ael/ael-test/ael-vtest17 (added),
	  pbx/ael/ael-test/ref.ael-test3, pbx/pbx_ael.c: Bug 8128 fixed in
	  this release via these changes

2006-10-13 19:19 +0000 [r45088]  Christian Richter <christian.richter@beronet.com>

	* channels/chan_misdn.c: avoiding warning, fixing potential bug

2006-10-13 18:42 +0000 [r45051-45079]  Joshua Colp <jcolp@digium.com>

	* codecs/lpc10/placev.c, codecs/lpc10/irc2pc.c,
	  codecs/lpc10/decode.c, codecs/lpc10/dcbias.c,
	  codecs/lpc10/pitsyn.c, codecs/lpc10/voicin.c,
	  codecs/lpc10/difmag.c, codecs/lpc10/hp100.c,
	  codecs/lpc10/synths.c, codecs/lpc10/preemp.c,
	  codecs/lpc10/rcchk.c, codecs/lpc10/lpfilt.c,
	  codecs/lpc10/mload.c, codecs/lpc10/lpcenc.c,
	  codecs/lpc10/vparms.c, codecs/lpc10/dyptrk.c,
	  codecs/lpc10/lpcini.c, codecs/lpc10/random.c,
	  codecs/lpc10/ham84.c, codecs/lpc10/chanwr.c,
	  codecs/lpc10/placea.c, codecs/lpc10/tbdm.c,
	  codecs/lpc10/analys.c, codecs/lpc10/onset.c,
	  codecs/lpc10/energy.c, codecs/lpc10/deemp.c,
	  codecs/lpc10/lpcdec.c, codecs/lpc10/ivfilt.c,
	  codecs/lpc10/median.c, codecs/lpc10/encode.c,
	  codecs/lpc10/bsynz.c, codecs/lpc10/prepro.c,
	  codecs/lpc10/invert.c: And file said... let the compiler warnings
	  STOP!

	* apps/app_chanspy.c: Turn on volume adjustment if it needs to be on (issue #8136
	  reported by mnicholson)

	* apps/app_playback.c: Move say.conf existence check to do_say
	  function since it is called from multiple places (issue #8144
	  reported by kshumard)

2006-10-13 16:19 +0000 [r45049]  Kevin P. Fleming <kpfleming@digium.com>

	* channels/chan_iax2.c: when sending a call to a peer, use the proper socket if
	  we have multiple bindings (reported on asterisk-dev)

2006-10-13 16:01 +0000 [r45031-45040]  Joshua Colp <jcolp@digium.com>

	* channels/chan_sip.c: Complete merging in RPID screen changes
	  (issue #8101 reported by hristo, patch by oej in revision 44757)

	* main/dnsmgr.c: Pass the right value to usleep for sleeping, and always add
	  the background refresh item back into the scheduler if enabled
	  since it is deleted during reload. (issue #8142 reported by
	  p_lindheimer)

2006-10-13 15:41 +0000 [r45027]  Kevin P. Fleming <kpfleming@digium.com>

	* configure, include/asterisk/autoconfig.h.in, configure.ac,
	  main/utils.c: use a configure script test for PMTU discovery
	  control instead of just assuming it's available on Linux

2006-10-13 14:45 +0000 [r44994-45026]  Christian Richter <christian.richter@beronet.com>

	* channels/misdn/isdn_lib.c, channels/chan_misdn.c: fixed some
	  echocandisable issues when bridged. this caused a kernel panic
	  sometimes.. also some minor formatting fixes

	* channels/misdn/isdn_msg_parser.c: fixed issue that the hangupcause
	  got a wrong isdn cause at RELEASE_COMPLETE

2006-10-12 22:07 +0000 [r44992]  Luigi Rizzo <rizzo@icir.org>

	* channels/chan_sip.c: merge formatting and minor code
	  simplifications from trunk

2006-10-12 20:34 +0000 [r44982]  Matt O'Gorman <mogorman@digium.com>

	* channels/chan_gtalk.c: fix for bug 7764.

2006-10-12 19:14 +0000 [r44956-44971]  Kevin P. Fleming <kpfleming@digium.com>

	* channels/chan_sip.c: we can only send one 'a=ptime' attribute per
	  media session, not one for each format

	* main/netsock.c, include/asterisk/utils.h, channels/chan_sip.c,
	  main/utils.c: ensure that IAX2 and SIP sockets allow UDP
	  fragmentation when running on Linux (thanks to Brian Candler on
	  the asterisk-dev list for the tip)

2006-10-12 16:56 +0000 [r44945]  Russell Bryant <russell@digium.com>

	* main/manager.c: fix a silly typo in a comment that I saw while
	  reading the commit list

2006-10-12 16:08 +0000 [r44942]  Joshua Colp <jcolp@digium.com>

	* Makefile: Pass off AUDIO_LIBS so muted can link on OSX (issue
	  #8135 reported by ssokol)

2006-10-12 12:55 +0000 [r44921]  Nadi Sarrar <ns@beronet.com>

	* main/manager.c: append_event must be called while holding the
	  session lock

2006-10-12 10:24 +0000 [r44911]  Russell Bryant <russell@digium.com>

	* res/res_jabber.c: change some debug output to use LOG_DEBUG
	  instead of verbose output

2006-10-11 16:57 +0000 [r44888]  Jason Parker <jparker@digium.com>

	* main/db1-ast/Makefile: These are already set by the parent
	  Makefile.. There is no need to have this here (it doesn't
	  actually work anyways).

2006-10-11 09:18 +0000 [r44854]  Christian Richter <christian.richter@beronet.com>

	* channels/misdn/isdn_lib.c: removed warning because of missing
	  prototype declaration

2006-10-10 19:23 +0000 [r44830]  Olle Johansson <oej@edvina.net>

	* channels/chan_sip.c: Do not set default/global values in the
	  variable declaration, set it in reload_config()

2006-10-10 17:21 +0000 [r44819]  Joshua Colp <jcolp@digium.com>

	* channels/chan_sip.c: Move some stuff around so that a NOTIFY
	  dialog won't hang around until the end of the world under certain
	  circumstances

2006-10-10 16:44 +0000 [r44809]  Paul Cadach <paul@odt.east.telecom.kz>

	* main/channel.c, funcs/func_channel.c, include/asterisk/channel.h:
	  CHANNEL() function sometime mix parameter and value

2006-10-10 16:42 +0000 [r44808]  Tilghman Lesher <tilghman@mail.jeffandtilghman.com>

	* funcs/func_logic.c: Lost of a bit of logic when this was
	  simplified between 1.2 and 1.4 (Bug 8117)

2006-10-10 16:30 +0000 [r44806]  Joshua Colp <jcolp@digium.com>

	* channels/chan_sip.c: Bail out if we have no refer structure and
	  we get a refer response

2006-10-10 16:21 +0000 [r44805]  Luigi Rizzo <rizzo@icir.org>

	* channels/chan_sip.c: more merge from trunk (comments and change a
	  static function name)

2006-10-10 15:23 +0000 [r44788]  Joshua Colp <jcolp@digium.com>

	* channels/chan_sip.c: Only set DTMF information if an RTP
	  structure exists

2006-10-10 13:50 +0000 [r44786]  Christian Richter <christian.richter@beronet.com>

	* channels/misdn/isdn_lib.c, channels/chan_misdn.c: (re)added
	  support of dynamically enabling hdlc on bchannels

2006-10-10 08:25 +0000 [r44776-44777]  Luigi Rizzo <rizzo@icir.org>

	* channels/chan_sip.c: whitespace changes related to previous
	  commit

	* channels/chan_sip.c: merge a few code simplifications that have
	  gone into trunk during last week, to reduce differences between
	  the two branches and make porting fixes easier.

2006-10-09 16:12 +0000 [r44764]  Jason Parker <jparker@digium.com>

	* channels/chan_skinny.c: Fix a problem where phones that go
	  "missing" never got unregistered. Issue #8067, reported by pj,
	  patch by Anthony LaMantia (with minor whitespace modifications)

2006-10-09 15:46 +0000 [r44759-44760]  Joshua Colp <jcolp@digium.com>

	* channels/chan_iax2.c: iaxs[callno] may go away if we try to avoid
	  the deadlock

	* channels/chan_iax2.c: Properly avoid a collision with iax2_hangup
	  (issue #8115 reported by vazir)

2006-10-08 14:14 +0000 [r44746]  Luigi Rizzo <rizzo@icir.org>

	* channels/chan_sip.c: do not dereference p if we
	  know it is NULL

2006-10-07 14:39 +0000 [r44684]  Paul Cadach <paul@odt.east.telecom.kz>

	* channels/h323/ast_h323.cxx, channels/chan_h323.c,
	  channels/h323/ast_h323.h, channels/h323/chan_h323.h: Propagate
	  caller's transfer capability too

2006-10-07 11:37 +0000 [r44650-44665]  Luigi Rizzo <rizzo@icir.org>

	* channels/chan_sip.c: put common code in a
	  function to avoid repetitions.

	* channels/chan_sip.c: remove hardwired usage of 5060, use
	  DEFAULT_SIP_PORT instead

	* channels/chan_sip.c: option_debug checking
	  before printing to debug channel.

	* channels/chan_sip.c: backport simplifications on sip_register,
	  usage of ast_set2_flag(), and fixes to the handling of failed
	  module loading.

	* channels/chan_sip.c: improve and document function
	  get_in_brackets(), introducing a helper function
	  find_closing_quote() of more general use.

2006-10-06 21:28 +0000 [r44629-44631]  Kevin P. Fleming <kpfleming@digium.com>

	* include/asterisk/linkedlists.h: ensure that mutex locks inside
	  list heads are initialized properly on platforms that require
	  constructor initialization (issue #8029, patch from timrobbins)

	* CHANGES: remove Jingle as per mog

2006-10-06 21:08 +0000 [r44628]  Joshua Colp <jcolp@digium.com>

	* main/rtp.c: Remove the seqno check for RFC2833, the handler is
	  smart enough to not need it.

2006-10-06 21:07 +0000 [r44627]  Kevin P. Fleming <kpfleming@digium.com>

	* CHANGES: various cleanups

2006-10-06 18:46 +0000 [r44581-44605]  Joshua Colp <jcolp@digium.com>

	* main/rtp.c: When the sequence number rolls over then reset the
	  recorded sequence number for DTMF (issue #8106 reported by
	  bungalow)

	* main/file.c: Even more frames to treat as though the remote side
	  disappeared (issue #8097 reported by eldadran)

2006-10-06 15:59 +0000 [r44567]  Luigi Rizzo <rizzo@icir.org>

	* main/manager.c, main/http.c: make sure sockets are blocking when
	  they should be blocking.

2006-10-06 12:53 +0000 [r44559-44563]  Christian Richter <christian.richter@beronet.com>

	* channels/chan_misdn.c: fixed segfault which happens during
	  hold/transfer action

	* channels/chan_misdn.c: if INFORMATION Message come with keypad
	  instead of called party number, we just use the keypad as called
	  party number.

	* channels/misdn/isdn_lib.c, channels/misdn_config.c,
	  channels/misdn/isdn_lib.h, channels/chan_misdn.c,
	  channels/misdn/chan_misdn_config.h, configs/misdn.conf.sample:
	  added the option 'reject_cause' to make it possible to set
	  the RELEASE_COMPLETE - cause on the 3. incoming PMP channel,
	  which is automatically rejected because chan_misdn does not
	  support that kind of callwaiting. Therefore chan_misdn supports
	  now 3 incoming channels on a PMP BRI Port. misdn_lib_get_free_bc
	  now gets the info if the requested channel is incoming or
	  outgoing to make the 3. channel possible

	* channels/misdn/isdn_lib.c, channels/misdn/isdn_lib.h,
	  channels/chan_misdn.c: fixed the hold/retrieve/transfer issues,
	  removed a useless bc field, added setting of frame.delivery fields,
	  some minor code cleanups

2006-10-05 19:57 +0000 [r44502]  Joshua Colp <jcolp@digium.com>

	* main/file.c: Treat busy control frames as hangup in the file streaming
	  core (issue #8097 reported by eldadran)

2006-10-05 18:21 +0000 [r44488]  Steve Murphy <murf@digium.com>

	* pbx/pbx_ael.c: This mod fixes a problem pointed out by dgarstang.
	  Many thanks to Doug!

2006-10-05 18:01 +0000 [r44486]  Joshua Colp <jcolp@digium.com>

	* channels/chan_sip.c: One more T.38 fix! Don't leave a reinvite
	  hanging by a thread if the other side is already setup with T.38

2006-10-05 16:10 +0000 [r44476]  Kevin P. Fleming <kpfleming@digium.com>

	* main/app.c: don't segfault when an argument without a close
	  parenthesis is found stop parsing as soon as that situation
	  occurs

2006-10-05 15:22 +0000 [r44465-44466]  Steve Murphy <murf@digium.com>

	* CHANGES: I put the accumulated changes from the commit logs and
	  inspection, into CHANGES. Hope everyone approves!

	* configs/muted.conf.sample, utils/muted.c: Hang on a minute, the
	  install process sticks muted.conf in /etc/asterisk, so that's
	  where muted should look for it, right?

2006-10-05 02:40 +0000 [r44450]  Joshua Colp <jcolp@digium.com>

	* channels/chan_sip.c: Don't totally bail out if T.38 was
	  negotiated

2006-10-05 01:42 +0000 [r44433-44436]  Kevin P. Fleming <kpfleming@digium.com>

	* channels/chan_sip.c: fix Polycom presence notification again

2006-10-04 22:52 +0000 [r44407-44409]  Luigi Rizzo <rizzo@icir.org>

	* utils/Makefile: as far as i can tell astman only uses newt...

	* Makefile: put linker flags in ASTLDFLAGS where they belong

2006-10-04 21:17 +0000 [r44390-44393]  Kevin P. Fleming <kpfleming@digium.com>

	* channels/chan_sip.c: remove workaround for old Polycom firmware SUBSCRIBE
	  requests add workaround for new Polycom firmware SUBSCRIBE
	  requests (bug is known to exist in 2.0.1 firmware)

	* include/asterisk.h, main/utils.c: make LOW_MEMORY builds actually
	  work

2006-10-04 19:57 +0000 [r44380]  Steve Murphy <murf@digium.com>

	* pbx/ael/ael-test/ref.ael-ntest10, pbx/ael/ael.tab.c,
	  pbx/ael/ael-test/ref.ael-test1, pbx/ael/ael-test/ref.ael-ntest12,
	  pbx/ael/ael-test/ref.ael-test2, pbx/ael/ael-test/ref.ael-test3,
	  pbx/pbx_ael.c, pbx/ael/ael-test/ref.ael-test4,
	  pbx/ael/ael-test/ref.ael-test5, pbx/ael/ael-test/ref.ael-test6,
	  pbx/ael/ael-test/ref.ael-test7, pbx/ael/ael-test/ref.ael-test8,
	  pbx/ael/ael-test/ael-test16/extensions.ael (added),
	  pbx/ael/ael-test/ael-test16 (added), pbx/ael/ael.y,
	  pbx/ael/ael-test/ref.ael-test11, pbx/ael/ael-test/ref.ael-test14,
	  pbx/ael/ael-test/ref.ael-test15, pbx/ael/ael-test/ref.ael-ntest9,
	  pbx/ael/ael-test/ref.ael-test16 (added): These changes fix the
	  problems reported in bug 8090

2006-10-04 19:47 +0000 [r44378]  Kevin P. Fleming <kpfleming@digium.com>

	* channels/chan_oss.c, main/cdr.c, channels/chan_phone.c,
	  main/manager.c, pbx/pbx_spool.c, res/res_smdi.c,
	  channels/chan_skinny.c, channels/chan_h323.c, main/http.c,
	  channels/chan_alsa.c, pbx/pbx_dundi.c, apps/app_mixmonitor.c,
	  main/asterisk.c, channels/chan_mgcp.c, main/autoservice.c,
	  include/asterisk/utils.h, main/dnsmgr.c, channels/chan_zap.c,
	  channels/chan_sip.c, apps/app_meetme.c, res/res_snmp.c,
	  main/devicestate.c, main/utils.c, res/res_musiconhold.c,
	  channels/chan_iax2.c, apps/app_queue.c, res/res_jabber.c: update
	  thread creation code a bit reduce standard thread stack size
	  slightly to allow the pthreads library to allocate the stack+data
	  and not overflow a power-of-2 allocation in the kernel and waste
	  memory/address space add a new stack size for 'background'
	  threads (those that don't handle PBX calls) when LOW_MEMORY is
	  defined

2006-10-04 17:04 +0000 [r44337-44365]  Steve Murphy <murf@digium.com>

	* configs/muted.conf.sample: I've been meaning to add some
	  explanation about muted... here it is

	* configs/manager.conf.sample: CLI reverbification update to this
	  config file

	* apps/app_macro.c: In response to bug 7776, a Warning has been
	  added to the doc string for Macro().

2006-10-04 00:25 +0000 [r44322]  Kevin P. Fleming <kpfleming@digium.com>

	* main/asterisk.c, main/loader.c, main/term.c, Makefile,
	  include/asterisk.h: ensure that local include files are always
	  used avoid a duplicate function name (term_init())

2006-10-03 22:35 +0000 [r44312]  Matt O'Gorman <mogorman@digium.com>

	* channels/chan_gtalk.c, res/res_jabber.c: fix issue with dialing
	  client without resource.

2006-10-03 20:18 +0000 [r44298]  Kevin P. Fleming <kpfleming@digium.com>

	* apps/app_queue.c: fix a logic error in my previous fix to the queue
	  reload code

2006-10-03 18:42 +0000 [r44286]  Paul Cadach <paul@odt.east.telecom.kz>

	* channels/h323/ast_h323.cxx: Change default presentation indicator
	  to "user provided not screened" if octet 3a missed in
	  CallingPartyNumber IE

2006-10-03 18:35 +0000 [r44284]  Joshua Colp <jcolp@digium.com>

	* channels/chan_sip.c: Use VideoSupport instead so it is considered
	  a valid XML attribute name. (issue #8075 reported by renemendoza)

2006-10-03 18:30 +0000 [r44283]  Paul Cadach <paul@odt.east.telecom.kz>

	* channels/h323/ast_h323.cxx: Fix preparation of type and
	  presentation of calling number

2006-10-03 00:01 +0000 [r44240]  Matt O'Gorman <mogorman@digium.com>

	* doc/jingle.txt, channels/chan_jingle.c (removed),
	  include/asterisk/jabber.h, configs/jingle.conf.sample (removed),
	  res/res_jabber.c: updated res_jabber for even better component
	  support, soon will be jep-0100 compliant. also removed
	  chan_jingle and infromed info from jingle.txt, chan_gtalk still
	  works and should be used in this version.

2006-10-02 20:11 +0000 [r44199-44215]  Joshua Colp <jcolp@digium.com>

	* channels/chan_sip.c: Change the fd on the I/O context in case it
	  changed during the reload, which is indeed possible. (issue #7943
	  reported by eclubb)

	* contrib/init.d/rc.redhat.asterisk: We should be using $AST_SBIN
	  instead of hardcoding the path for the error message (issue #7942
	  reported by eclubb)

2006-10-02 18:52 +0000 [r44186]  Paul Cadach <paul@odt.east.telecom.kz>

	* configs/users.conf.sample, pbx/pbx_config.c: Missed part of
	  userconf functionality for chan_h323

2006-10-02 17:25 +0000 [r44169]  Joshua Colp <jcolp@digium.com>

	* main/io.c: Shrink when current_ioc is unused. It is set to -1 when
	  unused, not 0. (issue #7941 reported by eclubb)

2006-10-02 17:16 +0000 [r44166-44167]  Paul Cadach <paul@odt.east.telecom.kz>

	* doc/realtime.txt: Typo fix

	* channels/chan_h323.c: Optimization of oh323_indicate(): less
	  locks - less problems, plus single exit point

2006-10-02 02:38 +0000 [r44146]  Mark Spencer <markster@digium.com>

	* channels/chan_sip.c, channels/chan_iax2.c: Don't use Channel when
	  you're not talking about a channel :)

2006-10-01 19:32 +0000 [r44135]  Paul Cadach <paul@odt.east.telecom.kz>

	* channels/chan_h323.c: Do not simulate any audio tones if we got
	  PROGRESS message

2006-10-01 18:30 +0000 [r44111-44125]  Russell Bryant <russell@digium.com>

	* Makefile: Fix a problem that cuased AST_DATA_DIR in defaults.h to
	  be empty. The cause is that since ASTDATADIR is explicitly
	  exported using "export ASTDATADIR" at the top of the Makefile,
	  make no longer considers the variable "undefined", so the
	  Makefile can't use ?= to set ASTDATADIR if not yet set. (issue
	  #8063, reported by akohlsmith, fixed by me)

	* configs/queues.conf.sample: Fix the name of the "eventmemberstatus"
	  option in the sample queues.conf (issue #8065, adamg)

2006-10-01 15:01 +0000 [r44109]  Luigi Rizzo <rizzo@icir.org>

	* channels/chan_sip.c: sync with trunk - move variable declarations
	  to the beginning of a block.

2006-09-30 19:20 +0000 [r44090]  Paul Cadach <paul@odt.east.telecom.kz>

	* main/rtp.c: Allow one-way RTP streams (device->Asterisk)

2006-09-30 16:28 +0000 [r44080]  Luigi Rizzo <rizzo@icir.org>

	* codecs/lpc10/Makefile, Makefile, main/Makefile: fix two recent
	  build problems: - with AST_DEVMODE, building codecs/lpc10 fails
	  because of lots of warnings, and the configure step in editline
	  fails as well. Fix this by removing the -Werror in these steps. -
	  on FreeBSD (but probably on other platforms as well), the final
	  link of asterisk fails because AST_LIBS was not exported to the
	  subdirs Makefiles. Add a proper fix in the top-level Makefile (a
	  possible alternative way is to add "export AST_LIBS" near the
	  beginning of the file). With this fix, i believe that some of the
	  platform-specific conditionals in main/Makefile are redundant
	  (because they should be already dealt with in the top level
	  Makefile) but i don't have a platform to check. Merging to head
	  will happen in a moment.

2006-09-30 16:12 +0000 [r44068-44078]  Paul Cadach <paul@odt.east.telecom.kz>

	* channels/chan_sip.c: Fix issue #7928 correctly. Next is a comment
	  of previous fix: Issue #7928 - Don't send both 404 and 503. Fix
	  by phsultan with a small fix by me, myself or I. Thanks,
	  Philippe! (This was caused by my changes to the transaction
	  handling)

	* channels/chan_sip.c: Found some buggy SIP clients (phones Planet
	  VIP-153T firmware 1.0, Linksys PAP2 firmware 3.1.9(LSc)) which
	  sends ACK not on OK message only (when remote party answers) but
	  on RINGING message too, so when we send 200 OK message, we get
	  unidentified ACK message (because INVITE acknowledged on RINGING
	  message already), so 200 OK retransmits within its retransmission
	  interval then call gets dropped. If someone else knows how to
	  provide workaround for such cases, please, fix it in correct way.
	  Thanks to ssh from #asteriskru for provide access to his box to
	  study and fix this case.

2006-09-29 22:51 +0000 [r44055-44057]  Kevin P. Fleming <kpfleming@digium.com>

	* agi, utils: ignore temporary files made by the Makefiles during a
	  build

	* codecs/lpc10/Makefile, main/db1-ast/Makefile, agi/Makefile,
	  codecs/Makefile, utils/Makefile, configure,
	  build_tools/embed_modules.xml, codecs/gsm/Makefile, configure.ac,
	  Makefile.moddir_rules, Makefile.rules, codecs/ilbc/Makefile,
	  pbx/Makefile, res/Makefile, channels/Makefile: fix a few build
	  system bugs, and convert Makefiles to be compatible with GNU make
	  3.80

2006-09-29 22:35 +0000 [r44053]  Jason Parker <jparker@digium.com>

	* main/asterisk.c, main/cli.c: Fix a bug with the removal of
	  'atleast' argument to 'core verbose' and 'core debug'. Add that
	  argument back in.

2006-09-29 21:09 +0000 [r44022-44043]  Paul Cadach <paul@odt.east.telecom.kz>

	* channels/h323/ast_h323.cxx: Set TON/PRESENTATION information more
	  carefully when no CallingNumber IE available

	* channels/h323/ast_h323.cxx: Fake display name by called number on
	  incoming calls (until passing connected number/connected name is
	  not implemented)

	* channels/h323/ast_h323.cxx: Ported code refers to H.450 - add
	  includes

	* channels/h323/ast_h323.cxx, channels/h323/ast_h323.h: Properly
	  pass TON/PRESENTATION information - original
	  H323Connection::SendSignalSetup() destroys Q.931 fields.

2006-09-29 18:49 +0000 [r44011-44012]  Kevin P. Fleming <kpfleming@digium.com>

	* main/Makefile: yet another place where we were not using the
	  correct CFLAGS by default

	* main/Makefile: missed one conversion to ASTCFLAGS

2006-09-29 18:30 +0000 [r44009]  Paul Cadach <paul@odt.east.telecom.kz>

	* channels/h323/ast_h323.cxx, channels/chan_h323.c,
	  channels/h323/ast_h323.h, channels/h323/chan_h323.h: Pass
	  TON/PRESENTATION information too

2006-09-29 18:25 +0000 [r43952-44008]  Kevin P. Fleming <kpfleming@digium.com>

	* main/db1-ast/Makefile, Makefile, codecs/Makefile, utils/Makefile,
	  main/Makefile, codecs/gsm/Makefile, Makefile.moddir_rules,
	  Makefile.rules, pbx/Makefile, channels/Makefile: don't abuse
	  CFLAGS and LDFLAGS for build of Asterisk components, because they
	  are also then used for non-Asterisk components (like menuselect);
	  use our own variables instead

	* configure, configure.ac: support --without-curl in configure
	  script

	* Makefile.rules: another cross-compile fix

	* Makefile: a couple more environment settings that can't leak into
	  the menuselect build

	* main/cli.c: proper fix for ast_group_t change

	* include/asterisk/lock.h: eliminate compiler warning when
	  DEBUG_CHANNEL_LOCKS is enabled and users of this header file
	  don't also include channel.h

2006-09-28 20:11 +0000 [r43944]  Jason Parker <jparker@digium.com>

	* apps/app_queue.c: Fix incorrect argument order for member names,
	  on persisted members. Issue 8047, patch by jmls.

2006-09-28 18:05 +0000 [r43932-43933]  Joshua Colp <jcolp@digium.com>

	* apps/app_playback.c, res/res_monitor.c,
	  include/asterisk/logger.h, channels/chan_misdn.c, res/res_smdi.c,
	  channels/chan_skinny.c, apps/app_rpt.c, channels/chan_mgcp.c,
	  main/udptl.c, main/frame.c, funcs/func_timeout.c,
	  channels/chan_sip.c, apps/app_festival.c,
	  channels/iax2-provision.c, apps/app_alarmreceiver.c,
	  res/res_musiconhold.c, apps/app_followme.c, channels/chan_iax2.c:
	  Put in missing \ns on the end of ast_logs (issue #7936 reported
	  by wojtekka)

2006-09-28 17:35 +0000 [r43919]  Kevin P. Fleming <kpfleming@digium.com>

	* apps/app_queue.c: fix buggy (and overly complex) loop used during reload
	  of app_queue for static member list updating

2006-09-28 17:34 +0000 [r43918]  Paul Cadach <paul@odt.east.telecom.kz>

	* channels/h323/ast_h323.cxx: Extend call establishment timeout

2006-09-28 17:31 +0000 [r43913-43915]  Joshua Colp <jcolp@digium.com>

	* channels/chan_iax2.c: Make sure the pvt exists before accessing
	  it again as it may have gone away (issue #7562 reported by Seb7
	  and issue #7939 reported by sorg)

	* main/cli.c: Warning be gone!

2006-09-28 16:41 +0000 [r43899]  BJ Weschke <bweschke@btwtech.com>

	* apps/app_queue.c: app_queue is comparing the device names incorrectly
	  while checking their statuses. It's internal list of interfaces
	  includes the dial string, while the argument passed to this
	  function does not have the dial string (/n for a local channel).
	  This causes it to ignore the device state changes because it
	  thinks it belongs to none of its members. (#8040 reported and
	  patch by tim_ringenbach)

2006-09-28 16:17 +0000 [r43893]  Joshua Colp <jcolp@digium.com>

	*  apps/app_meetme.c: Stop the stream after waitstream returns so that our
	  formats get restored. (issue #7370 reported by kryptolus)

2006-09-28 15:56 +0000 [r43877]  Paul Cadach <paul@odt.east.telecom.kz>

	* channels/h323/ast_h323.cxx: Fix compiler warning

2006-09-28 15:29 +0000 [r43864-43873]  BJ Weschke <bweschke@btwtech.com>

	* apps/app_queue.c: Fix race conditioon crash with get_member_status (#7864 -
	  tim_ringenbach reported and patched)

	* apps/app_queue.c: Autopause not working for queue members. (#8042
	  - jmls reported and patch)

2006-09-28 12:58 +0000 [r43861-43862]  Paul Cadach <paul@odt.east.telecom.kz>

	* channels/h323/ast_h323.cxx, channels/h323/ast_h323.h: Force
	  remote side to start media on outgoing PROGRESS message

	* include/asterisk/compiler.h: Put attribute tag at correct place

2006-09-28 11:03 +0000 [r43852]  Christian Richter <christian.richter@beronet.com>

	* channels/misdn/isdn_lib.c, channels/misdn/isdn_lib.h,
	  channels/chan_misdn.c: fixed a bug which led to chan_list zombies,
	  when the call could not be properly established in misdn_call.
	  also removed the ACK_HDLC stuff which is not really needed.

2006-09-28 10:51 +0000 [r43843-43846]  Paul Cadach <paul@odt.east.telecom.kz>

	* channels/h323/ast_h323.cxx: Do not open transmit channel until
	  TCS is received

	* main/file.c: Don't warn on HOLD/UNHOLD control frames

	* main/file.c: Don't treat unknown control frames as voice

2006-09-27 20:21 +0000 [r43816]  Tilghman Lesher <tilghman@mail.jeffandtilghman.com>

	* apps/app_voicemail.c: Avoid inability to lock directory log message by
	  creating the directory ahead of time. (Issue 7631)

2006-09-27 19:44 +0000 [r43801-43803]  Jason Parker <jparker@digium.com>

	* apps/app_playback.c, main/pbx.c: Fix an issue with PLAYBACKSTATUS
	  not being set under certain circumstances. Fix a minor issue, to
	  make it use the filenames that were parsed, instead of the entire
	  argument string. Fix Background() to return -1 like Playback(),
	  if no args are specified.

2006-09-27 19:10 +0000 [r43783-43798]  Joshua Colp <jcolp@digium.com>

	* main/rtp.c: Compensate for out of order packets better if RFC2833
	  compensation is turned on.

	* channels/chan_iax2.c: Get rid of two functions from a time now
	  past (we THINK these are from pre-recursive lock time) that may
	  be contributing to two open issues on the bug tracker (7562/7939)
	  and that has the potential to just make bad things happen if the
	  timing is right.

2006-09-27 16:55 +0000 [r43779]  Russell Bryant <russell@digium.com>

	* main/channel.c,res/res_features.c: Fix a problem that occurred if
	  a user entered a digit
	  that matched a bridge feature that was configured using multiple
	  digits, and the digit that was pressed timed out in the feature
	  digit timeout period. For example, if blind transfer is
	  configured as '##', and a user presses just '#'. In this
	  situation, the call would lock up and no longer pass any frames.
	  (issue #7977 reported by festr, and issue #7982 reported by
	  michaels and valuable input provided by mneuhauser and kuj. Fixed
	  by me, with testing help and peer review from Joshua Colp). There
	  are a couple of issues involved in this fix: 1) When
	  ast_generic_bridge determines that there has been a timeout, it
	  returned AST_BRIDGE_RETRY. Then, when ast_channel_bridge gets
	  this result, it calls ast_generic_bridge over again with the same
	  timestamp for the next event. This results in an endless loop of
	  nothing until the call is terminated. This is resolved by simply
	  changing ast_generic_bridge to return AST_BRIDGE_COMPLETE when it
	  sees a timeout. 2) I also changed ast_channel_bridge such that if
	  in the process of calculating the time until the next event, it
	  knows a timeout has already occured, to immediately return
	  AST_BRIDGE_COMPLETE instead of attempting to bridge the channels
	  anyway. 3) In the process of testing the previous two changes, I
	  ran into a problem in res_features where ast_channel_bridge would
	  return because it determined that there was a timeout. However,
	  ast_bridge_call in res_features would then determine by its own
	  calculation that there was still 1 ms before the timeout really
	  occurs. It would then proceed, and since the bridge broke out and
	  did *not* return a frame, it interpreted this as the call was
	  over and hung up the channels. The reason for this was because
	  ast_bridge_call in res_features and ast_channel_bridge in
	  channel.c were using different times for their calculations.
	  channel.c uses the start_time on the bridge config, which is the
	  time that the feature digit was recieved. However, res_features
	  had another time, 'start', which was set right before calling
	  ast_channel_bridge. 'start' will always be slightly after
	  start_time in the bridge config, and sometimes enough to round up
	  to one ms. This is fixed by making ast_bridge_call use the same
	  time as ast_channel_bridge for the timeout calculation. ........

2006-09-27 16:24 +0000 [r43775]  Christian Richter <christian.richter@beronet.com>

	* channels/chan_misdn.c, channels/Makefile: removed the chan_misdn
	  versioning, since Asterisk has it's own

2006-09-27 16:23 +0000 [r43774]  Joshua Colp <jcolp@digium.com>

	* channels/chan_sip.c: Make rfc2833compensate a global option.

2006-09-27 04:35 +0000 [r43756]  Russell Bryant <russell@digium.com>

	* apps/app_voicemail.c: Backport revision 43754 from the trunk,
	  which removes an unused buffer from mm_login to close bug 8038,
	  as well as addresses some formatting and coding guidelines issues
	  in passing. Originally, I did not commit this to 1.4 since it is
	  not necessarily fixing a bug. However, since the IMAP storage
	  code is brand new, I decided it would be better to make the
	  change here as well, in case someone has to work on this code to
	  address issues in the very near future. I don't want to make
	  unnecessary merge problems going to the trunk.

2006-09-27 02:32 +0000 [r43739]  Steve Murphy <murf@digium.com>

	* configs/extensions.ael.sample: This change to extensions.ael was
	  to fix bug 8031; the install scripts are causing it to be copied
	  to /etc/asterisk/extensions.ael, and because it is a fairly
	  direct conversion of the original extensions.conf, the macro and
	  context names clash with the existing extensions.conf. So, I put
	  an ael- in front of all macros and contexts, and checked every
	  goto and macro call. Also, this file compiles under aelparse.

2006-09-26 20:56 +0000 [r43710]  Russell Bryant <russell@digium.com>

	* main/asterisk.c: Back in revision 4798, this message was changed from
	  using ast_cli() to directly calling write(). During this change,
	  checking if this was a remote console was removed. This caused
	  this message about using "exit" or "quit" to exit an Asterisk
	  console to come up in times where it did not make sense. This
	  change restores the check to see if this is a remote console
	  before printing the message. (fixes BE-65)

2006-09-26 20:47 +0000 [r43707]  Joshua Colp <jcolp@digium.com>

	* .cleancount, main/cli.c, channels/chan_sip.c,
	  include/asterisk/channel.h: Use proper type to represent the group variable
	  (issue #8025 reported by makoto)

2006-09-26 20:30 +0000 [r43700-43703]  Russell Bryant <russell@digium.com>

	* channels/chan_sip.c: Add missing newline character in the warning
	  message about deprecated TOS values in configuration.

	* apps/app_voicemail.c: When parsing the sections of voicemail.conf that contain
	  mailbox definitions, don't introduce a length limit on the
	  definition by using a 256 byte temporary storage buffer. Instead,
	  make the temporary buffer just as big as it needs to be to hold
	  the entire mailbox definition. (fixes BE-68)

2006-09-26 20:19 +0000 [r43695-43697]  Joshua Colp <jcolp@digium.com>

	* channels/chan_local.c: Strip options off the argument passed for
	  devicestate in chan_local. (issue #8034 reported by pcardozo)

	* apps/app_chanspy.c, main/channel.c, main/slinfactory.c: Slight
	  overhaul of the whisper support. 1. We need to duplicate the
	  frame from ast_translate 2. We need to ensure we always have
	  signed linear coming in for signed linear combining. 3. We need
	  to ensure we are always feeding signed linear out. 4. Properly
	  store and restore write format when beeping on the channel we are
	  whispering on. 5. Properly discontinue the stream on the channel
	  for the beep. (issue #8019 reported by timkelly1980)

2006-09-26 18:34 +0000 [r43676]  Kevin P. Fleming <kpfleming@digium.com>

	* sounds/Makefile: update to use 1.4.3 core sounds, with corrected
	  beep/beeperr/tt-monkeys files

2006-09-26 18:08 +0000 [r43650-43674]  Jason Parker <jparker@digium.com>

	* doc/rtp-packetization.txt, main/frame.c: Issue #8015, patch by
	  Dan Austin. Maximum values were incorrect, which is why this is
	  being put in 1.4

	* channels/chan_skinny.c: Add proper codec support to chan_skinny.
	  Works with at least ulaw, alaw, and g729a. This is technically a
	  "new feature", but there are justifications for it. I found a bug
	  with the recent rtp packetization changes, which caused the media
	  setup to fail under certain circumstances, particularly when
	  using allow=all, or having no allow= statements (globally or on
	  the device). I could have either removed the rtp packetization
	  features, or I could add proper codec support (which, without, I
	  think most people would consider to be a bug anyways).

2006-09-25 22:07 +0000 [r43640-43642]  Tilghman Lesher <tilghman@mail.jeffandtilghman.com>

	* apps/app_voicemail.c: Should have moved these lines up in the
	  merge, instead of removing them

	* apps/app_voicemail.c: Two bugs when forwarding voicemail (Issue 7824): 1)
	  delete=yes was ignored 2) maxmessages was ignored

2006-09-25 21:26 +0000 [r43626-43635]  Paul Cadach <paul@odt.east.telecom.kz>

	* channels/h323/cisco-h225.cxx, channels/h323/cisco-h225.h,
	  channels/h323/cisco-h225.asn: Fix ASN1 description of
	  non-standard Cisco extensions

	* channels/h323/ast_h323.cxx, channels/chan_h323.c: Backport
	  changes of trunk: 1) r43540: Avoid possible deadlock on channel
	  destruction 2) r43590: Disable fastStart if requested by remote
	  side

2006-09-25 15:23 +0000 [r43616]  Jason Parker <jparker@digium.com>

	* sounds/Makefile: One more fix for sounds installation - this time
	  for portability. Reported to asterisk-dev mailing list.

2006-09-25 14:52 +0000 [r43605]  Steve Murphy <murf@digium.com>

	* formats/format_ogg_vorbis.c: This tiny fix prevents asterisk from
	  crashing if trying to play an OGG moh file.

2006-09-25 06:15 +0000 [r43582]  Paul Cadach <paul@odt.east.telecom.kz>

	* channels/h323/caps_h323.cxx, channels/h323/compat_h323.h,
	  channels/chan_h323.c: Merged revisions 43472,43495 from trunk

2006-09-24 14:58 +0000 [r43553-43564]  Russell Bryant <russell@digium.com>

	* channels/iax2-provision.c: Fix a CLI command registration issue
	  where an erroneous message claiming that "iax2 show provisioning"
	  was already registered. This was because this command was
	  registering itself as both the command, as well as the command it
	  is deprecating. (issue #8022, reported by bjweeks, fixed by
	  myself)

	* channels/chan_iax2.c:Check to see if the channel that is activating the
	  IAXPEER function is actually an IAX2 channel before proceeding to
	  process it to avoid crashing. (issue #8017, reported by admott,
	  fixed by myself)

2006-09-22 23:44 +0000 [r43524]  Kevin P. Fleming <kpfleming@digium.com>

	* Makefile: don't output the 'build complete' message when the
	  target being run is already going to do an installation

2006-09-22 22:12 +0000 [r43518]  Jason Parker <jparker@digium.com>

	* channels/chan_skinny.c: Allow chan_skinny.so to be unloaded
	  properly. Remove reload support, since it doesn't
	  actually...work.

2006-09-22 21:36 +0000 [r43505-43508]  Steve Murphy <murf@digium.com>

	* pbx/pbx_ael.c: This commits a change to return
	  MODULE_LOAD_FAILURE on error, and SUCCESS (instead of 0) when all
	  goes well for bug 8004

	* pbx/pbx_ael.c: If the extensions.ael file not found, or
	  unreadable, we return AST_MODULE_LOAD_DECLINE, as per bug # 8004.

2006-09-22 17:25 +0000 [r43492]  Jason Parker <jparker@digium.com>

	* main/cli.c: Make sure we explicitly set the CLI command to not be
	  deprecated, if it isn't.

2006-09-22 16:42 +0000 [r43486-43489]  Kevin P. Fleming <kpfleming@digium.com>

	* sounds/Makefile: use rebuilt extra sounds

	* main/channel.c: all the Linux systems I have don't use
	  '__m_count' for this field, so I don't know where this came
	  from...

2006-09-22 15:47 +0000 [r43477-43484]  Russell Bryant <russell@digium.com>

	* include/asterisk/threadstorage.h: backport the compatability fix
	  to use attribute_malloc instaed of __attribute__ ((malloc))

	* channels/chan_misdn.c: return AST_MODULE_LOAD_DECLIDE if mISDN
	  could not be configured (issue #8006, Mithraen)

	* main/frame.c: Suppress a compiler warning about the use of a
	  potentially uninitialized variable. It couldn't actually happen,
	  though.

2006-09-22 03:01 +0000 [r43469]  Jason Parker <jparker@digium.com>

	* channels/chan_skinny.c: First shot at unload_module in
	  chan_skinny.. More to come.

2006-09-21 23:50 +0000 [r43466]  Matt O'Gorman <mogorman@digium.com>

	* include/asterisk/jabber.h, channels/chan_gtalk.c,
	  res/res_jabber.c: updates for better compontent support

2006-09-21 23:24 +0000 [r43464]  Tilghman Lesher <tilghman@mail.jeffandtilghman.com>

	* res/res_odbc.c, configs/res_odbc.conf.sample: Twould help if we
	  actually documented how the new features in res_odbc actually
	  work. (Oops)

2006-09-21 22:21 +0000 [r43454-43456]  Joshua Colp <jcolp@digium.com>

	* channels/chan_oss.c: Some more clean up in the load function for
	  chan_oss (issue #8002 reported by Mithraen with minor mods by
	  moi)

	* channels/chan_mgcp.c: Clean up chan_mgcp's module load function
	  (issue #8001 reported by Mithraen with mods by moi)

2006-09-21 21:21 +0000 [r43450]  Kevin P. Fleming <kpfleming@digium.com>

	* main/Makefile, build_tools/strip_nonapi (added): add another
	  attempt to strip non-API symbols from the final binary... script
	  will need to be extended to work on non-Linux systems

2006-09-21 20:22 +0000 [r43410-43445]  Tilghman Lesher <tilghman@mail.jeffandtilghman.com>

	* apps/app_url.c: Fix documentation to reflect how Url() really
	  works

	* cdr/cdr_tds.c, configure, configure.ac: TDS 0.64 updates

2006-09-21  Kevin P. Fleming  <kpfleming@digium.com>

	* Asterisk 1.4.0-beta2 released.

2006-09-21 16:08 +0000 [r43404-43405]  Kevin P. Fleming <kpfleming@digium.com>

	* main/Makefile: remove this change... it requires binutils 2.17

2006-09-20 23:19 +0000 [r43396]  Jason Parker <jparker@digium.com>

	* build_tools/make_version: fix minor typo in the way version is
	  handled

2006-09-20  Kevin P. Fleming  <kpfleming@digium.com>

	* Asterisk 1.4.0-beta1 released.
